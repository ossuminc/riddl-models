// Licensing - External Contexts

// Background Check Service
context BackgroundCheckService is {

  command RequestBackgroundCheck is {
    applicantId is ApplicantId with { briefly "Applicant" described by "Applicant ID." }
    checkType is String(1, 50) with { briefly "Type" described by "Check type." }
    firstName is String(1, 100) with { briefly "First" described by "First name." }
    lastName is String(1, 100) with { briefly "Last" described by "Last name." }
    dateOfBirth is Date with { briefly "DOB" described by "Date of birth." }
    ssn is String(9, 9) with { briefly "SSN" described by "Social security number." }
  } with {
    briefly "Request background check"
    described by "Initiates background check."
  }

  event BackgroundCheckCompleted is {
    applicantId is ApplicantId with { briefly "Applicant" described by "Applicant ID." }
    checkType is String(1, 50) with { briefly "Type" described by "Check type." }
    passed is Boolean with { briefly "Passed" described by "Check passed." }
    findings is many optional String(1, 500) with { briefly "Findings" described by "Check findings." }
    completedAt is TimeStamp with { briefly "Completed" described by "Completion time." }
  } with {
    briefly "Background check completed"
    described by "Emitted when check is done."
  }

  query GetCheckStatus is {
    applicantId is ApplicantId with { briefly "Applicant" described by "Applicant ID." }
  } with {
    briefly "Get check status"
    described by "Queries background check status."
  }

  result CheckStatusResult is {
    status is String(1, 50) with { briefly "Status" described by "Check status." }
    estimatedCompletion is optional Date with { briefly "ETA" described by "Estimated completion." }
  } with {
    briefly "Check status result"
    described by "Background check status."
  }

} with {
  option is external
  briefly "External background check"
  described by "Criminal background check service."
}

// Exam Administration Service
context ExamAdministrationService is {

  command ScheduleExam is {
    applicantId is ApplicantId with { briefly "Applicant" described by "Applicant ID." }
    examType is String(1, 100) with { briefly "Exam" described by "Exam type." }
    preferredDate is Date with { briefly "Date" described by "Preferred date." }
    location is optional String(1, 200) with { briefly "Location" described by "Exam location." }
  } with {
    briefly "Schedule exam"
    described by "Schedules licensure exam."
  }

  event ExamScheduled is {
    applicantId is ApplicantId with { briefly "Applicant" described by "Applicant ID." }
    examType is String(1, 100) with { briefly "Exam" described by "Exam type." }
    scheduledDate is Date with { briefly "Date" described by "Scheduled date." }
    location is String(1, 200) with { briefly "Location" described by "Exam location." }
    confirmationNumber is String(1, 50) with { briefly "Confirmation" described by "Confirmation number." }
  } with {
    briefly "Exam scheduled"
    described by "Emitted when exam is scheduled."
  }

  event ExamResultReceived is {
    applicantId is ApplicantId with { briefly "Applicant" described by "Applicant ID." }
    examType is String(1, 100) with { briefly "Exam" described by "Exam type." }
    examDate is Date with { briefly "Date" described by "Exam date." }
    score is Decimal(5, 2) with { briefly "Score" described by "Exam score." }
    passingScore is Decimal(5, 2) with { briefly "Passing" described by "Passing score." }
    passed is Boolean with { briefly "Passed" described by "Exam passed." }
  } with {
    briefly "Exam result received"
    described by "Emitted when exam results arrive."
  }

  query GetAvailableExamDates is {
    examType is String(1, 100) with { briefly "Exam" described by "Exam type." }
    location is optional String(1, 200) with { briefly "Location" described by "Exam location." }
  } with {
    briefly "Get available dates"
    described by "Queries available exam dates."
  }

  result AvailableDatesResult is {
    dates is many Date with { briefly "Dates" described by "Available dates." }
    locations is many String(1, 200) with { briefly "Locations" described by "Available locations." }
  } with {
    briefly "Available dates result"
    described by "Returns available exam dates."
  }

} with {
  option is external
  briefly "External exam service"
  described by "Licensure examination service."
}

// Payment Processing Service
context PaymentProcessingService is {

  command ProcessFeePayment is {
    payerId is ApplicantId with { briefly "Payer" described by "Payer ID." }
    amount is Decimal(10, 2) with { briefly "Amount" described by "Payment amount." }
    feeType is String(1, 50) with { briefly "Type" described by "Fee type." }
    paymentMethod is String(1, 50) with { briefly "Method" described by "Payment method." }
  } with {
    briefly "Process fee payment"
    described by "Processes license fee payment."
  }

  event PaymentSucceeded is {
    payerId is ApplicantId with { briefly "Payer" described by "Payer ID." }
    amount is Decimal(10, 2) with { briefly "Amount" described by "Payment amount." }
    feeType is String(1, 50) with { briefly "Type" described by "Fee type." }
    confirmationNumber is String(1, 50) with { briefly "Confirmation" described by "Payment confirmation." }
    processedAt is TimeStamp with { briefly "Processed" described by "Processing time." }
  } with {
    briefly "Payment succeeded"
    described by "Emitted when payment succeeds."
  }

  event PaymentFailed is {
    payerId is ApplicantId with { briefly "Payer" described by "Payer ID." }
    amount is Decimal(10, 2) with { briefly "Amount" described by "Payment amount." }
    reason is String(1, 200) with { briefly "Reason" described by "Failure reason." }
    failedAt is TimeStamp with { briefly "Failed" described by "Failure time." }
  } with {
    briefly "Payment failed"
    described by "Emitted when payment fails."
  }

  command RefundPayment is {
    confirmationNumber is String(1, 50) with { briefly "Confirmation" described by "Original confirmation." }
    refundAmount is Decimal(10, 2) with { briefly "Amount" described by "Refund amount." }
    reason is String(1, 200) with { briefly "Reason" described by "Refund reason." }
  } with {
    briefly "Refund payment"
    described by "Refunds a payment."
  }

  event RefundProcessed is {
    originalConfirmation is String(1, 50) with { briefly "Original" described by "Original confirmation." }
    refundAmount is Decimal(10, 2) with { briefly "Amount" described by "Refund amount." }
    refundConfirmation is String(1, 50) with { briefly "Refund confirmation" described by "Refund confirmation." }
    processedAt is TimeStamp with { briefly "Processed" described by "Processing time." }
  } with {
    briefly "Refund processed"
    described by "Emitted when refund completes."
  }

} with {
  option is external
  briefly "External payment processing"
  described by "Fee payment processing service."
}

// Credential Verification Service
context CredentialVerificationService is {

  command VerifyEducation is {
    applicantId is ApplicantId with { briefly "Applicant" described by "Applicant ID." }
    institution is String(1, 200) with { briefly "Institution" described by "School name." }
    degree is String(1, 100) with { briefly "Degree" described by "Degree claimed." }
    graduationDate is Date with { briefly "Date" described by "Graduation date." }
  } with {
    briefly "Verify education"
    described by "Verifies educational credentials."
  }

  event EducationVerified is {
    applicantId is ApplicantId with { briefly "Applicant" described by "Applicant ID." }
    institution is String(1, 200) with { briefly "Institution" described by "School name." }
    verified is Boolean with { briefly "Verified" described by "Verification result." }
    verificationNotes is optional String(1, 500) with { briefly "Notes" described by "Verification notes." }
    verifiedAt is TimeStamp with { briefly "Verified" described by "Verification time." }
  } with {
    briefly "Education verified"
    described by "Emitted when education is verified."
  }

  command VerifyEmployment is {
    applicantId is ApplicantId with { briefly "Applicant" described by "Applicant ID." }
    employer is String(1, 200) with { briefly "Employer" described by "Employer name." }
    position is String(1, 200) with { briefly "Position" described by "Job title." }
    startDate is Date with { briefly "Start" described by "Start date." }
    endDate is optional Date with { briefly "End" described by "End date." }
  } with {
    briefly "Verify employment"
    described by "Verifies employment history."
  }

  event EmploymentVerified is {
    applicantId is ApplicantId with { briefly "Applicant" described by "Applicant ID." }
    employer is String(1, 200) with { briefly "Employer" described by "Employer name." }
    verified is Boolean with { briefly "Verified" described by "Verification result." }
    actualHours is optional Natural with { briefly "Hours" described by "Verified hours." }
    verifiedAt is TimeStamp with { briefly "Verified" described by "Verification time." }
  } with {
    briefly "Employment verified"
    described by "Emitted when employment is verified."
  }

  command VerifyOtherStateLicense is {
    applicantId is ApplicantId with { briefly "Applicant" described by "Applicant ID." }
    otherState is String(2, 50) with { briefly "State" described by "Other state." }
    licenseNumber is String(1, 50) with { briefly "Number" described by "License number." }
    profession is String(1, 200) with { briefly "Profession" described by "Profession." }
  } with {
    briefly "Verify other state license"
    described by "Verifies license from another state."
  }

  event OtherStateLicenseVerified is {
    applicantId is ApplicantId with { briefly "Applicant" described by "Applicant ID." }
    otherState is String(2, 50) with { briefly "State" described by "Other state." }
    verified is Boolean with { briefly "Verified" described by "Verification result." }
    licenseStatus is String(1, 50) with { briefly "Status" described by "License status in other state." }
    disciplinaryHistory is Boolean with { briefly "Disciplinary" described by "Has disciplinary history." }
    verifiedAt is TimeStamp with { briefly "Verified" described by "Verification time." }
  } with {
    briefly "Other state license verified"
    described by "Emitted when reciprocity check completes."
  }

} with {
  option is external
  briefly "External credential verification"
  described by "Credential and license verification service."
}

// Continuing Education Service
context ContinuingEducationService is {

  query GetCECredits is {
    licenseId is LicenseId with { briefly "License" described by "License ID." }
    renewalPeriodStart is Date with { briefly "Start" described by "Period start." }
    renewalPeriodEnd is Date with { briefly "End" described by "Period end." }
  } with {
    briefly "Get CE credits"
    described by "Queries continuing education credits."
  }

  result CECreditsResult is {
    totalCredits is Decimal(6, 2) with { briefly "Total" described by "Total credits." }
    requiredCredits is Decimal(6, 2) with { briefly "Required" described by "Required credits." }
    creditsByCategory is many CECreditCategory with { briefly "By category" described by "Credits by category." }
  } with {
    briefly "CE credits result"
    described by "Continuing education credit summary."
  }

  type CECreditCategory is {
    category is String(1, 100) with { briefly "Category" described by "Credit category." }
    earned is Decimal(6, 2) with { briefly "Earned" described by "Credits earned." }
    required is Decimal(6, 2) with { briefly "Required" described by "Credits required." }
  } with {
    briefly "CE credit category"
    described by "Credits in a category."
  }

  event CECreditRecorded is {
    licenseId is LicenseId with { briefly "License" described by "License ID." }
    courseId is String(1, 50) with { briefly "Course" described by "Course ID." }
    courseName is String(1, 200) with { briefly "Name" described by "Course name." }
    credits is Decimal(4, 2) with { briefly "Credits" described by "Credits earned." }
    category is String(1, 100) with { briefly "Category" described by "Credit category." }
    completedAt is TimeStamp with { briefly "Completed" described by "Completion time." }
  } with {
    briefly "CE credit recorded"
    described by "Emitted when CE credit is recorded."
  }

} with {
  option is external
  briefly "External CE service"
  described by "Continuing education tracking service."
}

// Notification Service
context NotificationService is {

  command SendApplicationNotification is {
    applicantId is ApplicantId with { briefly "Applicant" described by "Applicant ID." }
    notificationType is String(1, 50) with { briefly "Type" described by "Notification type." }
    subject is String(1, 200) with { briefly "Subject" described by "Email subject." }
    body is String(1, 5000) with { briefly "Body" described by "Email body." }
    channel is String(1, 20) with { briefly "Channel" described by "Notification channel." }
  } with {
    briefly "Send application notification"
    described by "Sends notification to applicant."
  }

  event NotificationSent is {
    applicantId is ApplicantId with { briefly "Applicant" described by "Applicant ID." }
    notificationType is String(1, 50) with { briefly "Type" described by "Notification type." }
    channel is String(1, 20) with { briefly "Channel" described by "Notification channel." }
    sentAt is TimeStamp with { briefly "Sent" described by "Send time." }
  } with {
    briefly "Notification sent"
    described by "Emitted when notification is sent."
  }

  command SendRenewalReminder is {
    licenseId is LicenseId with { briefly "License" described by "License ID." }
    expirationDate is Date with { briefly "Expires" described by "Expiration date." }
    daysUntilExpiration is Natural with { briefly "Days" described by "Days until expiration." }
  } with {
    briefly "Send renewal reminder"
    described by "Sends license renewal reminder."
  }

  event RenewalReminderSent is {
    licenseId is LicenseId with { briefly "License" described by "License ID." }
    sentAt is TimeStamp with { briefly "Sent" described by "Send time." }
  } with {
    briefly "Renewal reminder sent"
    described by "Emitted when reminder is sent."
  }

} with {
  option is external
  briefly "External notification"
  described by "Email and SMS notification service."
}
