// Pipeline Operations - External Contexts

context SCADASystem is {

  query GetLiveReadings is {
    segmentId is SegmentId with { briefly "Segment" described by "Segment ID." }
  } with {
    briefly "Get live readings"
    described by "Gets live telemetry readings from SCADA sensors."
  }

  result LiveReadings is {
    readings is many FlowReading with { briefly "Readings" described by "Live flow readings." }
    sensorCount is Natural with { briefly "Sensors" described by "Number of active sensors." }
  } with {
    briefly "Live readings"
    described by "Live SCADA telemetry data."
  }

  command SendControlSignal is {
    segmentId is SegmentId with { briefly "Segment" described by "Segment ID." }
    signalType is String(3, 100) with { briefly "Signal type" described by "Control signal type." }
    parameters is String(3, 1000) with { briefly "Parameters" described by "Signal parameters." }
  } with {
    briefly "Send control signal"
    described by "Sends a control signal to pipeline equipment."
  }

  event ControlSignalSent is {
    segmentId is SegmentId with { briefly "Segment" described by "Segment ID." }
    signalType is String(3, 100) with { briefly "Signal type" described by "Control signal type." }
    sentAt is TimeStamp with { briefly "Sent" described by "Signal send time." }
  } with {
    briefly "Control signal sent"
    described by "Emitted when control signal is sent."
  }

} with {
  option is external
  briefly "External SCADA system"
  described by "Supervisory control and data acquisition system."
}

context RegulatoryPortal is {

  command SubmitComplianceFiling is {
    segmentId is SegmentId with { briefly "Segment" described by "Segment ID." }
    filing is ComplianceFiling with { briefly "Filing" described by "Compliance filing." }
  } with {
    briefly "Submit compliance filing"
    described by "Submits filing to regulatory portal."
  }

  event FilingSubmitted is {
    filingId is UUID with { briefly "Filing" described by "Filing ID." }
    submittedAt is TimeStamp with { briefly "Submitted" described by "Submission time." }
    acknowledgementRef is String(3, 100) with { briefly "Ref" described by "Acknowledgement reference." }
  } with {
    briefly "Filing submitted"
    described by "Emitted when filing is submitted."
  }

  query GetComplianceStatus is {
    segmentId is SegmentId with { briefly "Segment" described by "Segment ID." }
  } with {
    briefly "Get compliance status"
    described by "Gets regulatory compliance status."
  }

  result ComplianceStatus is {
    segmentId is SegmentId with { briefly "Segment" described by "Segment ID." }
    isCompliant is Boolean with { briefly "Compliant" described by "Compliance status." }
    nextFilingDue is Date with { briefly "Next due" described by "Next filing due date." }
    outstandingItems is many String(3, 300) with { briefly "Outstanding" described by "Outstanding items." }
  } with {
    briefly "Compliance status"
    described by "Regulatory compliance status."
  }

} with {
  option is external
  briefly "External regulatory portal"
  described by "Government regulatory compliance portal."
}
