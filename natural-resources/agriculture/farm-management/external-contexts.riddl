// Farm Management - External Contexts
context WeatherService is {
  query GetForecast is  {
    latitude: Decimal(10,6) with {
      briefly "Latitude"
      described as {
        |GPS latitude.
      }
    }
    longitude: Decimal(11,6) with {
      briefly "Longitude"
      described as {
        |GPS longitude.
      }
    }
    daysAhead: Natural with {
      briefly "Days"
      described as {
        |Number of forecast days.
      }
    }
  } with {
    briefly "Get weather forecast"
    described as {
      |Retrieves weather forecast for a location.
    }
  }
  result WeatherForecast is  {
    temperature: Decimal(5,2) with {
      briefly "Temperature"
      described as {
        |Temperature in Celsius.
      }
    }
    precipitationMm: Decimal(8,2) with {
      briefly "Precipitation"
      described as {
        |Expected precipitation in mm.
      }
    }
    humidity: Decimal(5,2) with {
      briefly "Humidity"
      described as {
        |Relative humidity percentage.
      }
    }
    windSpeedKmh: Decimal(6,2) with {
      briefly "Wind speed"
      described as {
        |Wind speed in km/h.
      }
    }
    forecastDate: Date with {
      briefly "Date"
      described as {
        |Forecast date.
      }
    }
  } with {
    briefly "Weather forecast"
    described as {
      |Weather forecast data for a location.
    }
  }
  query GetHistoricalWeather is  {
    latitude: Decimal(10,6) with {
      briefly "Latitude"
      described as {
        |GPS latitude.
      }
    }
    longitude: Decimal(11,6) with {
      briefly "Longitude"
      described as {
        |GPS longitude.
      }
    }
    startDate: Date with {
      briefly "Start"
      described as {
        |Start date.
      }
    }
    endDate: Date with {
      briefly "End"
      described as {
        |End date.
      }
    }
  } with {
    briefly "Get historical weather"
    described as {
      |Retrieves historical weather data for a location.
    }
  }
  result HistoricalWeather is  {
    avgTemperature: Decimal(5,2) with {
      briefly "Avg temp"
      described as {
        |Average temperature.
      }
    }
    totalPrecipitationMm: Decimal(10,2) with {
      briefly "Total precip"
      described as {
        |Total precipitation.
      }
    }
    frostDays: Natural with {
      briefly "Frost days"
      described as {
        |Number of frost days.
      }
    }
  } with {
    briefly "Historical weather"
    described as {
      |Historical weather summary.
    }
  }
} with {
  option external()
  briefly "External weather service"
  described as {
    |Weather data provider for agricultural planning.
  }
}
context MarketPricing is {
  query GetCropPrice is  {
    cropName: String(3,100) with {
      briefly "Crop"
      described as {
        |Crop name.
      }
    }
    region: String(3,100) with {
      briefly "Region"
      described as {
        |Market region.
      }
    }
  } with {
    briefly "Get crop price"
    described as {
      |Gets current market price for a crop.
    }
  }
  result CropPrice is  {
    cropName: String(3,100) with {
      briefly "Crop"
      described as {
        |Crop name.
      }
    }
    pricePerKg: Decimal(10,4) with {
      briefly "Price"
      described as {
        |Price per kg.
      }
    }
    currency: String(3,3) with {
      briefly "Currency"
      described as {
        |Currency code.
      }
    }
    asOfDate: Date with {
      briefly "Date"
      described as {
        |Price date.
      }
    }
  } with {
    briefly "Crop price"
    described as {
      |Market price for a crop.
    }
  }
  query GetPriceForecast is  {
    cropName: String(3,100) with {
      briefly "Crop"
      described as {
        |Crop name.
      }
    }
    monthsAhead: Natural with {
      briefly "Months"
      described as {
        |Forecast months ahead.
      }
    }
  } with {
    briefly "Get price forecast"
    described as {
      |Gets price forecast for a crop.
    }
  }
  result PriceForecast is  {
    cropName: String(3,100) with {
      briefly "Crop"
      described as {
        |Crop name.
      }
    }
    forecastPricePerKg: Decimal(10,4) with {
      briefly "Forecast price"
      described as {
        |Forecasted price per kg.
      }
    }
    confidencePercent: Decimal(5,2) with {
      briefly "Confidence"
      described as {
        |Forecast confidence percentage.
      }
    }
    forecastDate: Date with {
      briefly "Date"
      described as {
        |Forecast target date.
      }
    }
  } with {
    briefly "Price forecast"
    described as {
      |Crop price forecast data.
    }
  }
} with {
  option external()
  briefly "External market pricing"
  described as {
    |Crop market pricing data provider.
  }
}
