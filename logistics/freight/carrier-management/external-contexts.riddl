// Carrier Management - External Contexts
context SaferWeb is {
  command VerifyDOTNumber is  {
    dotNumber: String(1,20) with {
      briefly "DOT"
      described as {
        |DOT number to verify.
      }
    }
  } with {
    briefly "Verify DOT number"
    described as {
      |Verifies carrier DOT registration.
    }
  }
  event DOTVerified is  {
    dotNumber: String(1,20) with {
      briefly "DOT"
      described as {
        |DOT number.
      }
    }
    legalName: String(1,200) with {
      briefly "Name"
      described as {
        |Legal name.
      }
    }
    safetyRating: String(1,20) with {
      briefly "Rating"
      described as {
        |Safety rating.
      }
    }
    isActive: Boolean with {
      briefly "Active"
      described as {
        |Registration active.
      }
    }
  } with {
    briefly "DOT verified"
    described as {
      |Emitted when DOT verified.
    }
  }
  command CheckSafetyRecord is  {
    dotNumber: String(1,20) with {
      briefly "DOT"
      described as {
        |DOT number.
      }
    }
  } with {
    briefly "Check safety record"
    described as {
      |Retrieves safety record.
    }
  }
  event SafetyRecordRetrieved is  {
    dotNumber: String(1,20) with {
      briefly "DOT"
      described as {
        |DOT number.
      }
    }
    crashRate: Decimal(5,2) with {
      briefly "Crash rate"
      described as {
        |Crash rate.
      }
    }
    inspectionScore: Decimal(3,1) with {
      briefly "Inspection"
      described as {
        |Inspection score.
      }
    }
    outOfServiceRate: Decimal(5,2) with {
      briefly "OOS rate"
      described as {
        |Out of service rate.
      }
    }
  } with {
    briefly "Safety record retrieved"
    described as {
      |Emitted when safety data available.
    }
  }
} with {
  option external()
  briefly "External SAFER Web integration"
  described as {
    |FMCSA SAFER database access.
  }
}
context InsuranceVerification is {
  command VerifyInsuranceCoverage is  {
    carrierId: CarrierId with {
      briefly "Carrier"
      described as {
        |Carrier ID.
      }
    }
    policyNumber: String(1,50) with {
      briefly "Policy"
      described as {
        |Policy number.
      }
    }
    provider: String(1,100) with {
      briefly "Provider"
      described as {
        |Insurance provider.
      }
    }
  } with {
    briefly "Verify insurance"
    described as {
      |Verifies insurance coverage.
    }
  }
  event InsuranceVerified is  {
    carrierId: CarrierId with {
      briefly "Carrier"
      described as {
        |Carrier ID.
      }
    }
    policyNumber: String(1,50) with {
      briefly "Policy"
      described as {
        |Policy number.
      }
    }
    isValid: Boolean with {
      briefly "Valid"
      described as {
        |Policy valid.
      }
    }
    coverageAmount: Decimal(15,2) with {
      briefly "Coverage"
      described as {
        |Coverage amount.
      }
    }
    expirationDate: Date with {
      briefly "Expiration"
      described as {
        |Policy expiration.
      }
    }
  } with {
    briefly "Insurance verified"
    described as {
      |Emitted when insurance checked.
    }
  }
} with {
  option external()
  briefly "External insurance verification"
  described as {
    |Insurance provider verification.
  }
}
context RateQuoting is {
  command GetCarrierQuote is  {
    carrierId: CarrierId with {
      briefly "Carrier"
      described as {
        |Carrier ID.
      }
    }
    origin: String(1,50) with {
      briefly "Origin"
      described as {
        |Origin zone.
      }
    }
    destination: String(1,50) with {
      briefly "Destination"
      described as {
        |Destination zone.
      }
    }
    weight: Decimal(10,2) with {
      briefly "Weight"
      described as {
        |Shipment weight.
      }
    }
    serviceType: CarrierType with {
      briefly "Service"
      described as {
        |Service type.
      }
    }
  } with {
    briefly "Get quote"
    described as {
      |Gets carrier rate quote.
    }
  }
  event QuoteReceived is  {
    carrierId: CarrierId with {
      briefly "Carrier"
      described as {
        |Carrier ID.
      }
    }
    quoteId: UUID with {
      briefly "Quote"
      described as {
        |Quote ID.
      }
    }
    totalRate: Decimal(10,2) with {
      briefly "Rate"
      described as {
        |Total rate.
      }
    }
    transitDays: Natural with {
      briefly "Transit"
      described as {
        |Transit days.
      }
    }
    validUntil: TimeStamp with {
      briefly "Valid until"
      described as {
        |Quote expiration.
      }
    }
  } with {
    briefly "Quote received"
    described as {
      |Emitted when quote provided.
    }
  }
} with {
  option external()
  briefly "External rate quoting"
  described as {
    |Carrier rate API integration.
  }
}
context LoadBoard is {
  command PostLoad is  {
    loadId: UUID with {
      briefly "Load"
      described as {
        |Load ID.
      }
    }
    origin: String(1,100) with {
      briefly "Origin"
      described as {
        |Load origin.
      }
    }
    destination: String(1,100) with {
      briefly "Destination"
      described as {
        |Load destination.
      }
    }
    pickupDate: Date with {
      briefly "Pickup"
      described as {
        |Pickup date.
      }
    }
    weight: Decimal(10,2) with {
      briefly "Weight"
      described as {
        |Load weight.
      }
    }
    offeredRate: Decimal(10,2) with {
      briefly "Rate"
      described as {
        |Offered rate.
      }
    }
  } with {
    briefly "Post load"
    described as {
      |Posts load to board.
    }
  }
  event LoadPosted is  {
    loadId: UUID with {
      briefly "Load"
      described as {
        |Load ID.
      }
    }
    postedAt: TimeStamp with {
      briefly "Posted"
      described as {
        |Post time.
      }
    }
  } with {
    briefly "Load posted"
    described as {
      |Emitted when load posted.
    }
  }
  event CarrierBidReceived is  {
    loadId: UUID with {
      briefly "Load"
      described as {
        |Load ID.
      }
    }
    carrierId: CarrierId with {
      briefly "Carrier"
      described as {
        |Bidding carrier.
      }
    }
    bidAmount: Decimal(10,2) with {
      briefly "Bid"
      described as {
        |Bid amount.
      }
    }
    bidAt: TimeStamp with {
      briefly "Time"
      described as {
        |Bid time.
      }
    }
  } with {
    briefly "Bid received"
    described as {
      |Emitted when carrier bids.
    }
  }
} with {
  option external()
  briefly "External load board"
  described as {
    |Freight load board integration.
  }
}
