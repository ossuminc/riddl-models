// Carrier Management - External Contexts

context SaferWeb is {

  command VerifyDOTNumber is {
    dotNumber is String(1, 20) with { briefly "DOT" described by "DOT number to verify." }
  } with {
    briefly "Verify DOT number"
    described by "Verifies carrier DOT registration."
  }

  event DOTVerified is {
    dotNumber is String(1, 20) with { briefly "DOT" described by "DOT number." }
    legalName is String(1, 200) with { briefly "Name" described by "Legal name." }
    safetyRating is String(1, 20) with { briefly "Rating" described by "Safety rating." }
    isActive is Boolean with { briefly "Active" described by "Registration active." }
  } with {
    briefly "DOT verified"
    described by "Emitted when DOT verified."
  }

  command CheckSafetyRecord is {
    dotNumber is String(1, 20) with { briefly "DOT" described by "DOT number." }
  } with {
    briefly "Check safety record"
    described by "Retrieves safety record."
  }

  event SafetyRecordRetrieved is {
    dotNumber is String(1, 20) with { briefly "DOT" described by "DOT number." }
    crashRate is Decimal(5, 2) with { briefly "Crash rate" described by "Crash rate." }
    inspectionScore is Decimal(3, 1) with { briefly "Inspection" described by "Inspection score." }
    outOfServiceRate is Decimal(5, 2) with { briefly "OOS rate" described by "Out of service rate." }
  } with {
    briefly "Safety record retrieved"
    described by "Emitted when safety data available."
  }

} with {
  option is external
  briefly "External SAFER Web integration"
  described by "FMCSA SAFER database access."
}

context InsuranceVerification is {

  command VerifyInsuranceCoverage is {
    carrierId is CarrierId with { briefly "Carrier" described by "Carrier ID." }
    policyNumber is String(1, 50) with { briefly "Policy" described by "Policy number." }
    provider is String(1, 100) with { briefly "Provider" described by "Insurance provider." }
  } with {
    briefly "Verify insurance"
    described by "Verifies insurance coverage."
  }

  event InsuranceVerified is {
    carrierId is CarrierId with { briefly "Carrier" described by "Carrier ID." }
    policyNumber is String(1, 50) with { briefly "Policy" described by "Policy number." }
    isValid is Boolean with { briefly "Valid" described by "Policy valid." }
    coverageAmount is Decimal(15, 2) with { briefly "Coverage" described by "Coverage amount." }
    expirationDate is Date with { briefly "Expiration" described by "Policy expiration." }
  } with {
    briefly "Insurance verified"
    described by "Emitted when insurance checked."
  }

} with {
  option is external
  briefly "External insurance verification"
  described by "Insurance provider verification."
}

context RateQuoting is {

  command GetCarrierQuote is {
    carrierId is CarrierId with { briefly "Carrier" described by "Carrier ID." }
    origin is String(1, 50) with { briefly "Origin" described by "Origin zone." }
    destination is String(1, 50) with { briefly "Destination" described by "Destination zone." }
    weight is Decimal(10, 2) with { briefly "Weight" described by "Shipment weight." }
    serviceType is CarrierType with { briefly "Service" described by "Service type." }
  } with {
    briefly "Get quote"
    described by "Gets carrier rate quote."
  }

  event QuoteReceived is {
    carrierId is CarrierId with { briefly "Carrier" described by "Carrier ID." }
    quoteId is UUID with { briefly "Quote" described by "Quote ID." }
    totalRate is Decimal(10, 2) with { briefly "Rate" described by "Total rate." }
    transitDays is Natural with { briefly "Transit" described by "Transit days." }
    validUntil is TimeStamp with { briefly "Valid until" described by "Quote expiration." }
  } with {
    briefly "Quote received"
    described by "Emitted when quote provided."
  }

} with {
  option is external
  briefly "External rate quoting"
  described by "Carrier rate API integration."
}

context LoadBoard is {

  command PostLoad is {
    loadId is UUID with { briefly "Load" described by "Load ID." }
    origin is String(1, 100) with { briefly "Origin" described by "Load origin." }
    destination is String(1, 100) with { briefly "Destination" described by "Load destination." }
    pickupDate is Date with { briefly "Pickup" described by "Pickup date." }
    weight is Decimal(10, 2) with { briefly "Weight" described by "Load weight." }
    rate is Decimal(10, 2) with { briefly "Rate" described by "Offered rate." }
  } with {
    briefly "Post load"
    described by "Posts load to board."
  }

  event LoadPosted is {
    loadId is UUID with { briefly "Load" described by "Load ID." }
    postedAt is TimeStamp with { briefly "Posted" described by "Post time." }
  } with {
    briefly "Load posted"
    described by "Emitted when load posted."
  }

  event CarrierBidReceived is {
    loadId is UUID with { briefly "Load" described by "Load ID." }
    carrierId is CarrierId with { briefly "Carrier" described by "Bidding carrier." }
    bidAmount is Decimal(10, 2) with { briefly "Bid" described by "Bid amount." }
    bidAt is TimeStamp with { briefly "Time" described by "Bid time." }
  } with {
    briefly "Bid received"
    described by "Emitted when carrier bids."
  }

} with {
  option is external
  briefly "External load board"
  described by "Freight load board integration."
}
