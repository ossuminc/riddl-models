// Inventory Control - External Contexts
context PurchasingSystem is {
  command CreatePurchaseOrder is  {
    productId: ProductId with {
      briefly "Product"
      described as {
        |Product ID.
      }
    }
    quantity: Natural with {
      briefly "Quantity"
      described as {
        |Order quantity.
      }
    }
    priority: ReplenishmentPriority with {
      briefly "Priority"
      described as {
        |Order priority.
      }
    }
    warehouseId: WarehouseId with {
      briefly "Warehouse"
      described as {
        |Destination warehouse.
      }
    }
  } with {
    briefly "Create purchase order"
    described as {
      |Creates a purchase order for replenishment.
    }
  }
  event PurchaseOrderCreated is  {
    purchaseOrderId: UUID with {
      briefly "PO ID"
      described as {
        |Purchase order ID.
      }
    }
    productId: ProductId with {
      briefly "Product"
      described as {
        |Product ID.
      }
    }
    quantity: Natural with {
      briefly "Quantity"
      described as {
        |Order quantity.
      }
    }
    createdAt: TimeStamp with {
      briefly "Created"
      described as {
        |Creation time.
      }
    }
  } with {
    briefly "Purchase order created"
    described as {
      |Emitted when purchase order is created.
    }
  }
  query GetPurchaseOrderStatus is  {
    purchaseOrderId: UUID with {
      briefly "PO ID"
      described as {
        |Purchase order ID.
      }
    }
  } with {
    briefly "Get PO status"
    described as {
      |Gets purchase order status.
    }
  }
  result PurchaseOrderStatus is  {
    purchaseOrderId: UUID with {
      briefly "PO ID"
      described as {
        |Purchase order ID.
      }
    }
    orderStatus: String(1,50) with {
      briefly "Status"
      described as {
        |Order status.
      }
    }
    expectedDelivery: Date? with {
      briefly "Expected"
      described as {
        |Expected delivery date.
      }
    }
  } with {
    briefly "Purchase order status"
    described as {
      |Purchase order status details.
    }
  }
} with {
  option external()
  briefly "External purchasing system"
  described as {
    |Procurement and purchase order management.
  }
}
context ERPSystem is {
  command SyncInventoryLevels is  {
    warehouseId: WarehouseId with {
      briefly "Warehouse"
      described as {
        |Warehouse ID.
      }
    }
    productId: ProductId with {
      briefly "Product"
      described as {
        |Product ID.
      }
    }
    quantityOnHand: Natural with {
      briefly "Qty"
      described as {
        |Quantity on hand.
      }
    }
    syncedAt: TimeStamp with {
      briefly "Synced"
      described as {
        |Sync timestamp.
      }
    }
  } with {
    briefly "Sync inventory levels"
    described as {
      |Synchronizes inventory levels to ERP.
    }
  }
  event InventoryLevelsSynced is  {
    warehouseId: WarehouseId with {
      briefly "Warehouse"
      described as {
        |Warehouse ID.
      }
    }
    productId: ProductId with {
      briefly "Product"
      described as {
        |Product ID.
      }
    }
    syncedAt: TimeStamp with {
      briefly "Synced"
      described as {
        |Sync timestamp.
      }
    }
  } with {
    briefly "Inventory levels synced"
    described as {
      |Emitted when inventory is synced to ERP.
    }
  }
  query GetProductInfo is  {
    productId: ProductId with {
      briefly "Product"
      described as {
        |Product ID.
      }
    }
  } with {
    briefly "Get product info"
    described as {
      |Gets product information from ERP.
    }
  }
  result ProductInfo is  {
    productId: ProductId with {
      briefly "Product"
      described as {
        |Product ID.
      }
    }
    productName: String(1,200) with {
      briefly "Name"
      described as {
        |Product name.
      }
    }
    sku: String(1,50) with {
      briefly "SKU"
      described as {
        |Stock keeping unit.
      }
    }
    category: String(1,100) with {
      briefly "Category"
      described as {
        |Product category.
      }
    }
  } with {
    briefly "Product info"
    described as {
      |Product information from ERP.
    }
  }
} with {
  option external()
  briefly "External ERP system"
  described as {
    |Enterprise resource planning system.
  }
}
