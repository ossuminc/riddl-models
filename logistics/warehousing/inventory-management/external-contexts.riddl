// Inventory Management - External Contexts

// Warehouse Management System
context WarehouseManagementService is {

  query GetLocationCapacity is {
    locationId is LocationId with { briefly "Location" described by "Location ID." }
  } with {
    briefly "Get location capacity"
    described by "Retrieves location capacity info."
  }

  result LocationCapacity is {
    locationId is LocationId with { briefly "Location" described by "Location ID." }
    totalCapacity is Natural with { briefly "Capacity" described by "Total capacity." }
    usedCapacity is Natural with { briefly "Used" described by "Used capacity." }
    availableCapacity is Natural with { briefly "Available" described by "Available capacity." }
  } with {
    briefly "Location capacity"
    described by "Location capacity information."
  }

  command OptimizeSlotting is {
    productId is ProductId with { briefly "Product" described by "Product ID." }
    velocity is String(1, 10) with { briefly "Velocity" described by "Product velocity class." }
  } with {
    briefly "Optimize slotting"
    described by "Recommends optimal storage location."
  }

  result SlottingRecommendation is {
    productId is ProductId with { briefly "Product" described by "Product ID." }
    recommendedLocation is LocationInfo with { briefly "Location" described by "Recommended location." }
    reason is String(1, 200) with { briefly "Reason" described by "Recommendation reason." }
  } with {
    briefly "Slotting recommendation"
    described by "Optimal location recommendation."
  }

} with {
  option is external
  briefly "External WMS"
  described by "External warehouse management system."
}

// Procurement Service
context ProcurementService is {

  command CreatePurchaseOrder is {
    productId is ProductId with { briefly "Product" described by "Product ID." }
    quantity is Natural with { briefly "Quantity" described by "Order quantity." }
    supplierId is UUID with { briefly "Supplier" described by "Supplier ID." }
  } with {
    briefly "Create PO"
    described by "Creates purchase order."
  }

  event PurchaseOrderCreated is {
    purchaseOrderId is UUID with { briefly "PO" described by "Purchase order ID." }
    productId is ProductId with { briefly "Product" described by "Product ID." }
    expectedDelivery is Date with { briefly "Expected" described by "Expected delivery date." }
    createdAt is TimeStamp with { briefly "Created" described by "Creation time." }
  } with {
    briefly "PO created"
    described by "Emitted when PO is created."
  }

  query GetPurchaseOrderStatus is {
    purchaseOrderId is UUID with { briefly "PO" described by "Purchase order ID." }
  } with {
    briefly "Get PO status"
    described by "Retrieves PO status."
  }

  result PurchaseOrderStatus is {
    purchaseOrderId is UUID with { briefly "PO" described by "Purchase order ID." }
    status is String(1, 50) with { briefly "Status" described by "Order status." }
    expectedQuantity is Natural with { briefly "Expected" described by "Expected quantity." }
    receivedQuantity is Natural with { briefly "Received" described by "Received quantity." }
    expectedDelivery is Date with { briefly "Delivery" described by "Expected delivery." }
  } with {
    briefly "PO status"
    described by "Purchase order status."
  }

} with {
  option is external
  briefly "External procurement"
  described by "External procurement service."
}

// Order Management Service
context OrderManagementService is {

  command RequestInventoryAllocation is {
    orderId is UUID with { briefly "Order" described by "Order ID." }
    items is many ProductInfo with { briefly "Items" described by "Order items." }
    quantities is many Natural with { briefly "Quantities" described by "Requested quantities." }
  } with {
    briefly "Request allocation"
    described by "Requests inventory allocation for order."
  }

  event AllocationRequested is {
    orderId is UUID with { briefly "Order" described by "Order ID." }
    requestedAt is TimeStamp with { briefly "Requested" described by "Request time." }
  } with {
    briefly "Allocation requested"
    described by "Emitted when allocation is requested."
  }

  command NotifyAllocationComplete is {
    orderId is UUID with { briefly "Order" described by "Order ID." }
    allocated is Boolean with { briefly "Allocated" described by "Whether fully allocated." }
    shortages is many optional ProductId with { briefly "Shortages" described by "Products with shortages." }
  } with {
    briefly "Notify allocation"
    described by "Notifies order of allocation result."
  }

  event AllocationNotified is {
    orderId is UUID with { briefly "Order" described by "Order ID." }
    notifiedAt is TimeStamp with { briefly "Notified" described by "Notification time." }
  } with {
    briefly "Allocation notified"
    described by "Emitted when order is notified."
  }

} with {
  option is external
  briefly "External order management"
  described by "External order management service."
}

// Barcode/RFID Service
context BarcodeService is {

  command ScanBarcode is {
    barcode is String(1, 100) with { briefly "Barcode" described by "Scanned barcode." }
    scannedBy is String(1, 200) with { briefly "Scanned by" described by "Scanner operator." }
  } with {
    briefly "Scan barcode"
    described by "Processes barcode scan."
  }

  result BarcodeData is {
    barcode is String(1, 100) with { briefly "Barcode" described by "Barcode value." }
    productId is optional ProductId with { briefly "Product" described by "Product ID if product." }
    locationId is optional LocationId with { briefly "Location" described by "Location ID if location." }
    lotId is optional LotId with { briefly "Lot" described by "Lot ID if lot." }
    dataType is String(1, 50) with { briefly "Type" described by "Data type identified." }
  } with {
    briefly "Barcode data"
    described by "Decoded barcode information."
  }

  command GenerateLabel is {
    productId is ProductId with { briefly "Product" described by "Product ID." }
    quantity is Natural with { briefly "Quantity" described by "Number of labels." }
    labelType is String(1, 50) with { briefly "Type" described by "Label type." }
  } with {
    briefly "Generate label"
    described by "Generates barcode labels."
  }

  event LabelGenerated is {
    productId is ProductId with { briefly "Product" described by "Product ID." }
    labelUrl is URL with { briefly "URL" described by "Label print URL." }
    generatedAt is TimeStamp with { briefly "Generated" described by "Generation time." }
  } with {
    briefly "Label generated"
    described by "Emitted when label is generated."
  }

} with {
  option is external
  briefly "External barcode service"
  described by "External barcode and label service."
}

// Shipping Service
context ShippingService is {

  command CreateShipment is {
    orderId is UUID with { briefly "Order" described by "Order ID." }
    items is many ProductInfo with { briefly "Items" described by "Shipment items." }
    quantities is many Natural with { briefly "Quantities" described by "Item quantities." }
    destination is String(1, 500) with { briefly "Destination" described by "Shipping address." }
  } with {
    briefly "Create shipment"
    described by "Creates outbound shipment."
  }

  event ShipmentCreated is {
    shipmentId is UUID with { briefly "Shipment" described by "Shipment ID." }
    orderId is UUID with { briefly "Order" described by "Order ID." }
    trackingNumber is String(1, 100) with { briefly "Tracking" described by "Tracking number." }
    createdAt is TimeStamp with { briefly "Created" described by "Creation time." }
  } with {
    briefly "Shipment created"
    described by "Emitted when shipment is created."
  }

  command ConfirmShipment is {
    shipmentId is UUID with { briefly "Shipment" described by "Shipment ID." }
    shippedAt is TimeStamp with { briefly "Shipped" described by "Ship time." }
  } with {
    briefly "Confirm shipment"
    described by "Confirms shipment dispatched."
  }

  event ShipmentConfirmed is {
    shipmentId is UUID with { briefly "Shipment" described by "Shipment ID." }
    confirmedAt is TimeStamp with { briefly "Confirmed" described by "Confirmation time." }
  } with {
    briefly "Shipment confirmed"
    described by "Emitted when shipment is confirmed."
  }

} with {
  option is external
  briefly "External shipping"
  described by "External shipping service."
}

// Quality Control Service
context QualityControlService is {

  command InspectReceipt is {
    purchaseOrderId is UUID with { briefly "PO" described by "Purchase order ID." }
    productId is ProductId with { briefly "Product" described by "Product ID." }
    quantity is Natural with { briefly "Quantity" described by "Quantity to inspect." }
  } with {
    briefly "Inspect receipt"
    described by "Initiates receiving inspection."
  }

  event InspectionStarted is {
    inspectionId is UUID with { briefly "Inspection" described by "Inspection ID." }
    productId is ProductId with { briefly "Product" described by "Product ID." }
    startedAt is TimeStamp with { briefly "Started" described by "Start time." }
  } with {
    briefly "Inspection started"
    described by "Emitted when inspection begins."
  }

  command RecordInspectionResult is {
    inspectionId is UUID with { briefly "Inspection" described by "Inspection ID." }
    passedQuantity is Natural with { briefly "Passed" described by "Quantity passed." }
    rejectedQuantity is Natural with { briefly "Rejected" described by "Quantity rejected." }
    notes is optional String(1, 1000) with { briefly "Notes" described by "Inspection notes." }
  } with {
    briefly "Record inspection"
    described by "Records inspection result."
  }

  event InspectionCompleted is {
    inspectionId is UUID with { briefly "Inspection" described by "Inspection ID." }
    passedQuantity is Natural with { briefly "Passed" described by "Passed quantity." }
    rejectedQuantity is Natural with { briefly "Rejected" described by "Rejected quantity." }
    completedAt is TimeStamp with { briefly "Completed" described by "Completion time." }
  } with {
    briefly "Inspection completed"
    described by "Emitted when inspection completes."
  }

} with {
  option is external
  briefly "External quality control"
  described by "External quality inspection service."
}
