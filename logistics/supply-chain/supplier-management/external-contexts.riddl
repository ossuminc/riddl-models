// Supplier Management - External Contexts
context ComplianceRegistry is {
  query CheckCompliance is  {
    supplierId: SupplierId with {
      briefly "Supplier"
      described as {
        |Supplier ID.
      }
    }
    regulationType: String(3,100) with {
      briefly "Type"
      described as {
        |Regulation type.
      }
    }
  } with {
    briefly "Check compliance"
    described as {
      |Checks supplier regulatory compliance.
    }
  }
  result ComplianceResult is  {
    supplierId: SupplierId with {
      briefly "Supplier"
      described as {
        |Supplier ID.
      }
    }
    complianceStatus: ComplianceStatus with {
      briefly "Status"
      described as {
        |Compliance status.
      }
    }
    details: String(3,1000) with {
      briefly "Details"
      described as {
        |Compliance details.
      }
    }
    checkedAt: TimeStamp with {
      briefly "Checked"
      described as {
        |Check timestamp.
      }
    }
  } with {
    briefly "Compliance result"
    described as {
      |Supplier compliance check result.
    }
  }
  command SubmitComplianceReport is  {
    supplierId: SupplierId with {
      briefly "Supplier"
      described as {
        |Supplier ID.
      }
    }
    reportType: String(3,100) with {
      briefly "Type"
      described as {
        |Report type.
      }
    }
    reportData: String(3,5000) with {
      briefly "Data"
      described as {
        |Report content.
      }
    }
  } with {
    briefly "Submit compliance report"
    described as {
      |Submits a compliance report for a supplier.
    }
  }
  event ComplianceReportFiled is  {
    supplierId: SupplierId with {
      briefly "Supplier"
      described as {
        |Supplier ID.
      }
    }
    reportType: String(3,100) with {
      briefly "Type"
      described as {
        |Report type.
      }
    }
    filedAt: TimeStamp with {
      briefly "Filed"
      described as {
        |Filing timestamp.
      }
    }
  } with {
    briefly "Compliance report filed"
    described as {
      |Emitted when a compliance report is filed.
    }
  }
} with {
  option external()
  briefly "External compliance registry"
  described as {
    |Regulatory compliance management system.
  }
}
context ProcurementSystem is {
  command CreatePurchaseOrder is  {
    supplierId: SupplierId with {
      briefly "Supplier"
      described as {
        |Supplier ID.
      }
    }
    orderAmount: Decimal(12,2) with {
      briefly "Amount"
      described as {
        |Order amount.
      }
    }
    items: String(3,2000) with {
      briefly "Items"
      described as {
        |Ordered items description.
      }
    }
    deliveryDate: Date with {
      briefly "Delivery"
      described as {
        |Requested delivery date.
      }
    }
  } with {
    briefly "Create purchase order"
    described as {
      |Creates a purchase order for a supplier.
    }
  }
  event PurchaseOrderCreated is  {
    supplierId: SupplierId with {
      briefly "Supplier"
      described as {
        |Supplier ID.
      }
    }
    orderId: UUID with {
      briefly "Order"
      described as {
        |Purchase order ID.
      }
    }
    createdAt: TimeStamp with {
      briefly "Created"
      described as {
        |Creation timestamp.
      }
    }
  } with {
    briefly "Purchase order created"
    described as {
      |Emitted when a purchase order is created.
    }
  }
  query GetSupplierSpend is  {
    supplierId: SupplierId with {
      briefly "Supplier"
      described as {
        |Supplier ID.
      }
    }
    fromDate: Date with {
      briefly "From"
      described as {
        |Start date.
      }
    }
    toDate: Date with {
      briefly "To"
      described as {
        |End date.
      }
    }
  } with {
    briefly "Get supplier spend"
    described as {
      |Retrieves spend history for a supplier.
    }
  }
  result SupplierSpend is  {
    supplierId: SupplierId with {
      briefly "Supplier"
      described as {
        |Supplier ID.
      }
    }
    totalSpend: Decimal(14,2) with {
      briefly "Total"
      described as {
        |Total spend amount.
      }
    }
    orderCount: Natural with {
      briefly "Orders"
      described as {
        |Number of orders.
      }
    }
  } with {
    briefly "Supplier spend"
    described as {
      |Supplier spend summary.
    }
  }
} with {
  option external()
  briefly "External procurement system"
  described as {
    |Enterprise procurement and purchasing system.
  }
}
