// Demand Planning - Shared Types
type ForecastId is Id(ForecastContext.Forecast)  with {
  briefly "Forecast identifier"
  described as {
    |Unique identifier for a forecast.
  }
}
type ProductId is UUID with {
  briefly "Product identifier"
  described as {
    |Unique identifier for a product.
  }
}
type LocationId is UUID with {
  briefly "Location identifier"
  described as {
    |Unique identifier for a location.
  }
}
type ForecastStatus is any of {
  Draft,
  InReview,
  Approved,
  Active,
  Superseded,
  Archived
} with {
  briefly "Forecast status"
  described as {
    |Forecast lifecycle status.
  }
}
type ForecastMethod is any of {
  Statistical,
  MachineLearning,
  Judgmental,
  Causal,
  Composite
} with {
  briefly "Forecast method"
  described as {
    |Forecasting methodology used.
  }
}
type TimeGranularity is any of {
  Daily,
  Weekly,
  Monthly,
  Quarterly
} with {
  briefly "Time granularity"
  described as {
    |Forecast time period granularity.
  }
}
type PlanningHorizon is {
  startDate: Date with {
    briefly "Start"
    described as {
      |Forecast start date.
    }
  }
  endDate: Date with {
    briefly "End"
    described as {
      |Forecast end date.
    }
  }
  granularity: TimeGranularity with {
    briefly "Granularity"
    described as {
      |Time period granularity.
    }
  }
  periodCount: Natural with {
    briefly "Periods"
    described as {
      |Number of forecast periods.
    }
  }
} with {
  briefly "Planning horizon"
  described as {
    |Forecast time range.
  }
}
type ForecastPeriod is {
  periodStart: Date with {
    briefly "Start"
    described as {
      |Period start date.
    }
  }
  periodEnd: Date with {
    briefly "End"
    described as {
      |Period end date.
    }
  }
  forecastQuantity: Decimal(15,2) with {
    briefly "Quantity"
    described as {
      |Forecasted quantity.
    }
  }
  confidenceLow: Decimal(15,2) with {
    briefly "Low"
    described as {
      |Lower confidence bound.
    }
  }
  confidenceHigh: Decimal(15,2) with {
    briefly "High"
    described as {
      |Upper confidence bound.
    }
  }
  confidenceLevel: Decimal(5,2) with {
    briefly "Confidence"
    described as {
      |Confidence level percent.
    }
  }
} with {
  briefly "Forecast period"
  described as {
    |Single period forecast data.
  }
}
type ProductForecast is {
  productId: ProductId with {
    briefly "Product"
    described as {
      |Product identifier.
    }
  }
  productName: String(1,200) with {
    briefly "Name"
    described as {
      |Product name.
    }
  }
  sku: String(1,50) with {
    briefly "SKU"
    described as {
      |Stock keeping unit.
    }
  }
  periods: ForecastPeriod+ with {
    briefly "Periods"
    described as {
      |Forecast by period.
    }
  }
} with {
  briefly "Product forecast"
  described as {
    |Forecast for single product.
  }
}
type LocationForecast is {
  locationId: LocationId with {
    briefly "Location"
    described as {
      |Location identifier.
    }
  }
  locationName: String(1,200) with {
    briefly "Name"
    described as {
      |Location name.
    }
  }
  products: ProductForecast+ with {
    briefly "Products"
    described as {
      |Product forecasts.
    }
  }
} with {
  briefly "Location forecast"
  described as {
    |Forecast for single location.
  }
}
type HistoricalData is {
  productId: ProductId with {
    briefly "Product"
    described as {
      |Product identifier.
    }
  }
  locationId: LocationId with {
    briefly "Location"
    described as {
      |Location identifier.
    }
  }
  periodStart: Date with {
    briefly "Start"
    described as {
      |Period start.
    }
  }
  periodEnd: Date with {
    briefly "End"
    described as {
      |Period end.
    }
  }
  actualQuantity: Decimal(15,2) with {
    briefly "Actual"
    described as {
      |Actual demand quantity.
    }
  }
} with {
  briefly "Historical data"
  described as {
    |Past demand data.
  }
}
type ForecastAdjustment is {
  adjustmentId: UUID with {
    briefly "ID"
    described as {
      |Adjustment identifier.
    }
  }
  adjustedBy: String(1,100) with {
    briefly "By"
    described as {
      |Who made adjustment.
    }
  }
  reason: String(1,500) with {
    briefly "Reason"
    described as {
      |Adjustment reason.
    }
  }
  targetProductId: ProductId? with {
    briefly "Product"
    described as {
      |Affected product.
    }
  }
  periodStart: Date with {
    briefly "Start"
    described as {
      |Affected period start.
    }
  }
  periodEnd: Date with {
    briefly "End"
    described as {
      |Affected period end.
    }
  }
  originalQuantity: Decimal(15,2) with {
    briefly "Original"
    described as {
      |Original forecast.
    }
  }
  adjustedQuantity: Decimal(15,2) with {
    briefly "Adjusted"
    described as {
      |Adjusted forecast.
    }
  }
  adjustedAt: TimeStamp with {
    briefly "When"
    described as {
      |Adjustment time.
    }
  }
} with {
  briefly "Forecast adjustment"
  described as {
    |Manual forecast modification.
  }
}
type ForecastAccuracy is {
  forecastId: ForecastId with {
    briefly "Forecast"
    described as {
      |Forecast identifier.
    }
  }
  mape: Decimal(5,2) with {
    briefly "MAPE"
    described as {
      |Mean absolute percentage error.
    }
  }
  bias: Decimal(6,2) with {
    briefly "Bias"
    described as {
      |Forecast bias.
    }
  }
  rmse: Decimal(15,2) with {
    briefly "RMSE"
    described as {
      |Root mean square error.
    }
  }
  trackingSignal: Decimal(6,2) with {
    briefly "Tracking"
    described as {
      |Tracking signal.
    }
  }
  calculatedAt: TimeStamp with {
    briefly "Calculated"
    described as {
      |Calculation time.
    }
  }
} with {
  briefly "Forecast accuracy"
  described as {
    |Forecast error metrics.
  }
}
type DemandDriver is {
  driverType: String(1,50) with {
    briefly "Type"
    described as {
      |Driver type.
    }
  }
  description: String(1,500) with {
    briefly "Description"
    described as {
      |Driver description.
    }
  }
  impact: Decimal(8,2) with {
    briefly "Impact"
    described as {
      |Estimated impact.
    }
  }
  startDate: Date with {
    briefly "Start"
    described as {
      |Effect start date.
    }
  }
  effectEndDate: Date? with {
    briefly "End"
    described as {
      |Effect end date.
    }
  }
} with {
  briefly "Demand driver"
  described as {
    |Factor affecting demand.
  }
}
type ConsensusInput is {
  source: String(1,100) with {
    briefly "Source"
    described as {
      |Input source.
    }
  }
  submittedBy: String(1,100) with {
    briefly "Submitted by"
    described as {
      |Who submitted.
    }
  }
  productId: ProductId with {
    briefly "Product"
    described as {
      |Product identifier.
    }
  }
  forecastQuantity: Decimal(15,2) with {
    briefly "Quantity"
    described as {
      |Forecasted quantity.
    }
  }
  confidence: String(1,20) with {
    briefly "Confidence"
    described as {
      |Confidence level.
    }
  }
  notes: String(1,1000)? with {
    briefly "Notes"
    described as {
      |Additional notes.
    }
  }
  submittedAt: TimeStamp with {
    briefly "Submitted"
    described as {
      |Submission time.
    }
  }
} with {
  briefly "Consensus input"
  described as {
    |Input for consensus forecasting.
  }
}
