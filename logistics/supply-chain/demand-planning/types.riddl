// Demand Planning - Shared Types

type ForecastId is Id(ForecastContext.Forecast) with {
  briefly "Forecast identifier"
  described by "Unique identifier for a forecast."
}

type ProductId is UUID with {
  briefly "Product identifier"
  described by "Unique identifier for a product."
}

type LocationId is UUID with {
  briefly "Location identifier"
  described by "Unique identifier for a location."
}

type ForecastStatus is any of {
  Draft,
  InReview,
  Approved,
  Active,
  Superseded,
  Archived
} with {
  briefly "Forecast status"
  described by "Forecast lifecycle status."
}

type ForecastMethod is any of {
  Statistical,
  MachineLearning,
  Judgmental,
  Causal,
  Composite
} with {
  briefly "Forecast method"
  described by "Forecasting methodology used."
}

type TimeGranularity is any of {
  Daily,
  Weekly,
  Monthly,
  Quarterly
} with {
  briefly "Time granularity"
  described by "Forecast time period granularity."
}

type PlanningHorizon is {
  startDate is Date with {
    briefly "Start"
    described by "Forecast start date."
  }
  endDate is Date with {
    briefly "End"
    described by "Forecast end date."
  }
  granularity is TimeGranularity with {
    briefly "Granularity"
    described by "Time period granularity."
  }
  periodCount is Natural with {
    briefly "Periods"
    described by "Number of forecast periods."
  }
} with {
  briefly "Planning horizon"
  described by "Forecast time range."
}

type ForecastPeriod is {
  periodStart is Date with {
    briefly "Start"
    described by "Period start date."
  }
  periodEnd is Date with {
    briefly "End"
    described by "Period end date."
  }
  forecastQuantity is Decimal(15, 2) with {
    briefly "Quantity"
    described by "Forecasted quantity."
  }
  confidenceLow is Decimal(15, 2) with {
    briefly "Low"
    described by "Lower confidence bound."
  }
  confidenceHigh is Decimal(15, 2) with {
    briefly "High"
    described by "Upper confidence bound."
  }
  confidenceLevel is Decimal(5, 2) with {
    briefly "Confidence"
    described by "Confidence level percent."
  }
} with {
  briefly "Forecast period"
  described by "Single period forecast data."
}

type ProductForecast is {
  productId is ProductId with {
    briefly "Product"
    described by "Product identifier."
  }
  productName is String(1, 200) with {
    briefly "Name"
    described by "Product name."
  }
  sku is String(1, 50) with {
    briefly "SKU"
    described by "Stock keeping unit."
  }
  periods is many ForecastPeriod with {
    briefly "Periods"
    described by "Forecast by period."
  }
} with {
  briefly "Product forecast"
  described by "Forecast for single product."
}

type LocationForecast is {
  locationId is LocationId with {
    briefly "Location"
    described by "Location identifier."
  }
  locationName is String(1, 200) with {
    briefly "Name"
    described by "Location name."
  }
  products is many ProductForecast with {
    briefly "Products"
    described by "Product forecasts."
  }
} with {
  briefly "Location forecast"
  described by "Forecast for single location."
}

type HistoricalData is {
  productId is ProductId with {
    briefly "Product"
    described by "Product identifier."
  }
  locationId is LocationId with {
    briefly "Location"
    described by "Location identifier."
  }
  periodStart is Date with {
    briefly "Start"
    described by "Period start."
  }
  periodEnd is Date with {
    briefly "End"
    described by "Period end."
  }
  actualQuantity is Decimal(15, 2) with {
    briefly "Actual"
    described by "Actual demand quantity."
  }
} with {
  briefly "Historical data"
  described by "Past demand data."
}

type ForecastAdjustment is {
  adjustmentId is UUID with {
    briefly "ID"
    described by "Adjustment identifier."
  }
  adjustedBy is String(1, 100) with {
    briefly "By"
    described by "Who made adjustment."
  }
  reason is String(1, 500) with {
    briefly "Reason"
    described by "Adjustment reason."
  }
  productId is optional ProductId with {
    briefly "Product"
    described by "Affected product."
  }
  periodStart is Date with {
    briefly "Start"
    described by "Affected period start."
  }
  periodEnd is Date with {
    briefly "End"
    described by "Affected period end."
  }
  originalQuantity is Decimal(15, 2) with {
    briefly "Original"
    described by "Original forecast."
  }
  adjustedQuantity is Decimal(15, 2) with {
    briefly "Adjusted"
    described by "Adjusted forecast."
  }
  adjustedAt is TimeStamp with {
    briefly "When"
    described by "Adjustment time."
  }
} with {
  briefly "Forecast adjustment"
  described by "Manual forecast modification."
}

type ForecastAccuracy is {
  forecastId is ForecastId with {
    briefly "Forecast"
    described by "Forecast identifier."
  }
  mape is Decimal(5, 2) with {
    briefly "MAPE"
    described by "Mean absolute percentage error."
  }
  bias is Decimal(6, 2) with {
    briefly "Bias"
    described by "Forecast bias."
  }
  rmse is Decimal(15, 2) with {
    briefly "RMSE"
    described by "Root mean square error."
  }
  trackingSignal is Decimal(6, 2) with {
    briefly "Tracking"
    described by "Tracking signal."
  }
  calculatedAt is TimeStamp with {
    briefly "Calculated"
    described by "Calculation time."
  }
} with {
  briefly "Forecast accuracy"
  described by "Forecast error metrics."
}

type DemandDriver is {
  driverType is String(1, 50) with {
    briefly "Type"
    described by "Driver type."
  }
  description is String(1, 500) with {
    briefly "Description"
    described by "Driver description."
  }
  impact is Decimal(8, 2) with {
    briefly "Impact"
    described by "Estimated impact."
  }
  startDate is Date with {
    briefly "Start"
    described by "Effect start date."
  }
  endDate is optional Date with {
    briefly "End"
    described by "Effect end date."
  }
} with {
  briefly "Demand driver"
  described by "Factor affecting demand."
}

type ConsensusInput is {
  source is String(1, 100) with {
    briefly "Source"
    described by "Input source."
  }
  submittedBy is String(1, 100) with {
    briefly "Submitted by"
    described by "Who submitted."
  }
  productId is ProductId with {
    briefly "Product"
    described by "Product identifier."
  }
  forecastQuantity is Decimal(15, 2) with {
    briefly "Quantity"
    described by "Forecasted quantity."
  }
  confidence is String(1, 20) with {
    briefly "Confidence"
    described by "Confidence level."
  }
  notes is optional String(1, 1000) with {
    briefly "Notes"
    described by "Additional notes."
  }
  submittedAt is TimeStamp with {
    briefly "Submitted"
    described by "Submission time."
  }
} with {
  briefly "Consensus input"
  described by "Input for consensus forecasting."
}
