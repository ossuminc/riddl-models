// Marketing Automation - Shared Types

type WorkflowId is Id(AutomationContext.AutomationWorkflow) with {
  briefly "Workflow identifier"
  described by "Unique identifier for an automation workflow."
}

type CampaignId is UUID with {
  briefly "Campaign identifier"
  described by "Reference to a marketing campaign."
}

type LeadId is UUID with {
  briefly "Lead identifier"
  described by "Reference to a lead or contact."
}

type SegmentId is UUID with {
  briefly "Segment identifier"
  described by "Reference to an audience segment."
}

type WorkflowStatus is any of {
  Draft,
  Scheduled,
  Active,
  Paused,
  Completed,
  Archived
} with {
  briefly "Workflow status"
  described by "Automation workflow lifecycle status."
}

type TriggerType is any of {
  TimeBased,
  EventBased,
  BehaviorBased,
  SegmentEntry,
  FormSubmission,
  PageVisit,
  EmailInteraction
} with {
  briefly "Trigger type"
  described by "Type of event that initiates a workflow action."
}

type ChannelType is any of {
  Email,
  SMS,
  PushNotification,
  InAppMessage,
  Webhook
} with {
  briefly "Channel type"
  described by "Communication channel for message delivery."
}

type StepAction is any of {
  SendMessage,
  WaitDelay,
  ConditionalBranch,
  ScoreLeadUpdate,
  AddToSegment,
  RemoveFromSegment,
  NotifySalesRep,
  EndWorkflow
} with {
  briefly "Step action"
  described by "Type of action performed at a workflow step."
}

type TestVariant is any of {
  VariantAlpha,
  VariantBravo,
  VariantCharlie,
  Control
} with {
  briefly "Test variant"
  described by "A/B test variant identifier."
}

type TestMetricType is any of {
  OpenRate,
  ClickRate,
  ConversionRate,
  UnsubscribeRate,
  RevenuePerRecipient
} with {
  briefly "Test metric type"
  described by "Metric used to evaluate A/B test results."
}

type WorkflowTrigger is {
  triggerType is TriggerType with {
    briefly "Type"
    described by "Trigger type."
  }
  triggerCondition is String(3, 500) with {
    briefly "Condition"
    described by "Trigger condition expression."
  }
  segmentId is optional SegmentId with {
    briefly "Segment"
    described by "Target segment for trigger."
  }
} with {
  briefly "Workflow trigger"
  described by "Defines what initiates the workflow."
}

type WorkflowStep is {
  stepId is UUID with {
    briefly "Step ID"
    described by "Step identifier."
  }
  stepOrder is Natural with {
    briefly "Order"
    described by "Step execution order."
  }
  action is StepAction with {
    briefly "Action"
    described by "Action to perform."
  }
  channel is optional ChannelType with {
    briefly "Channel"
    described by "Delivery channel if sending message."
  }
  subject is optional String(3, 200) with {
    briefly "Subject"
    described by "Message subject line."
  }
  contentBody is optional String(3, 10000) with {
    briefly "Content"
    described by "Message content body."
  }
  delayHours is optional Natural with {
    briefly "Delay"
    described by "Hours to wait before executing step."
  }
  conditionExpr is optional String(3, 500) with {
    briefly "Condition"
    described by "Branch condition expression."
  }
} with {
  briefly "Workflow step"
  described by "A single step in the automation workflow."
}

type ABTestConfig is {
  testName is String(3, 200) with {
    briefly "Name"
    described by "A/B test name."
  }
  targetMetric is TestMetricType with {
    briefly "Metric"
    described by "Primary metric for evaluation."
  }
  variants is many TestVariant with {
    briefly "Variants"
    described by "Test variants."
  }
  samplePercentage is Decimal(5, 2) with {
    briefly "Sample"
    described by "Percentage of audience in test."
  }
  durationHours is Natural with {
    briefly "Duration"
    described by "Test duration in hours."
  }
} with {
  briefly "A/B test configuration"
  described by "Configuration for an A/B test experiment."
}

type ABTestResult is {
  variant is TestVariant with {
    briefly "Variant"
    described by "Test variant."
  }
  recipientCount is Natural with {
    briefly "Recipients"
    described by "Number of recipients."
  }
  metricValue is Decimal(10, 4) with {
    briefly "Value"
    described by "Metric value for variant."
  }
  isWinner is Boolean with {
    briefly "Winner"
    described by "Whether this variant won."
  }
} with {
  briefly "A/B test result"
  described by "Result for a single A/B test variant."
}

type LeadEnrollment is {
  leadId is LeadId with {
    briefly "Lead"
    described by "Enrolled lead identifier."
  }
  enrolledAt is TimeStamp with {
    briefly "Enrolled"
    described by "Enrollment timestamp."
  }
  currentStepId is optional UUID with {
    briefly "Current step"
    described by "Current workflow step."
  }
  status is String(3, 50) with {
    briefly "Status"
    described by "Enrollment status."
  }
} with {
  briefly "Lead enrollment"
  described by "A lead enrolled in a workflow."
}

type CampaignMetrics is {
  totalEnrolled is Natural with {
    briefly "Enrolled"
    described by "Total leads enrolled."
  }
  totalSent is Natural with {
    briefly "Sent"
    described by "Total messages sent."
  }
  totalOpened is Natural with {
    briefly "Opened"
    described by "Total messages opened."
  }
  totalClicked is Natural with {
    briefly "Clicked"
    described by "Total link clicks."
  }
  totalConverted is Natural with {
    briefly "Converted"
    described by "Total conversions."
  }
  totalUnsubscribed is Natural with {
    briefly "Unsubscribed"
    described by "Total unsubscribes."
  }
} with {
  briefly "Campaign metrics"
  described by "Aggregate campaign performance metrics."
}
