// Campaign Management Bounded Context

context CampaignContext is {

  include "Campaign.riddl"

  source CampaignCommands is {
    outlet Commands is type CreateCampaign
  } briefly "Source of campaign commands"
    described by {
      | Receives campaign commands from external systems and user interfaces.
    }

  sink CampaignEvents is {
    inlet Events is type CampaignCreated
  } briefly "Sink for campaign events"
    described by {
      | Publishes campaign events for consumption by projectors,
      | external systems, and analytics pipelines.
    }

  repository CampaignRepository is {

    handler CampaignQueryHandler is {
      on query GetCampaignById {
        ???
      }
      on query ListCampaignsByStatus {
        ???
      }
      on query ListCampaignsByObjective {
        ???
      }
      on query SearchCampaigns {
        ???
      }
      on query GetCampaignPerformance {
        ???
      }
    } briefly "Handler for campaign queries"
      described by {
        | Processes queries against the campaign repository,
        | returning campaign data and aggregations.
      }

    query GetCampaignById is {
      campaignId: CampaignId
    } briefly "Retrieve a campaign by ID"
      described by "Returns the full campaign state for the specified ID."

    result CampaignResult is {
      campaign: Campaign.CampaignStateRecord
    } briefly "Single campaign result"
      described by "Contains the complete state of a single campaign."

    query ListCampaignsByStatus is {
      status: CampaignStatus,
      limit: Integer,
      offset: Integer
    } briefly "List campaigns by status"
      described by "Returns campaigns filtered by their current status."

    query ListCampaignsByObjective is {
      objective: CampaignObjective,
      limit: Integer,
      offset: Integer
    } briefly "List campaigns by objective"
      described by "Returns campaigns filtered by their strategic objective."

    query SearchCampaigns is {
      namePattern: String,
      statuses: CampaignStatus*,
      objectives: CampaignObjective*,
      startDateFrom: Date,
      startDateTo: Date,
      limit: Integer,
      offset: Integer
    } briefly "Search campaigns with filters"
      described by {
        | Searches campaigns using multiple filter criteria including
        | name pattern matching, status, objective, and date range.
      }

    result CampaignListResult is {
      campaigns: Campaign.CampaignStateRecord*,
      totalCount: Integer
    } briefly "List of campaigns result"
      described by "Contains a paginated list of campaigns with total count."

    query GetCampaignPerformance is {
      campaignId: CampaignId,
      startDate: Date,
      endDate: Date
    } briefly "Get campaign performance metrics"
      described by "Returns performance metrics for a campaign within a date range."

    result PerformanceResult is {
      campaignId: CampaignId,
      metrics: PerformanceMetrics,
      channelBreakdown: ChannelPerformance*
    } briefly "Campaign performance result"
      described by "Contains aggregate and channel-level performance metrics."

  } briefly "Repository for campaign persistence and queries"
    described by {
      | The Campaign Repository handles persistence of campaign state
      | and provides query capabilities for campaign retrieval and search.
    }

  projector CampaignDashboardProjector is {

    record DashboardCampaignSummary is {
      campaignId: CampaignId,
      name: CampaignName,
      status: CampaignStatus,
      objective: CampaignObjective,
      totalBudget: BudgetAmount,
      spentBudget: BudgetAmount,
      impressions: PerformanceMetricValue,
      clicks: PerformanceMetricValue,
      conversions: PerformanceMetricValue,
      returnOnAdSpend: Number,
      lastUpdated: TimeStamp
    } briefly "Summary record for dashboard display"
      described by {
        | A denormalized view of campaign data optimized for
        | dashboard display and quick scanning.
      }

    handler DashboardProjectionHandler is {
      on event CampaignCreated {
        ???
      }
      on event CampaignLaunched {
        ???
      }
      on event CampaignPaused {
        ???
      }
      on event CampaignResumed {
        ???
      }
      on event CampaignCompleted {
        ???
      }
      on event PerformanceMetricsRecorded {
        ???
      }
    } briefly "Handler for dashboard projection updates"
      described by {
        | Listens to campaign events and updates the dashboard
        | projection with current campaign status and metrics.
      }

  } briefly "Projector for campaign dashboard views"
    described by {
      | Maintains a read-optimized projection of campaign data
      | for dashboard displays and quick status overviews.
    }

  projector CampaignPerformanceProjector is {

    record PerformanceTimeSeries is {
      campaignId: CampaignId,
      date: Date,
      impressions: PerformanceMetricValue,
      clicks: PerformanceMetricValue,
      conversions: PerformanceMetricValue,
      spend: BudgetAmount
    } briefly "Daily performance time series record"
      described by {
        | Captures daily performance metrics for time series analysis
        | and trend visualization.
      }

    record ChannelComparison is {
      campaignId: CampaignId,
      channelId: ChannelId,
      channelType: ChannelType,
      impressions: PerformanceMetricValue,
      clicks: PerformanceMetricValue,
      conversions: PerformanceMetricValue,
      spend: BudgetAmount,
      costPerConversion: Number
    } briefly "Channel comparison record"
      described by {
        | Enables side-by-side comparison of channel performance
        | within a campaign.
      }

    handler PerformanceProjectionHandler is {
      on event PerformanceMetricsRecorded {
        ???
      }
      on event CampaignCompleted {
        ???
      }
    } briefly "Handler for performance projection updates"
      described by {
        | Processes performance events to maintain time series
        | and channel comparison projections.
      }

  } briefly "Projector for performance analytics"
    described by {
      | Maintains read-optimized projections of performance data
      | for analytics, reporting, and trend analysis.
    }

} briefly "Bounded context for campaign management"
  described by {
    | The Campaign Context encapsulates all campaign management capabilities
    | including the Campaign aggregate, repositories for persistence and query,
    | and projectors for read-optimized views.
  }
