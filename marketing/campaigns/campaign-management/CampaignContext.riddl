// Campaign Management Bounded Context
context CampaignContext is {
  include "Campaign.riddl"
  source CampaignCommands is {
    outlet Commands is type CreateCampaign
  } with {
    briefly "Source of campaign commands"
    described as {
      | Receives campaign commands from external systems and user interfaces.
    }
  }
  sink CampaignEvents is {
    inlet Events is type CampaignCreated  } with {
    briefly "Sink for campaign events"
    described as {
      | Publishes campaign events for consumption by projectors,
      | external systems, and analytics pipelines.
    }
  }
  repository CampaignRepository is {
    handler CampaignQueryHandler is {
      on query GetCampaignById is { ??? }
      on query ListCampaignsByStatus is { ??? }
      on query ListCampaignsByObjective is { ??? }
      on query SearchCampaigns is { ??? }
      on query GetCampaignPerformance is { ??? }
    } with {
      briefly "Handler for campaign queries"
      described as {
        | Processes queries against the campaign repository,
        | returning campaign data and aggregations.
      }
    }
    query GetCampaignById is  { campaignId: CampaignId } with {
      briefly "Retrieve a campaign by ID"
      described as {
        |Returns the full campaign state for the specified ID.
      }
    }
    result CampaignResult is  { campaign: Campaign.CampaignStateRecord } with {
      briefly "Single campaign result"
      described as {
        |Contains the complete state of a single campaign.
      }
    }
    query ListCampaignsByStatus is  {
      status: CampaignStatus
      limit: Integer
      offset: Integer
    } with {
      briefly "List campaigns by status"
      described as {
        |Returns campaigns filtered by their current status.
      }
    }
    query ListCampaignsByObjective is  {
      objective: CampaignObjective
      limit: Integer
      offset: Integer
    } with {
      briefly "List campaigns by objective"
      described as {
        |Returns campaigns filtered by their strategic objective.
      }
    }
    query SearchCampaigns is  {
      namePattern: String
      statuses: CampaignStatus*
      objectives: CampaignObjective*
      startDateFrom: Date
      startDateTo: Date
      limit: Integer
      offset: Integer
    } with {
      briefly "Search campaigns with filters"
      described as {
        | Searches campaigns using multiple filter criteria including
        | name pattern matching, status, objective, and date range.
      }
    }
    result CampaignListResult is  {
      campaigns: Campaign.CampaignStateRecord*
      totalCount: Integer
    } with {
      briefly "List of campaigns result"
      described as {
        |Contains a paginated list of campaigns with total count.
      }
    }
    query GetCampaignPerformance is  {
      campaignId: CampaignId
      startDate: Date
      endDate: Date
    } with {
      briefly "Get campaign performance metrics"
      described as {
        |Returns performance metrics for a campaign within a date range.
      }
    }
    result PerformanceResult is  {
      campaignId: CampaignId
      metrics: PerformanceMetrics
      channelBreakdown: ChannelPerformance*
    } with {
      briefly "Campaign performance result"
      described as {
        |Contains aggregate and channel-level performance metrics.
      }
    }
  } with {
    briefly "Repository for campaign persistence and queries"
    described as {
      | The Campaign Repository handles persistence of campaign state
      | and provides query capabilities for campaign retrieval and search.
    }
  }
  projector CampaignDashboardProjector is {
    record DashboardCampaignSummary is  {
      campaignId: CampaignId
      name: CampaignName
      status: CampaignStatus
      objective: CampaignObjective
      totalBudget: BudgetAmount
      spentBudget: BudgetAmount
      impressions: PerformanceMetricValue
      clicks: PerformanceMetricValue
      conversions: PerformanceMetricValue
      returnOnAdSpend: Number
      lastUpdated: TimeStamp
    } with {
      briefly "Summary record for dashboard display"
      described as {
        | A denormalized view of campaign data optimized for
        | dashboard display and quick scanning.
      }
    }
    handler DashboardProjectionHandler is {
      on event CampaignCreated is { ??? }
      on event CampaignLaunched is { ??? }
      on event CampaignPaused is { ??? }
      on event CampaignResumed is { ??? }
      on event CampaignCompleted is { ??? }
      on event PerformanceMetricsRecorded is { ??? }
    } with {
      briefly "Handler for dashboard projection updates"
      described as {
        | Listens to campaign events and updates the dashboard
        | projection with current campaign status and metrics.
      }
    }
  } with {
    briefly "Projector for campaign dashboard views"
    described as {
      | Maintains a read-optimized projection of campaign data
      | for dashboard displays and quick status overviews.
    }
  }
  projector CampaignPerformanceProjector is {
    record PerformanceTimeSeries is  {
      campaignId: CampaignId
      date: Date
      impressions: PerformanceMetricValue
      clicks: PerformanceMetricValue
      conversions: PerformanceMetricValue
      spend: BudgetAmount
    } with {
      briefly "Daily performance time series record"
      described as {
        | Captures daily performance metrics for time series analysis
        | and trend visualization.
      }
    }
    record ChannelComparison is  {
      campaignId: CampaignId
      channelId: ChannelId
      channelType: ChannelType
      impressions: PerformanceMetricValue
      clicks: PerformanceMetricValue
      conversions: PerformanceMetricValue
      spend: BudgetAmount
      costPerConversion: Number
    } with {
      briefly "Channel comparison record"
      described as {
        | Enables side-by-side comparison of channel performance
        | within a campaign.
      }
    }
    handler PerformanceProjectionHandler is {
      on event PerformanceMetricsRecorded is { ??? }
      on event CampaignCompleted is { ??? }
    } with {
      briefly "Handler for performance projection updates"
      described as {
        | Processes performance events to maintain time series
        | and channel comparison projections.
      }
    }
  } with {
    briefly "Projector for performance analytics"
    described as {
      | Maintains read-optimized projections of performance data
      | for analytics, reporting, and trend analysis.
    }
  }
} with {
  briefly "Bounded context for campaign management"
  described as {
    | The Campaign Context encapsulates all campaign management capabilities
    | including the Campaign aggregate, repositories for persistence and query,
    | and projectors for read-optimized views.
  }
}
