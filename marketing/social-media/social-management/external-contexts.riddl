// Social Media Management - External Contexts

context PlatformAPI is {

  command PublishToPlatform is {
    accountId is AccountId with { briefly "Account" described by "Account ID." }
    platform is Platform with { briefly "Platform" described by "Target platform." }
    content is PostContent with { briefly "Content" described by "Post content." }
  } with {
    briefly "Publish to platform"
    described by "Publishes post to platform."
  }

  event PlatformPublished is {
    accountId is AccountId with { briefly "Account" described by "Account ID." }
    platform is Platform with { briefly "Platform" described by "Platform." }
    platformPostId is String(1, 100) with { briefly "Post ID" described by "Platform's ID." }
    postUrl is URL with { briefly "URL" described by "Post URL." }
    publishedAt is TimeStamp with { briefly "Published" described by "Publish time." }
  } with {
    briefly "Platform published"
    described by "Emitted when published."
  }

  event PlatformPublishFailed is {
    accountId is AccountId with { briefly "Account" described by "Account ID." }
    platform is Platform with { briefly "Platform" described by "Platform." }
    errorCode is String(1, 50) with { briefly "Code" described by "Error code." }
    errorMessage is String(1, 500) with { briefly "Message" described by "Error message." }
  } with {
    briefly "Platform publish failed"
    described by "Emitted when publish fails."
  }

  command FetchEngagement is {
    platformPostId is String(1, 100) with { briefly "Post ID" described by "Platform post ID." }
    platform is Platform with { briefly "Platform" described by "Platform." }
  } with {
    briefly "Fetch engagement"
    described by "Gets engagement metrics."
  }

  event EngagementFetched is {
    platformPostId is String(1, 100) with { briefly "Post ID" described by "Platform post ID." }
    metrics is EngagementMetrics with { briefly "Metrics" described by "Engagement data." }
    fetchedAt is TimeStamp with { briefly "Fetched" described by "Fetch time." }
  } with {
    briefly "Engagement fetched"
    described by "Emitted when metrics retrieved."
  }

  command FetchComments is {
    platformPostId is String(1, 100) with { briefly "Post ID" described by "Platform post ID." }
    platform is Platform with { briefly "Platform" described by "Platform." }
  } with {
    briefly "Fetch comments"
    described by "Gets post comments."
  }

  event CommentsFetched is {
    platformPostId is String(1, 100) with { briefly "Post ID" described by "Platform post ID." }
    comments is many Comment with { briefly "Comments" described by "Post comments." }
    fetchedAt is TimeStamp with { briefly "Fetched" described by "Fetch time." }
  } with {
    briefly "Comments fetched"
    described by "Emitted when comments retrieved."
  }

  command PostReply is {
    platformPostId is String(1, 100) with { briefly "Post ID" described by "Platform post ID." }
    commentId is String(1, 100) with { briefly "Comment" described by "Comment ID." }
    platform is Platform with { briefly "Platform" described by "Platform." }
    replyText is String(1, 5000) with { briefly "Reply" described by "Reply text." }
  } with {
    briefly "Post reply"
    described by "Posts reply to comment."
  }

  event ReplyPosted is {
    commentId is String(1, 100) with { briefly "Comment" described by "Comment ID." }
    replyId is String(1, 100) with { briefly "Reply" described by "Reply ID." }
    postedAt is TimeStamp with { briefly "Posted" described by "Post time." }
  } with {
    briefly "Reply posted"
    described by "Emitted when reply posted."
  }

} with {
  option is external
  briefly "External platform API"
  described by "Social media platform APIs."
}

context MediaStorage is {

  command UploadMedia is {
    fileName is String(1, 255) with { briefly "File" described by "File name." }
    mimeType is String(1, 100) with { briefly "Type" described by "MIME type." }
    data is String(1, 100000000) with { briefly "Data" described by "Base64 data." }
  } with {
    briefly "Upload media"
    described by "Uploads media file."
  }

  event MediaUploaded is {
    assetId is UUID with { briefly "Asset" described by "Asset ID." }
    url is URL with { briefly "URL" described by "Media URL." }
    thumbnailUrl is optional URL with { briefly "Thumbnail" described by "Thumbnail URL." }
    uploadedAt is TimeStamp with { briefly "Uploaded" described by "Upload time." }
  } with {
    briefly "Media uploaded"
    described by "Emitted when upload complete."
  }

  command GenerateThumbnail is {
    assetId is UUID with { briefly "Asset" described by "Asset ID." }
    targetDimensions is String(1, 20) with { briefly "Dimensions" described by "Target size." }
  } with {
    briefly "Generate thumbnail"
    described by "Creates thumbnail image."
  }

  event ThumbnailGenerated is {
    assetId is UUID with { briefly "Asset" described by "Asset ID." }
    generatedThumbnailUrl is URL with { briefly "URL" described by "Thumbnail URL." }
  } with {
    briefly "Thumbnail generated"
    described by "Emitted when thumbnail ready."
  }

} with {
  option is external
  briefly "External media storage"
  described by "Media file storage service."
}

context OptimalTimeService is {

  command GetOptimalPostTime is {
    accountId is AccountId with { briefly "Account" described by "Account ID." }
    platform is Platform with { briefly "Platform" described by "Platform." }
    contentType is ContentType with { briefly "Type" described by "Content type." }
  } with {
    briefly "Get optimal time"
    described by "Calculates best post time."
  }

  event OptimalTimeCalculated is {
    accountId is AccountId with { briefly "Account" described by "Account ID." }
    platform is Platform with { briefly "Platform" described by "Platform." }
    optimalTime is TimeStamp with { briefly "Time" described by "Best time to post." }
    confidence is Decimal(3, 2) with { briefly "Confidence" described by "Confidence score." }
  } with {
    briefly "Optimal time calculated"
    described by "Emitted when time computed."
  }

} with {
  option is external
  briefly "External optimal time"
  described by "Post timing optimization."
}

context SentimentAnalysis is {

  command AnalyzeComment is {
    commentId is String(1, 100) with { briefly "Comment" described by "Comment ID." }
    text is String(1, 5000) with { briefly "Text" described by "Comment text." }
  } with {
    briefly "Analyze comment"
    described by "Analyzes comment sentiment."
  }

  event SentimentAnalyzed is {
    commentId is String(1, 100) with { briefly "Comment" described by "Comment ID." }
    sentiment is String(1, 20) with { briefly "Sentiment" described by "Positive/negative/neutral." }
    score is Decimal(3, 2) with { briefly "Score" described by "Sentiment score." }
    requiresAttention is Boolean with { briefly "Attention" described by "Needs response." }
  } with {
    briefly "Sentiment analyzed"
    described by "Emitted when analysis complete."
  }

} with {
  option is external
  briefly "External sentiment analysis"
  described by "Comment sentiment service."
}
