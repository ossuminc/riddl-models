// Content Management - Content Context
context ContentContext is {
  include "types.riddl"
  include "Content.riddl"
  repository ContentRepository is {
    schema ContentData is relational
      of content as type Content
        index on field Content.status
        index on field Content.category
        index on field Content.brief.dueDate
        index on field Content.assignedWriter

    handler ContentPersistence is {
      on command Content.CreateContent is {
        prompt "Store new content record"
      }
      on command Content.SubmitDraft is {
        prompt "Store content draft"
      }
      on command Content.AttachMedia is {
        prompt "Store media attachment"
      }
      on command Content.RequestReview is {
        prompt "Update to review status"
      }
      on command Content.AddReviewComment is {
        prompt "Store review comment"
      }
      on command Content.SubmitRevision is {
        prompt "Store new version"
      }
      on command Content.ApproveContent is {
        prompt "Update to approved status"
      }
      on command Content.PublishContent is {
        prompt "Update to published status"
      }
      on command Content.UpdateMetrics is {
        prompt "Store content metrics"
      }
      on command Content.ArchiveContent is {
        prompt "Archive content record"
      }
    } with {
      briefly "Persists content commands"
      described as {
        |Handles command-driven persistence.
      }
    }
  } with {
    briefly "Content data persistence"
    described as {
      |Persistent storage for content.
    }
  }
  projector ContentAnalytics is {
    record ContentMetricsAgg is  {
      totalContent: Natural with {
        briefly "Total"
        described as {
          |Total content.
        }
      }
      inProduction: Natural with {
        briefly "Production"
        described as {
          |In production.
        }
      }
      publishedThisMonth: Natural with {
        briefly "Published"
        described as {
          |Published this month.
        }
      }
      averageProductionDays: Decimal(5,1) with {
        briefly "Avg days"
        described as {
          |Avg production time.
        }
      }
      topPerformingCategory: String(1,50) with {
        briefly "Top category"
        described as {
          |Best category.
        }
      }
      totalViews: Natural with {
        briefly "Views"
        described as {
          |Total views.
        }
      }
    } with {
      briefly "Content metrics aggregate"
      described as {
        |Aggregate content metrics.
      }
    }
    handler AnalyticsHandler is {
      on event Content.ContentCreated is {
        prompt "Increment content count"
      }
      on event Content.ContentPublished is {
        prompt "Track publication"
      }
      on event Content.MetricsUpdated is {
        prompt "Aggregate performance"
      }
      on event Content.ContentArchived is {
        prompt "Update production stats"
      }
    } with {
      briefly "Maintains content analytics"
      described as {
        |Projects events into metrics.
      }
    }
  } with {
    briefly "Content analytics"
    described as {
      |Content performance tracking.
    }
  }
} with {
  briefly "Bounded context for content management"
  described as {
    |Marketing content workflow context.
  }
}
