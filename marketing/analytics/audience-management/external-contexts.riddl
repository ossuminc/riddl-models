// Audience Management - External Contexts
context DataManagementPlatform is {
  query GetCustomerProfiles is  {
    criteria: SegmentCriteria+ with {
      briefly "Criteria"
      described as {
        |Search criteria.
      }
    }
    maxResults: Natural with {
      briefly "Max results"
      described as {
        |Maximum profiles to return.
      }
    }
  } with {
    briefly "Get customer profiles"
    described as {
      |Retrieves matching customer profiles.
    }
  }
  result CustomerProfiles is  {
    profiles: AudienceMember+ with {
      briefly "Profiles"
      described as {
        |Matching profiles.
      }
    }
    totalMatches: Natural with {
      briefly "Total"
      described as {
        |Total matching profiles.
      }
    }
  } with {
    briefly "Customer profiles"
    described as {
      |Matching customer profile results.
    }
  }
  command SyncAudienceData is  {
    segmentId: SegmentId with {
      briefly "Segment"
      described as {
        |Segment ID.
      }
    }
    members: AudienceMember+ with {
      briefly "Members"
      described as {
        |Members to sync.
      }
    }
  } with {
    briefly "Sync audience data"
    described as {
      |Synchronizes audience data with the platform.
    }
  }
  event AudienceDataSynced is  {
    segmentId: SegmentId with {
      briefly "Segment"
      described as {
        |Segment ID.
      }
    }
    syncedCount: Natural with {
      briefly "Synced"
      described as {
        |Members synced.
      }
    }
    syncedAt: TimeStamp with {
      briefly "Synced at"
      described as {
        |Sync time.
      }
    }
  } with {
    briefly "Audience data synced"
    described as {
      |Emitted when audience data is synchronized.
    }
  }
} with {
  option external()
  briefly "External data management platform"
  described as {
    |Customer data platform for profile and attribute management.
  }
}
context AdPlatform is {
  command PushAudience is  {
    segmentId: SegmentId with {
      briefly "Segment"
      described as {
        |Segment ID.
      }
    }
    channelType: ActivationChannel with {
      briefly "Channel"
      described as {
        |Target channel.
      }
    }
    members: AudienceMember+ with {
      briefly "Members"
      described as {
        |Audience members.
      }
    }
    campaignId: CampaignId with {
      briefly "Campaign"
      described as {
        |Campaign ID.
      }
    }
  } with {
    briefly "Push audience"
    described as {
      |Pushes audience segment to ad platform.
    }
  }
  event AudiencePushed is  {
    segmentId: SegmentId with {
      briefly "Segment"
      described as {
        |Segment ID.
      }
    }
    channelType: ActivationChannel with {
      briefly "Channel"
      described as {
        |Target channel.
      }
    }
    pushedCount: Natural with {
      briefly "Pushed"
      described as {
        |Members pushed.
      }
    }
    pushedAt: TimeStamp with {
      briefly "Pushed at"
      described as {
        |Push time.
      }
    }
  } with {
    briefly "Audience pushed"
    described as {
      |Emitted when audience is pushed to ad platform.
    }
  }
  command BuildLookalikeAudience is  {
    sourceSegmentId: SegmentId with {
      briefly "Source"
      described as {
        |Seed segment.
      }
    }
    lookalikeConfig: LookalikeConfig with {
      briefly "Config"
      described as {
        |Lookalike configuration.
      }
    }
  } with {
    briefly "Build lookalike audience"
    described as {
      |Creates a lookalike audience from a seed segment.
    }
  }
  event LookalikeAudienceBuilt is  {
    sourceSegmentId: SegmentId with {
      briefly "Source"
      described as {
        |Seed segment.
      }
    }
    newMemberCount: Natural with {
      briefly "New members"
      described as {
        |Lookalike members found.
      }
    }
    builtAt: TimeStamp with {
      briefly "Built at"
      described as {
        |Build time.
      }
    }
  } with {
    briefly "Lookalike audience built"
    described as {
      |Emitted when lookalike audience modeling completes.
    }
  }
  query GetChannelReach is  {
    channelType: ActivationChannel with {
      briefly "Channel"
      described as {
        |Channel type.
      }
    }
    segmentId: SegmentId with {
      briefly "Segment"
      described as {
        |Segment ID.
      }
    }
  } with {
    briefly "Get channel reach"
    described as {
      |Gets estimated reach for a segment on a channel.
    }
  }
  result ChannelReach is  {
    channelType: ActivationChannel with {
      briefly "Channel"
      described as {
        |Channel type.
      }
    }
    estimatedReach: Natural with {
      briefly "Reach"
      described as {
        |Estimated reach.
      }
    }
    matchRate: Decimal(5,2) with {
      briefly "Match rate"
      described as {
        |Platform match rate.
      }
    }
  } with {
    briefly "Channel reach"
    described as {
      |Estimated audience reach on a channel.
    }
  }
} with {
  option external()
  briefly "External advertising platform"
  described as {
    |Advertising platform for audience activation and targeting.
  }
}
