// Fund Administration - External Contexts

context CustodianSystem is {

  command TransferFunds is {
    transactionId is TransactionId with { briefly "Transaction" described by "Transaction ID." }
    fromAccount is String(3, 100) with { briefly "From" described by "Source account." }
    toAccount is String(3, 100) with { briefly "To" described by "Destination account." }
    transferAmount is MoneyAmount with { briefly "Amount" described by "Transfer amount." }
  } with {
    briefly "Transfer funds"
    described by "Initiates a fund transfer between accounts."
  }

  event FundsTransferred is {
    transactionId is TransactionId with { briefly "Transaction" described by "Transaction ID." }
    transferredAmount is MoneyAmount with { briefly "Amount" described by "Transferred amount." }
    transferredAt is TimeStamp with { briefly "Transferred" described by "Transfer time." }
  } with {
    briefly "Funds transferred"
    described by "Emitted when funds are transferred."
  }

  query GetAccountBalance is {
    accountNumber is String(3, 100) with { briefly "Account" described by "Account number." }
  } with {
    briefly "Get account balance"
    described by "Retrieves custodial account balance."
  }

  result AccountBalance is {
    accountNumber is String(3, 100) with { briefly "Account" described by "Account number." }
    balance is MoneyAmount with { briefly "Balance" described by "Current balance." }
    asOfDate is Date with { briefly "As of" described by "Balance date." }
  } with {
    briefly "Account balance"
    described by "Custodial account balance."
  }

} with {
  option is external
  briefly "External custodian system"
  described by "Custodial bank holding fund assets."
}

context RegulatoryFiling is {

  command SubmitFiling is {
    filingId is UUID with { briefly "Filing ID" described by "Filing identifier." }
    filingType is String(3, 100) with { briefly "Type" described by "Filing type." }
    fundId is FundId with { briefly "Fund" described by "Fund identifier." }
    reportPeriod is ReportPeriod with { briefly "Period" described by "Reporting period." }
    filingData is String(3, 10000) with { briefly "Data" described by "Filing content." }
  } with {
    briefly "Submit filing"
    described by "Submits a regulatory filing."
  }

  event FilingSubmitted is {
    filingId is UUID with { briefly "Filing ID" described by "Filing identifier." }
    filingType is String(3, 100) with { briefly "Type" described by "Filing type." }
    submittedAt is TimeStamp with { briefly "Submitted" described by "Submission time." }
  } with {
    briefly "Filing submitted"
    described by "Emitted when a regulatory filing is submitted."
  }

  event FilingAccepted is {
    filingId is UUID with { briefly "Filing ID" described by "Filing identifier." }
    acceptedAt is TimeStamp with { briefly "Accepted" described by "Acceptance time." }
    confirmationNumber is String(3, 100) with { briefly "Confirmation" described by "Filing confirmation number." }
  } with {
    briefly "Filing accepted"
    described by "Emitted when a regulatory filing is accepted."
  }

  event FilingRejected is {
    filingId is UUID with { briefly "Filing ID" described by "Filing identifier." }
    rejectedAt is TimeStamp with { briefly "Rejected" described by "Rejection time." }
    rejectionReason is String(3, 500) with { briefly "Reason" described by "Reason for rejection." }
  } with {
    briefly "Filing rejected"
    described by "Emitted when a regulatory filing is rejected."
  }

  query GetFilingStatus is {
    filingId is UUID with { briefly "Filing ID" described by "Filing identifier." }
  } with {
    briefly "Get filing status"
    described by "Checks status of a regulatory filing."
  }

  result FilingStatus is {
    filingId is UUID with { briefly "Filing ID" described by "Filing identifier." }
    filingStatus is String(3, 50) with { briefly "Status" described by "Filing status." }
    lastUpdated is TimeStamp with { briefly "Updated" described by "Last update time." }
  } with {
    briefly "Filing status"
    described by "Regulatory filing status."
  }

} with {
  option is external
  briefly "External regulatory filing system"
  described by "System for submitting regulatory filings to authorities."
}
