// Fund Administration - External Contexts
context CustodianSystem is {
  command TransferFunds is  {
    transactionId: TransactionId with {
      briefly "Transaction"
      described as {
        |Transaction ID.
      }
    }
    fromAccount: String(3,100) with {
      briefly "From"
      described as {
        |Source account.
      }
    }
    toAccount: String(3,100) with {
      briefly "To"
      described as {
        |Destination account.
      }
    }
    transferAmount: MoneyAmount with {
      briefly "Amount"
      described as {
        |Transfer amount.
      }
    }
  } with {
    briefly "Transfer funds"
    described as {
      |Initiates a fund transfer between accounts.
    }
  }
  event FundsTransferred is  {
    transactionId: TransactionId with {
      briefly "Transaction"
      described as {
        |Transaction ID.
      }
    }
    transferredAmount: MoneyAmount with {
      briefly "Amount"
      described as {
        |Transferred amount.
      }
    }
    transferredAt: TimeStamp with {
      briefly "Transferred"
      described as {
        |Transfer time.
      }
    }
  } with {
    briefly "Funds transferred"
    described as {
      |Emitted when funds are transferred.
    }
  }
  query GetAccountBalance is  {
    accountNumber: String(3,100) with {
      briefly "Account"
      described as {
        |Account number.
      }
    }
  } with {
    briefly "Get account balance"
    described as {
      |Retrieves custodial account balance.
    }
  }
  result AccountBalance is  {
    accountNumber: String(3,100) with {
      briefly "Account"
      described as {
        |Account number.
      }
    }
    balance: MoneyAmount with {
      briefly "Balance"
      described as {
        |Current balance.
      }
    }
    asOfDate: Date with {
      briefly "As of"
      described as {
        |Balance date.
      }
    }
  } with {
    briefly "Account balance"
    described as {
      |Custodial account balance.
    }
  }
} with {
  option external()
  briefly "External custodian system"
  described as {
    |Custodial bank holding fund assets.
  }
}
context RegulatoryFiling is {
  command SubmitFiling is  {
    filingId: UUID with {
      briefly "Filing ID"
      described as {
        |Filing identifier.
      }
    }
    filingType: String(3,100) with {
      briefly "Type"
      described as {
        |Filing type.
      }
    }
    fundId: FundId with {
      briefly "Fund"
      described as {
        |Fund identifier.
      }
    }
    reportPeriod: ReportPeriod with {
      briefly "Period"
      described as {
        |Reporting period.
      }
    }
    filingData: String(3,10000) with {
      briefly "Data"
      described as {
        |Filing content.
      }
    }
  } with {
    briefly "Submit filing"
    described as {
      |Submits a regulatory filing.
    }
  }
  event FilingSubmitted is  {
    filingId: UUID with {
      briefly "Filing ID"
      described as {
        |Filing identifier.
      }
    }
    filingType: String(3,100) with {
      briefly "Type"
      described as {
        |Filing type.
      }
    }
    submittedAt: TimeStamp with {
      briefly "Submitted"
      described as {
        |Submission time.
      }
    }
  } with {
    briefly "Filing submitted"
    described as {
      |Emitted when a regulatory filing is submitted.
    }
  }
  event FilingAccepted is  {
    filingId: UUID with {
      briefly "Filing ID"
      described as {
        |Filing identifier.
      }
    }
    acceptedAt: TimeStamp with {
      briefly "Accepted"
      described as {
        |Acceptance time.
      }
    }
    confirmationNumber: String(3,100) with {
      briefly "Confirmation"
      described as {
        |Filing confirmation number.
      }
    }
  } with {
    briefly "Filing accepted"
    described as {
      |Emitted when a regulatory filing is accepted.
    }
  }
  event FilingRejected is  {
    filingId: UUID with {
      briefly "Filing ID"
      described as {
        |Filing identifier.
      }
    }
    rejectedAt: TimeStamp with {
      briefly "Rejected"
      described as {
        |Rejection time.
      }
    }
    rejectionReason: String(3,500) with {
      briefly "Reason"
      described as {
        |Reason for rejection.
      }
    }
  } with {
    briefly "Filing rejected"
    described as {
      |Emitted when a regulatory filing is rejected.
    }
  }
  query GetFilingStatus is  {
    filingId: UUID with {
      briefly "Filing ID"
      described as {
        |Filing identifier.
      }
    }
  } with {
    briefly "Get filing status"
    described as {
      |Checks status of a regulatory filing.
    }
  }
  result FilingStatus is  {
    filingId: UUID with {
      briefly "Filing ID"
      described as {
        |Filing identifier.
      }
    }
    filingStatus: String(3,50) with {
      briefly "Status"
      described as {
        |Filing status.
      }
    }
    lastUpdated: TimeStamp with {
      briefly "Updated"
      described as {
        |Last update time.
      }
    }
  } with {
    briefly "Filing status"
    described as {
      |Regulatory filing status.
    }
  }
} with {
  option external()
  briefly "External regulatory filing system"
  described as {
    |System for submitting regulatory filings to authorities.
  }
}
