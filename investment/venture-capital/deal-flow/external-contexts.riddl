// Deal Flow - External Contexts

// Company Research Service
context CompanyResearchService is {

  query GetCompanyInfo is {
    companyName is String(1, 200) with { briefly "Name" described by "Company name." }
    website is optional URL with { briefly "Website" described by "Company website." }
  } with {
    briefly "Get company info"
    described by "Retrieves company information."
  }

  result CompanyResearch is {
    company is CompanyInfo with { briefly "Company" described by "Company info." }
    fundingHistory is many optional String(1, 500) with { briefly "Funding" described by "Funding history." }
    competitors is many optional String(1, 200) with { briefly "Competitors" described by "Known competitors." }
    newsArticles is many optional URL with { briefly "News" described by "Recent news." }
  } with {
    briefly "Company research"
    described by "Research results."
  }

  query GetFounderBackground is {
    founderName is String(1, 200) with { briefly "Name" described by "Founder name." }
    linkedInUrl is optional URL with { briefly "LinkedIn" described by "LinkedIn URL." }
  } with {
    briefly "Get founder background"
    described by "Retrieves founder background."
  }

  result FounderBackground is {
    founder is FounderInfo with { briefly "Founder" described by "Founder info." }
    previousCompanies is many optional String(1, 200) with { briefly "Previous" described by "Previous companies." }
    education is many optional String(1, 200) with { briefly "Education" described by "Education history." }
  } with {
    briefly "Founder background"
    described by "Background research."
  }

} with {
  option is external
  briefly "External company research"
  described by "External research service."
}

// Market Data Service
context MarketDataService is {

  query GetSectorData is {
    sector is Sector with { briefly "Sector" described by "Industry sector." }
  } with {
    briefly "Get sector data"
    described by "Retrieves sector data."
  }

  result SectorAnalysis is {
    marketSize is Decimal(14, 2) with { briefly "Size" described by "Market size." }
    growthRate is Decimal(5, 2) with { briefly "Growth" described by "Growth rate." }
    keyPlayers is many String(1, 200) with { briefly "Players" described by "Key players." }
    recentDeals is many optional String(1, 500) with { briefly "Deals" described by "Recent deals." }
    trends is many optional String(1, 500) with { briefly "Trends" described by "Market trends." }
  } with {
    briefly "Sector analysis"
    described by "Sector data."
  }

  query GetComparableDeals is {
    sector is Sector with { briefly "Sector" described by "Industry sector." }
    investmentType is InvestmentType with { briefly "Type" described by "Investment type." }
  } with {
    briefly "Get comparable deals"
    described by "Retrieves comparable transactions."
  }

  result ComparableDeals is {
    deals is many String(1, 1000) with { briefly "Deals" described by "Comparable deals." }
    averageValuation is optional Decimal(12, 2) with { briefly "Avg valuation" described by "Average valuation." }
    averageRaise is optional Decimal(12, 2) with { briefly "Avg raise" described by "Average raise." }
  } with {
    briefly "Comparable deals"
    described by "Comparable transactions."
  }

} with {
  option is external
  briefly "External market data"
  described by "External market research service."
}

// CRM Integration Service
context CrmIntegrationService is {

  command SyncContact is {
    contact is FounderInfo with { briefly "Contact" described by "Contact info." }
    companyId is CompanyId with { briefly "Company" described by "Company ID." }
  } with {
    briefly "Sync contact"
    described by "Syncs contact to CRM."
  }

  event ContactSynced is {
    contactId is ContactId with { briefly "Contact" described by "Contact ID." }
    syncedAt is TimeStamp with { briefly "Synced" described by "Sync time." }
  } with {
    briefly "Contact synced"
    described by "Emitted when contact is synced."
  }

  command LogInteraction is {
    contactId is ContactId with { briefly "Contact" described by "Contact ID." }
    interactionType is String(1, 50) with { briefly "Type" described by "Interaction type." }
    notes is String(1, 2000) with { briefly "Notes" described by "Interaction notes." }
  } with {
    briefly "Log interaction"
    described by "Logs interaction in CRM."
  }

  event InteractionLogged is {
    contactId is ContactId with { briefly "Contact" described by "Contact ID." }
    loggedAt is TimeStamp with { briefly "Logged" described by "Log time." }
  } with {
    briefly "Interaction logged"
    described by "Emitted when interaction is logged."
  }

} with {
  option is external
  briefly "External CRM integration"
  described by "External CRM service."
}

// Document Management Service
context DocumentManagementService is {

  command UploadDocument is {
    dealId is DealId with { briefly "Deal" described by "Deal ID." }
    documentName is String(1, 200) with { briefly "Name" described by "Document name." }
    documentType is String(1, 50) with { briefly "Type" described by "Document type." }
    content is String(1, 100000) with { briefly "Content" described by "Document content." }
  } with {
    briefly "Upload document"
    described by "Uploads deal document."
  }

  event DocumentUploaded is {
    dealId is DealId with { briefly "Deal" described by "Deal ID." }
    documentId is UUID with { briefly "Document" described by "Document ID." }
    documentUrl is URL with { briefly "URL" described by "Document URL." }
    uploadedAt is TimeStamp with { briefly "Uploaded" described by "Upload time." }
  } with {
    briefly "Document uploaded"
    described by "Emitted when document is uploaded."
  }

  query GetDealDocuments is {
    dealId is DealId with { briefly "Deal" described by "Deal ID." }
  } with {
    briefly "Get deal documents"
    described by "Retrieves deal documents."
  }

  result DealDocuments is {
    documents is many URL with { briefly "Documents" described by "Document URLs." }
  } with {
    briefly "Deal documents"
    described by "List of documents."
  }

} with {
  option is external
  briefly "External document management"
  described by "External document storage service."
}

// Calendar Service
context CalendarService is {

  command ScheduleMeeting is {
    dealId is DealId with { briefly "Deal" described by "Deal ID." }
    meetingType is String(1, 50) with { briefly "Type" described by "Meeting type." }
    attendees is many String(5, 254) with { briefly "Attendees" described by "Attendee emails." }
    proposedTimes is many TimeStamp with { briefly "Times" described by "Proposed times." }
  } with {
    briefly "Schedule meeting"
    described by "Schedules meeting."
  }

  event MeetingScheduled is {
    dealId is DealId with { briefly "Deal" described by "Deal ID." }
    meetingTime is TimeStamp with { briefly "Time" described by "Meeting time." }
    meetingLink is optional URL with { briefly "Link" described by "Meeting link." }
    scheduledAt is TimeStamp with { briefly "Scheduled" described by "Scheduling time." }
  } with {
    briefly "Meeting scheduled"
    described by "Emitted when meeting is scheduled."
  }

  command SendMeetingReminder is {
    dealId is DealId with { briefly "Deal" described by "Deal ID." }
    attendees is many String(5, 254) with { briefly "Attendees" described by "Attendee emails." }
    meetingTime is TimeStamp with { briefly "Time" described by "Meeting time." }
  } with {
    briefly "Send reminder"
    described by "Sends meeting reminder."
  }

  event ReminderSent is {
    dealId is DealId with { briefly "Deal" described by "Deal ID." }
    sentAt is TimeStamp with { briefly "Sent" described by "Send time." }
  } with {
    briefly "Reminder sent"
    described by "Emitted when reminder is sent."
  }

} with {
  option is external
  briefly "External calendar"
  described by "External calendar service."
}

// Notification Service
context NotificationService is {

  command NotifyTeam is {
    dealId is DealId with { briefly "Deal" described by "Deal ID." }
    message is String(1, 1000) with { briefly "Message" described by "Notification message." }
    recipients is many String(5, 254) with { briefly "Recipients" described by "Recipient emails." }
  } with {
    briefly "Notify team"
    described by "Sends team notification."
  }

  event TeamNotified is {
    dealId is DealId with { briefly "Deal" described by "Deal ID." }
    notifiedAt is TimeStamp with { briefly "Notified" described by "Notification time." }
  } with {
    briefly "Team notified"
    described by "Emitted when team is notified."
  }

  command SendStageUpdate is {
    dealId is DealId with { briefly "Deal" described by "Deal ID." }
    previousStage is DealStage with { briefly "Previous" described by "Previous stage." }
    newStage is DealStage with { briefly "New" described by "New stage." }
    recipients is many String(5, 254) with { briefly "Recipients" described by "Recipient emails." }
  } with {
    briefly "Send stage update"
    described by "Sends stage change notification."
  }

  event StageUpdateSent is {
    dealId is DealId with { briefly "Deal" described by "Deal ID." }
    sentAt is TimeStamp with { briefly "Sent" described by "Send time." }
  } with {
    briefly "Stage update sent"
    described by "Emitted when update is sent."
  }

} with {
  option is external
  briefly "External notifications"
  described by "External notification service."
}

// Legal Document Service
context LegalDocumentService is {

  command GenerateTermSheet is {
    dealId is DealId with { briefly "Deal" described by "Deal ID." }
    company is CompanyInfo with { briefly "Company" described by "Company info." }
    terms is InvestmentTerms with { briefly "Terms" described by "Investment terms." }
  } with {
    briefly "Generate term sheet"
    described by "Generates term sheet document."
  }

  event TermSheetGenerated is {
    dealId is DealId with { briefly "Deal" described by "Deal ID." }
    documentUrl is URL with { briefly "URL" described by "Document URL." }
    generatedAt is TimeStamp with { briefly "Generated" described by "Generation time." }
  } with {
    briefly "Term sheet generated"
    described by "Emitted when term sheet is generated."
  }

  command RequestSignature is {
    dealId is DealId with { briefly "Deal" described by "Deal ID." }
    documentUrl is URL with { briefly "Document" described by "Document URL." }
    signers is many String(5, 254) with { briefly "Signers" described by "Signer emails." }
  } with {
    briefly "Request signature"
    described by "Requests document signature."
  }

  event SignatureRequested is {
    dealId is DealId with { briefly "Deal" described by "Deal ID." }
    requestedAt is TimeStamp with { briefly "Requested" described by "Request time." }
  } with {
    briefly "Signature requested"
    described by "Emitted when signature is requested."
  }

  event DocumentSigned is {
    dealId is DealId with { briefly "Deal" described by "Deal ID." }
    signedDocumentUrl is URL with { briefly "URL" described by "Signed document URL." }
    signedAt is TimeStamp with { briefly "Signed" described by "Signature time." }
  } with {
    briefly "Document signed"
    described by "Emitted when document is signed."
  }

} with {
  option is external
  briefly "External legal documents"
  described by "External legal document service."
}
