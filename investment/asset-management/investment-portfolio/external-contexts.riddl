// Investment Portfolio - External Contexts

context MarketDataFeed is {

  query GetSecurityPrice is {
    securityId is SecurityId with { briefly "Security" described by "Security ID." }
  } with {
    briefly "Get security price"
    described by "Retrieves current market price."
  }

  result SecurityPrice is {
    securityId is SecurityId with { briefly "Security" described by "Security ID." }
    bidPrice is Decimal(15, 4) with { briefly "Bid" described by "Bid price." }
    askPrice is Decimal(15, 4) with { briefly "Ask" described by "Ask price." }
    lastPrice is Decimal(15, 4) with { briefly "Last" described by "Last traded price." }
    asOfTime is TimeStamp with { briefly "As-of" described by "Price timestamp." }
  } with {
    briefly "Security price"
    described by "Current market price data."
  }

  query GetBenchmarkReturn is {
    benchmarkId is BenchmarkId with { briefly "Benchmark" described by "Benchmark ID." }
    startDate is Date with { briefly "Start" described by "Period start date." }
    endDate is Date with { briefly "End" described by "Period end date." }
  } with {
    briefly "Get benchmark return"
    described by "Retrieves benchmark return for a period."
  }

  result BenchmarkReturn is {
    benchmarkId is BenchmarkId with { briefly "Benchmark" described by "Benchmark ID." }
    totalReturn is Decimal(8, 4) with { briefly "Return" described by "Total return percentage." }
    periodStart is Date with { briefly "Start" described by "Period start." }
    periodEnd is Date with { briefly "End" described by "Period end." }
  } with {
    briefly "Benchmark return"
    described by "Benchmark return for a period."
  }

  event PriceUpdated is {
    securityId is SecurityId with { briefly "Security" described by "Security ID." }
    newPrice is Decimal(15, 4) with { briefly "Price" described by "Updated price." }
    updatedAt is TimeStamp with { briefly "Updated" described by "Update time." }
  } with {
    briefly "Price updated"
    described by "Emitted when a security price changes."
  }

} with {
  option is external
  briefly "External market data feed"
  described by "Real-time and historical market data provider."
}

context TradingSystem is {

  command SubmitOrder is {
    tradeId is TradeId with { briefly "Trade" described by "Trade ID." }
    securityId is SecurityId with { briefly "Security" described by "Security ID." }
    action is TradeAction with { briefly "Action" described by "Trade action." }
    quantity is Decimal(15, 4) with { briefly "Quantity" described by "Order quantity." }
    limitPrice is optional Decimal(15, 4) with { briefly "Limit" described by "Limit price." }
  } with {
    briefly "Submit order"
    described by "Submits trade order for execution."
  }

  command CancelTradeOrder is {
    tradeId is TradeId with { briefly "Trade" described by "Trade ID." }
    reason is String(3, 500) with { briefly "Reason" described by "Cancellation reason." }
  } with {
    briefly "Cancel trade order"
    described by "Cancels a pending trade order."
  }

  event OrderSubmitted is {
    tradeId is TradeId with { briefly "Trade" described by "Trade ID." }
    submittedAt is TimeStamp with { briefly "Submitted" described by "Submission time." }
  } with {
    briefly "Order submitted"
    described by "Emitted when order is submitted to market."
  }

  event OrderFilled is {
    tradeId is TradeId with { briefly "Trade" described by "Trade ID." }
    filledQuantity is Decimal(15, 4) with { briefly "Quantity" described by "Filled quantity." }
    filledPrice is Decimal(15, 4) with { briefly "Price" described by "Fill price." }
    filledAt is TimeStamp with { briefly "Filled" described by "Fill time." }
  } with {
    briefly "Order filled"
    described by "Emitted when trade order is filled."
  }

  event OrderRejected is {
    tradeId is TradeId with { briefly "Trade" described by "Trade ID." }
    reason is String(3, 500) with { briefly "Reason" described by "Rejection reason." }
    rejectedAt is TimeStamp with { briefly "Rejected" described by "Rejection time." }
  } with {
    briefly "Order rejected"
    described by "Emitted when trade order is rejected."
  }

} with {
  option is external
  briefly "External trading system"
  described by "Order management and execution system."
}
