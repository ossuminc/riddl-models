// CI/CD Pipeline - Shared Types

type PipelineId is Id(PipelineContext.Pipeline) with {
  briefly "Pipeline identifier"
  described by "Unique identifier for a pipeline."
}

type BuildId is UUID with {
  briefly "Build identifier"
  described by "Reference to a build execution."
}

type StageId is UUID with {
  briefly "Stage identifier"
  described by "Reference to a pipeline stage."
}

type JobId is UUID with {
  briefly "Job identifier"
  described by "Reference to a job within a stage."
}

type ArtifactId is UUID with {
  briefly "Artifact identifier"
  described by "Reference to a build artifact."
}

type EnvironmentId is UUID with {
  briefly "Environment identifier"
  described by "Reference to deployment environment."
}

type PipelineStatus is any of {
  Pending,
  Running,
  Paused,
  Success,
  Failed,
  Cancelled
} with {
  briefly "Pipeline status"
  described by "Current pipeline execution status."
}

type StageStatus is any of {
  Pending,
  Running,
  Success,
  Failed,
  Skipped
} with {
  briefly "Stage status"
  described by "Current stage execution status."
}

type JobType is any of {
  Build,
  Test,
  Lint,
  Security,
  Package,
  Deploy,
  Notify
} with {
  briefly "Job type"
  described by "Type of pipeline job."
}

type TriggerType is any of {
  Push,
  PullRequest,
  Tag,
  Schedule,
  Manual,
  API
} with {
  briefly "Trigger type"
  described by "What initiated the pipeline."
}

type EnvironmentType is any of {
  Development,
  Staging,
  Production,
  QA,
  Preview
} with {
  briefly "Environment type"
  described by "Type of deployment environment."
}

type CommitInfo is {
  commitHash is String(40, 40) with {
    briefly "Hash"
    described by "Git commit hash."
  }
  branch is String(1, 200) with {
    briefly "Branch"
    described by "Git branch name."
  }
  author is String(1, 200) with {
    briefly "Author"
    described by "Commit author."
  }
  message is String(1, 1000) with {
    briefly "Message"
    described by "Commit message."
  }
  timestamp is TimeStamp with {
    briefly "Timestamp"
    described by "Commit timestamp."
  }
} with {
  briefly "Commit info"
  described by "Git commit details."
}

type PipelineConfig is {
  name is String(1, 100) with {
    briefly "Name"
    described by "Pipeline name."
  }
  repository is String(1, 500) with {
    briefly "Repository"
    described by "Source repository URL."
  }
  triggers is many TriggerType with {
    briefly "Triggers"
    described by "Pipeline triggers."
  }
  stages is many StageConfig with {
    briefly "Stages"
    described by "Pipeline stages."
  }
  timeout is Natural with {
    briefly "Timeout"
    described by "Pipeline timeout in minutes."
  }
} with {
  briefly "Pipeline config"
  described by "Pipeline configuration."
}

type StageConfig is {
  stageId is StageId with {
    briefly "Stage"
    described by "Stage identifier."
  }
  name is String(1, 100) with {
    briefly "Name"
    described by "Stage name."
  }
  jobs is many JobConfig with {
    briefly "Jobs"
    described by "Jobs in this stage."
  }
  dependsOn is many optional StageId with {
    briefly "Dependencies"
    described by "Stages this depends on."
  }
  condition is optional String(1, 500) with {
    briefly "Condition"
    described by "Execution condition."
  }
} with {
  briefly "Stage config"
  described by "Pipeline stage configuration."
}

type JobConfig is {
  jobId is JobId with {
    briefly "Job"
    described by "Job identifier."
  }
  name is String(1, 100) with {
    briefly "Name"
    described by "Job name."
  }
  jobType is JobType with {
    briefly "Type"
    described by "Job type."
  }
  image is String(1, 200) with {
    briefly "Image"
    described by "Container image."
  }
  commands is many String(1, 1000) with {
    briefly "Commands"
    described by "Commands to execute."
  }
  environment is many optional String(1, 500) with {
    briefly "Environment"
    described by "Environment variables."
  }
} with {
  briefly "Job config"
  described by "Pipeline job configuration."
}

type StageResult is {
  stageId is StageId with {
    briefly "Stage"
    described by "Stage identifier."
  }
  name is String(1, 100) with {
    briefly "Name"
    described by "Stage name."
  }
  stageStatus is StageStatus with {
    briefly "Status"
    described by "Stage status."
  }
  startedAt is TimeStamp with {
    briefly "Started"
    described by "Start time."
  }
  stageCompletedAt is optional TimeStamp with {
    briefly "Completed"
    described by "Completion time."
  }
  duration is optional Natural with {
    briefly "Duration"
    described by "Duration in seconds."
  }
} with {
  briefly "Stage result"
  described by "Pipeline stage execution result."
}

type BuildArtifact is {
  artifactId is ArtifactId with {
    briefly "Artifact"
    described by "Artifact identifier."
  }
  name is String(1, 200) with {
    briefly "Name"
    described by "Artifact name."
  }
  path is String(1, 500) with {
    briefly "Path"
    described by "Artifact path."
  }
  size is Natural with {
    briefly "Size"
    described by "Artifact size in bytes."
  }
  checksum is String(64, 64) with {
    briefly "Checksum"
    described by "SHA-256 checksum."
  }
  createdAt is TimeStamp with {
    briefly "Created"
    described by "Creation time."
  }
} with {
  briefly "Build artifact"
  described by "Build output artifact."
}

type DeploymentTarget is {
  environmentId is EnvironmentId with {
    briefly "Environment"
    described by "Environment identifier."
  }
  name is String(1, 100) with {
    briefly "Name"
    described by "Environment name."
  }
  environmentType is EnvironmentType with {
    briefly "Type"
    described by "Environment type."
  }
  endpoint is URL with {
    briefly "Endpoint"
    described by "Deployment endpoint."
  }
  requiresApproval is Boolean with {
    briefly "Requires approval"
    described by "Whether approval is needed."
  }
} with {
  briefly "Deployment target"
  described by "Deployment environment details."
}

type ApprovalInfo is {
  approvedBy is String(1, 200) with {
    briefly "Approved by"
    described by "Approver identity."
  }
  approvedAt is TimeStamp with {
    briefly "Approved"
    described by "Approval time."
  }
  comment is optional String(1, 500) with {
    briefly "Comment"
    described by "Approval comment."
  }
} with {
  briefly "Approval info"
  described by "Deployment approval details."
}
