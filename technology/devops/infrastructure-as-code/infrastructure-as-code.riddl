// Infrastructure as Code Domain Model
// IaC state management and provisioning

domain InfrastructureAsCode is {

  author OssumInc is {
    name is "Ossum Inc."
    email is "support@ossum.ai"
  } with {
    briefly "Domain author"
    described by "Organization maintaining this domain model."
  }

  user PlatformEngineer is "person managing infrastructure code" with {
    briefly "Platform Engineer"
    described by "Person writing and maintaining IaC."
  }

  user CloudArchitect is "person designing infrastructure" with {
    briefly "Cloud Architect"
    described by "Person designing cloud architecture."
  }

  user Operator is "person executing infrastructure changes" with {
    briefly "Operator"
    described by "Person applying infrastructure changes."
  }

  epic InfrastructureEpic is {
    user PlatformEngineer wants "to manage infrastructure as code"
      so that "infrastructure is repeatable and version controlled"

    case ApplyInfrastructure is {
      user PlatformEngineer wants "to apply infrastructure changes"
        so that "cloud resources match the desired state"
      step is "Engineer reviews" "infrastructure plan" "for changes"
        with { briefly "Review plan" described by "Review proposed changes." }
      step is "System validates" "state consistency" "and dependencies"
        with { briefly "Validate state" described by "Check state consistency." }
      step send command StackContext.Stack.ApplyStack from user PlatformEngineer to entity StackContext.Stack
        with { briefly "Apply stack" described by "Apply infrastructure changes." }
      step is "System reports" "deployment status" "to engineer"
        with { briefly "Report status" described by "Show deployment result." }
    } with {
      briefly "Infrastructure application"
      described by "Applying IaC changes to cloud."
    }
  } with {
    briefly "Infrastructure management"
    described by {
      | Epic covering infrastructure provisioning,
      | state management, and drift detection.
    }
  }

  include "StackContext.riddl"
  include "external-contexts.riddl"

} with {
  briefly "Infrastructure as Code domain"
  described by {
    | The InfrastructureAsCode domain handles IaC
    | state management, provisioning, and drift detection.
  }
}
