// Infrastructure as Code - Shared Types
type StackId is Id(StackContext.Stack)  with {
  briefly "Stack identifier"
  described as {
    |Unique identifier for an infrastructure stack.
  }
}
type ResourceId is UUID with {
  briefly "Resource identifier"
  described as {
    |Reference to a cloud resource.
  }
}
type ModuleId is UUID with {
  briefly "Module identifier"
  described as {
    |Reference to an IaC module.
  }
}
type WorkspaceId is UUID with {
  briefly "Workspace identifier"
  described as {
    |Reference to a workspace.
  }
}
type RunId is UUID with {
  briefly "Run identifier"
  described as {
    |Reference to an execution run.
  }
}
type StackStatus is any of {
  Pending,
  Planning,
  Applying,
  Stable,
  Drifted,
  Failed,
  Destroying
} with {
  briefly "Stack status"
  described as {
    |Current stack status.
  }
}
type ResourceStatus is any of {
  Pending,
  Created,
  Updated,
  Unchanged,
  Destroyed,
  Drifted,
  Failed
} with {
  briefly "Resource status"
  described as {
    |Current resource status.
  }
}
type ChangeAction is any of {
  Create,
  Update,
  Replace,
  Destroy,
  NoOp
} with {
  briefly "Change action"
  described as {
    |Type of change to apply.
  }
}
type ProviderType is any of {
  AWS,
  Azure,
  GCP,
  Kubernetes,
  Custom
} with {
  briefly "Provider type"
  described as {
    |Cloud provider type.
  }
}
type WorkspaceInfo is {
  workspaceId: WorkspaceId with {
    briefly "Workspace"
    described as {
      |Workspace identifier.
    }
  }
  name: String(1,100) with {
    briefly "Name"
    described as {
      |Workspace name.
    }
  }
  environment: String(1,50) with {
    briefly "Environment"
    described as {
      |Target environment.
    }
  }
  region: String(1,50) with {
    briefly "Region"
    described as {
      |Cloud region.
    }
  }
} with {
  briefly "Workspace info"
  described as {
    |Workspace configuration.
  }
}
type StackConfiguration is {
  name: String(1,100) with {
    briefly "Name"
    described as {
      |Stack name.
    }
  }
  provider: ProviderType with {
    briefly "Provider"
    described as {
      |Cloud provider.
    }
  }
  sourceUrl: URL with {
    briefly "Source"
    described as {
      |IaC source repository.
    }
  }
  version: String(1,50) with {
    briefly "Version"
    described as {
      |IaC version.
    }
  }
  variables: String(1,1000)* with {
    briefly "Variables"
    described as {
      |Input variables.
    }
  }
  backend: String(1,500) with {
    briefly "Backend"
    described as {
      |State backend configuration.
    }
  }
} with {
  briefly "Stack configuration"
  described as {
    |Infrastructure stack configuration.
  }
}
type ResourceSpec is {
  resourceId: ResourceId with {
    briefly "Resource"
    described as {
      |Resource identifier.
    }
  }
  resourceType: String(1,100) with {
    briefly "Type"
    described as {
      |Resource type.
    }
  }
  name: String(1,200) with {
    briefly "Name"
    described as {
      |Resource name.
    }
  }
  provider: ProviderType with {
    briefly "Provider"
    described as {
      |Cloud provider.
    }
  }
  properties: String(1,2000)+ with {
    briefly "Properties"
    described as {
      |Resource properties.
    }
  }
  dependsOn: ResourceId* with {
    briefly "Dependencies"
    described as {
      |Resource dependencies.
    }
  }
} with {
  briefly "Resource spec"
  described as {
    |Resource specification.
  }
}
type ResourceState is {
  resourceId: ResourceId with {
    briefly "Resource"
    described as {
      |Resource identifier.
    }
  }
  resourceType: String(1,100) with {
    briefly "Type"
    described as {
      |Resource type.
    }
  }
  name: String(1,200) with {
    briefly "Name"
    described as {
      |Resource name.
    }
  }
  resourceStatus: ResourceStatus with {
    briefly "Status"
    described as {
      |Resource status.
    }
  }
  physicalId: String(1,500)? with {
    briefly "Physical ID"
    described as {
      |Cloud resource ID.
    }
  }
  properties: String(1,2000)+ with {
    briefly "Properties"
    described as {
      |Current properties.
    }
  }
  lastUpdated: TimeStamp with {
    briefly "Updated"
    described as {
      |Last update time.
    }
  }
} with {
  briefly "Resource state"
  described as {
    |Current resource state.
  }
}
type PlannedChange is {
  resourceId: ResourceId with {
    briefly "Resource"
    described as {
      |Resource identifier.
    }
  }
  resourceType: String(1,100) with {
    briefly "Type"
    described as {
      |Resource type.
    }
  }
  name: String(1,200) with {
    briefly "Name"
    described as {
      |Resource name.
    }
  }
  action: ChangeAction with {
    briefly "Action"
    described as {
      |Planned action.
    }
  }
  beforeProperties: String(1,2000)* with {
    briefly "Before"
    described as {
      |Properties before change.
    }
  }
  afterProperties: String(1,2000)* with {
    briefly "After"
    described as {
      |Properties after change.
    }
  }
} with {
  briefly "Planned change"
  described as {
    |Planned infrastructure change.
  }
}
type ExecutionPlan is {
  runId: RunId with {
    briefly "Run"
    described as {
      |Run identifier.
    }
  }
  changes: PlannedChange+ with {
    briefly "Changes"
    described as {
      |Planned changes.
    }
  }
  createCount: Natural with {
    briefly "Creates"
    described as {
      |Resources to create.
    }
  }
  updateCount: Natural with {
    briefly "Updates"
    described as {
      |Resources to update.
    }
  }
  destroyCount: Natural with {
    briefly "Destroys"
    described as {
      |Resources to destroy.
    }
  }
  plannedAt: TimeStamp with {
    briefly "Planned"
    described as {
      |Plan generation time.
    }
  }
} with {
  briefly "Execution plan"
  described as {
    |Infrastructure change plan.
  }
}
type DriftReport is {
  detectedAt: TimeStamp with {
    briefly "Detected"
    described as {
      |Detection time.
    }
  }
  driftedResources: ResourceState+ with {
    briefly "Drifted"
    described as {
      |Resources with drift.
    }
  }
  driftCount: Natural with {
    briefly "Count"
    described as {
      |Number of drifted resources.
    }
  }
} with {
  briefly "Drift report"
  described as {
    |Infrastructure drift detection report.
  }
}
type ApplyResult is {
  runId: RunId with {
    briefly "Run"
    described as {
      |Run identifier.
    }
  }
  status: StackStatus with {
    briefly "Status"
    described as {
      |Final status.
    }
  }
  resourcesCreated: Natural with {
    briefly "Created"
    described as {
      |Resources created.
    }
  }
  resourcesUpdated: Natural with {
    briefly "Updated"
    described as {
      |Resources updated.
    }
  }
  resourcesDestroyed: Natural with {
    briefly "Destroyed"
    described as {
      |Resources destroyed.
    }
  }
  errorMessage: String(1,2000)? with {
    briefly "Error"
    described as {
      |Error message if failed.
    }
  }
  completedAt: TimeStamp with {
    briefly "Completed"
    described as {
      |Completion time.
    }
  }
} with {
  briefly "Apply result"
  described as {
    |Infrastructure apply result.
  }
}
