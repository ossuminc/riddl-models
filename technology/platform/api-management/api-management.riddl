// API Management Domain Model
// Manages the complete lifecycle of APIs from creation through retirement
domain APIManagement is {
  author OssumInc is {
    name = "Ossum Inc."
    email = "support@ossuminc.com"
  } with {
    briefly "Model author"
    described as {
      |Ossum Inc. provides RIDDL models and tooling for
      |      reactive system design.
    }
  }
  // Users
  user APIProductManager is "product-manager" with {
    briefly "API Product Manager"
    described as {
      |Responsible for API strategy, lifecycle decisions, and
      |      ensuring APIs meet business objectives. Manages deprecation schedules
      |      and coordinates with stakeholders on API changes.
    }
  }
  user APIDeveloper is "developer" with {
    briefly "API Developer"
    described as {
      |Creates and maintains API implementations, publishes new
      |      versions, and ensures API quality through testing and documentation.
    }
  }
  user APIConsumer is "consumer" with {
    briefly "API Consumer"
    described as {
      |External or internal developer who subscribes to and
      |      consumes APIs. Relies on stable APIs and clear documentation.
    }
  }
  // Epic for API Lifecycle
  epic APILifecycleManagement is {
    user APIProductManager wants to "to manage APIs through their complete lifecycle" so that "APIs are properly governed, versioned, and retired in a controlled manner"
    case CreateNewAPI is {
      user APIProductManager wants to "to create a new API product" so that "developers can begin building and testing the API"
      ???
    } with {
      briefly "Create new API product"
      described as {
        |Product manager creates a new API definition in draft status.
      }
    }
    case PublishAPIVersion is {
      user APIDeveloper wants to "to publish a new version of an API" so that "consumers can access the latest functionality"
      ???
    } with {
      briefly "Publish API version"
      described as {
        |Developer publishes a new version making it available for consumption.
      }
    }
    case SubscribeToAPI is {
      user APIConsumer wants to "to subscribe to an API" so that "I can integrate it into my application"
      ???
    } with {
      briefly "Subscribe to API"
      described as {
        |Consumer subscribes to an API and receives credentials.
      }
    }
    case DeprecateAndRetire is {
      user APIProductManager wants to "to deprecate and eventually retire an API version" so that "consumers are properly notified and migrated"
      ???
    } with {
      briefly "Deprecate and retire API"
      described as {
        |Product manager deprecates a version with migration timeline.
      }
    }
    case MonitorAPIUsage is {
      user APIProductManager wants to "to monitor API usage and performance" so that "I can make informed decisions about API evolution"
      ???
    } with {
      briefly "Monitor API usage"
      described as {
        |Product manager reviews usage metrics and analytics.
      }
    }
  } with {
    briefly "API Lifecycle Management Epic"
    described as {
      | This epic covers the complete API lifecycle from creation to retirement:
      |
      | 1. **Creation** - API product managers define new APIs with OpenAPI specs
      | 2. **Development** - Developers iterate on draft APIs
      | 3. **Publishing** - New versions are published and routed through gateway
      | 4. **Subscription** - Consumers subscribe and receive API keys
      | 5. **Monitoring** - Usage and performance are tracked
      | 6. **Deprecation** - Old versions are deprecated with migration notices
      | 7. **Retirement** - Deprecated versions are eventually retired
      |
      | Each stage involves coordination between the API Context, Gateway Service,
      | Developer Portal, and Analytics Service.
    }
  }
  include "external-contexts.riddl"
  include "APIContext.riddl"
} with {
  briefly "API Management Domain"
  described as {
    | The API Management domain provides comprehensive capabilities for managing
    | the complete lifecycle of APIs within a technology platform. It enables:
    |
    | - **API Product Definition** - Create and manage API products with OpenAPI specs
    | - **Version Management** - Publish, deprecate, and retire API versions
    | - **Subscription Management** - Handle consumer subscriptions and API keys
    | - **Rate Limiting** - Configure and enforce usage policies
    | - **Usage Analytics** - Track and report on API consumption patterns
    |
    | The domain integrates with external systems including API gateways for
    | traffic management, developer portals for consumer experience, and
    | analytics services for usage insights.
  }
}
