// Type definitions for Identity Management domain
type EmailAddress is Pattern("^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$") with {
  briefly "Email address type"
  described as {
    |A valid email address pattern for identity management.
  }
}
type IdentityId is Id(IdentityContext.Identity)  with {
  briefly "Unique identifier for an identity"
  described as {
    |A system-generated unique identifier that references a specific
    |    user identity within the identity management system.
  }
}
type CredentialId is UUID with {
  briefly "Unique identifier for a credential"
  described as {
    |A system-generated unique identifier for an authentication
    |    credential associated with an identity.
  }
}
type SessionId is UUID with {
  briefly "Unique identifier for a session"
  described as {
    |A system-generated unique identifier for an active
    |    authentication session.
  }
}
type IdentityStatus is any of {
  Pending,
  Active,
  Suspended,
  Deactivated
} with {
  briefly "Current status of an identity"
  described as {
    | Represents the lifecycle status of a user identity:
    | - Pending: Identity created but not yet verified
    | - Active: Identity is verified and can authenticate
    | - Suspended: Identity temporarily disabled
    | - Deactivated: Identity permanently disabled
  }
}
type CredentialType is any of {
  Password,
  APIKey,
  Certificate,
  OAuth,
  Biometric
} with {
  briefly "Type of authentication credential"
  described as {
    |Enumerates the supported credential types for authentication.
  }
}
type UserIdentity is {
  identityId: IdentityId
  email: EmailAddress
  displayName: String
  status: IdentityStatus
  createdAt: DateTime
  lastModifiedAt: DateTime
} with {
  briefly "Core identity record for a user"
  described as {
    | Represents a user's identity within the system, containing core
    | identifying information and status. This is the aggregate root for
    | all identity-related operations.
  }
}
type Credential is {
  credentialId: CredentialId
  identityId: IdentityId
  credentialType: CredentialType
  hashedValue: String
  createdAt: DateTime
  updatedExpiresAt: DateTime?
  isActive: Boolean
} with {
  briefly "Authentication credential for an identity"
  described as {
    | Stores a hashed authentication credential associated with an identity.
    | Credentials have a type, optional expiration, and active status.
    | The actual credential value is never stored in plain text.
  }
}
type SessionInfo is {
  sessionId: SessionId
  identityId: IdentityId
  createdAt: DateTime
  expiresAt: DateTime
  ipAddress: String
  userAgent: String
  isActive: Boolean
} with {
  briefly "Active authentication session information"
  described as {
    | Tracks an active user session including creation time, expiration,
    | and client information for security auditing purposes.
  }
}
type AccessGrant is {
  identityId: IdentityId
  resource: String
  permission: String
  grantedAt: DateTime
  grantedBy: IdentityId
  updatedExpiresAt: DateTime?
} with {
  briefly "Permission grant for resource access"
  described as {
    | Records a specific permission granted to an identity for accessing
    | a protected resource. Grants can have optional expiration times.
  }
}
type AuthenticationResult is {
  success: Boolean
  updatedSessionId: SessionId?
  updatedFailureReason: String?
  attemptedAt: DateTime
} with {
  briefly "Result of an authentication attempt"
  described as {
    |Captures the outcome of an authentication attempt including
    |    session information on success or failure reason on failure.
  }
}
type VerificationMethod is any of {
  Email,
  Phone,
  Document
} with {
  briefly "Method used for identity verification"
  described as {
    |Enumerates the supported methods for verifying a user identity.
  }
}
