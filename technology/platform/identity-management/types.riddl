// Type definitions for Identity Management domain

type EmailAddress is Pattern("^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$") with {
  briefly "Email address type"
  described by "A valid email address pattern for identity management."
}

type IdentityId is Id(IdentityContext.Identity) with {
  briefly "Unique identifier for an identity"
  described by "A system-generated unique identifier that references a specific
    user identity within the identity management system."
}

type CredentialId is UUID with {
  briefly "Unique identifier for a credential"
  described by "A system-generated unique identifier for an authentication
    credential associated with an identity."
}

type SessionId is UUID with {
  briefly "Unique identifier for a session"
  described by "A system-generated unique identifier for an active
    authentication session."
}

type IdentityStatus is any of {
  Pending,
  Active,
  Suspended,
  Deactivated
} with {
  briefly "Current status of an identity"
  described by {
    | Represents the lifecycle status of a user identity:
    | - Pending: Identity created but not yet verified
    | - Active: Identity is verified and can authenticate
    | - Suspended: Identity temporarily disabled
    | - Deactivated: Identity permanently disabled
  }
}

type CredentialType is any of {
  Password,
  APIKey,
  Certificate,
  OAuth,
  Biometric
} with {
  briefly "Type of authentication credential"
  described by "Enumerates the supported credential types for authentication."
}

type UserIdentity is {
  identityId is IdentityId,
  email is EmailAddress,
  displayName is String,
  status is IdentityStatus,
  createdAt is DateTime,
  lastModifiedAt is DateTime
} with {
  briefly "Core identity record for a user"
  described by {
    | Represents a user's identity within the system, containing core
    | identifying information and status. This is the aggregate root for
    | all identity-related operations.
  }
}

type Credential is {
  credentialId is CredentialId,
  identityId is IdentityId,
  credentialType is CredentialType,
  hashedValue is String,
  createdAt is DateTime,
  expiresAt is DateTime?,
  isActive is Boolean
} with {
  briefly "Authentication credential for an identity"
  described by {
    | Stores a hashed authentication credential associated with an identity.
    | Credentials have a type, optional expiration, and active status.
    | The actual credential value is never stored in plain text.
  }
}

type SessionInfo is {
  sessionId is SessionId,
  identityId is IdentityId,
  createdAt is DateTime,
  expiresAt is DateTime,
  ipAddress is String,
  userAgent is String,
  isActive is Boolean
} with {
  briefly "Active authentication session information"
  described by {
    | Tracks an active user session including creation time, expiration,
    | and client information for security auditing purposes.
  }
}

type AccessGrant is {
  identityId is IdentityId,
  resource is String,
  permission is String,
  grantedAt is DateTime,
  grantedBy is IdentityId,
  expiresAt is DateTime?
} with {
  briefly "Permission grant for resource access"
  described by {
    | Records a specific permission granted to an identity for accessing
    | a protected resource. Grants can have optional expiration times.
  }
}

type AuthenticationResult is {
  success is Boolean,
  sessionId is SessionId?,
  failureReason is String?,
  attemptedAt is DateTime
} with {
  briefly "Result of an authentication attempt"
  described by "Captures the outcome of an authentication attempt including
    session information on success or failure reason on failure."
}

type VerificationMethod is any of {
  Email,
  Phone,
  Document
} with {
  briefly "Method used for identity verification"
  described by "Enumerates the supported methods for verifying a user identity."
}
