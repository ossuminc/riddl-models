// External system contexts for Identity Management
context DirectoryService is {
  type DirectoryUser is {
    externalId: String
    email: EmailAddress
    displayName: String
    groups: String+
  } with {
    briefly "User record from external directory"
    described as {
      |Represents a user synchronized from an external directory
      |      service such as LDAP or Active Directory.
    }
  }
  type DirectoryGroup is {
    groupId: String
    name: String
    members: String+
  } with {
    briefly "Group record from external directory"
    described as {
      |Represents a group from an external directory service.
    }
  }
  event UserSynchronized is  {
    externalId: String
    email: EmailAddress
    displayName: String
    synchronizedAt: DateTime
  } with {
    briefly "User synchronized from directory"
    described as {
      |Indicates a user record has been synchronized from the
      |      external directory service.
    }
  }
  event UserRemoved is  {
    externalId: String
    removedAt: DateTime
  } with {
    briefly "User removed from directory"
    described as {
      |Indicates a user has been removed from the external
      |      directory and should be deactivated.
    }
  }
  event GroupMembershipChanged is  {
    externalId: String
    addedGroups: String+
    removedGroups: String+
    changedAt: DateTime
  } with {
    briefly "User group membership changed"
    described as {
      |Indicates a user's group membership has changed in the
      |      external directory.
    }
  }
} with {
  option external()
  briefly "External directory service integration"
  described as {
    | External bounded context representing integration with enterprise
    | directory services such as LDAP, Active Directory, or cloud identity
    | providers like Azure AD or Okta. Provides user synchronization and
    | group membership information.
  }
}
context MFAProvider is {
  type MFAMethod is any of {
    TOTP,
    SMS,
    Email,
    Push,
    Hardware
  } with {
    briefly "Multi-factor authentication method"
    described as {
      |Enumerates supported MFA methods.
    }
  }
  type MFAChallenge is {
    challengeId: String
    method: MFAMethod
    expiresAt: DateTime
  } with {
    briefly "MFA challenge details"
    described as {
      |Represents an active MFA challenge awaiting response.
    }
  }
  type MFAResponse is {
    challengeId: String
    code: String
    respondedAt: DateTime
  } with {
    briefly "MFA challenge response"
    described as {
      |Response to an MFA challenge with verification code.
    }
  }
  event MFAChallengeIssued is  {
    externalIdentityId: String
    challengeId: String
    method: MFAMethod
    issuedAt: DateTime
    expiresAt: DateTime
  } with {
    briefly "MFA challenge issued"
    described as {
      |Indicates an MFA challenge has been sent to the user.
    }
  }
  event MFAVerificationSucceeded is  {
    externalIdentityId: String
    challengeId: String
    method: MFAMethod
    verifiedAt: DateTime
  } with {
    briefly "MFA verification succeeded"
    described as {
      |Indicates the user successfully completed MFA verification.
    }
  }
  event MFAVerificationFailed is  {
    externalIdentityId: String
    challengeId: String
    method: MFAMethod
    failureReason: String
    attemptedAt: DateTime
  } with {
    briefly "MFA verification failed"
    described as {
      |Indicates the user failed MFA verification.
    }
  }
} with {
  option external()
  briefly "External MFA provider integration"
  described as {
    | External bounded context representing integration with multi-factor
    | authentication providers. Supports various MFA methods including TOTP
    | authenticator apps, SMS, email, push notifications, and hardware tokens.
  }
}
context AuditService is {
  type AuditSeverity is any of {
    Info,
    Warning,
    Critical
  } with {
    briefly "Audit event severity level"
    described as {
      |Indicates the severity of an audit event.
    }
  }
  type AuditEntry is {
    entryId: String
    timestamp: DateTime
    actorId: String
    action: String
    resource: String
    outcome: String
    severity: AuditSeverity
    ipAddress: String
  } with {
    briefly "Audit log entry"
    described as {
      |Complete audit record for a security-relevant action.
    }
  }
  event AuditEntryRecorded is  {
    entryId: String
    timestamp: DateTime
    actorId: String
    action: String
    resource: String
    severity: AuditSeverity
  } with {
    briefly "Audit entry was recorded"
    described as {
      |Indicates an audit entry has been successfully recorded.
    }
  }
  event SecurityAlertTriggered is  {
    alertId: String
    timestamp: DateTime
    actorId: String
    alertType: String
    description: String
    severity: AuditSeverity
  } with {
    briefly "Security alert triggered"
    described as {
      |Indicates a security alert has been triggered based on
      |      audit patterns or thresholds.
    }
  }
} with {
  option external()
  briefly "External audit service integration"
  described as {
    | External bounded context representing integration with security audit
    | and compliance logging systems. Records all security-relevant events
    | for compliance, forensics, and security monitoring. Supports alerting
    | on suspicious patterns.
  }
}
