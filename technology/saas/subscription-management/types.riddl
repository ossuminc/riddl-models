// Subscription Management - Shared Types

type SubscriptionId is Id(SubscriptionContext.Subscription) with {
  briefly "Subscription identifier"
  described by "Unique identifier for a subscription."
}

type CustomerId is UUID with {
  briefly "Customer identifier"
  described by "Reference to customer."
}

type PlanId is UUID with {
  briefly "Plan identifier"
  described by "Reference to subscription plan."
}

type InvoiceId is UUID with {
  briefly "Invoice identifier"
  described by "Reference to an invoice."
}

type SubscriptionStatus is any of {
  Trial,
  Active,
  PastDue,
  Suspended,
  Canceled,
  Expired
} with {
  briefly "Subscription status"
  described by "Current subscription status."
}

type BillingCycle is any of {
  Monthly,
  Quarterly,
  Annual,
  Custom
} with {
  briefly "Billing cycle"
  described by "Billing frequency."
}

type PaymentStatus is any of {
  Pending,
  Paid,
  Failed,
  Refunded
} with {
  briefly "Payment status"
  described by "Payment status."
}

type PlanInfo is {
  planId is PlanId with {
    briefly "Plan"
    described by "Plan identifier."
  }
  name is String(1, 100) with {
    briefly "Name"
    described by "Plan name."
  }
  tier is String(1, 50) with {
    briefly "Tier"
    described by "Plan tier."
  }
  basePrice is Decimal(10, 2) with {
    briefly "Price"
    described by "Base price."
  }
  billingCycle is BillingCycle with {
    briefly "Cycle"
    described by "Billing cycle."
  }
  features is many String(1, 100) with {
    briefly "Features"
    described by "Included features."
  }
} with {
  briefly "Plan info"
  described by "Subscription plan details."
}

type CustomerInfo is {
  customerId is CustomerId with {
    briefly "Customer"
    described by "Customer identifier."
  }
  name is String(1, 200) with {
    briefly "Name"
    described by "Customer name."
  }
  email is String(5, 254) with {
    briefly "Email"
    described by "Contact email."
  }
  company is optional String(1, 200) with {
    briefly "Company"
    described by "Company name."
  }
} with {
  briefly "Customer info"
  described by "Customer information."
}

type PaymentMethod is {
  methodType is String(1, 20) with {
    briefly "Type"
    described by "Payment method type."
  }
  last4 is String(4, 4) with {
    briefly "Last 4"
    described by "Last four digits."
  }
  expiryMonth is optional Natural with {
    briefly "Month"
    described by "Expiry month."
  }
  expiryYear is optional Natural with {
    briefly "Year"
    described by "Expiry year."
  }
  isDefault is Boolean with {
    briefly "Default"
    described by "Is default method."
  }
} with {
  briefly "Payment method"
  described by "Customer payment method."
}

type BillingInfo is {
  nextBillingDate is Date with {
    briefly "Next billing"
    described by "Next billing date."
  }
  amount is Decimal(10, 2) with {
    briefly "Amount"
    described by "Billing amount."
  }
  currency is String(3, 3) with {
    briefly "Currency"
    described by "Currency code."
  }
} with {
  briefly "Billing info"
  described by "Billing information."
}

type InvoiceInfo is {
  invoiceId is InvoiceId with {
    briefly "Invoice"
    described by "Invoice identifier."
  }
  amount is Decimal(10, 2) with {
    briefly "Amount"
    described by "Invoice amount."
  }
  currency is String(3, 3) with {
    briefly "Currency"
    described by "Currency code."
  }
  periodStart is Date with {
    briefly "Start"
    described by "Period start."
  }
  periodEnd is Date with {
    briefly "End"
    described by "Period end."
  }
  status is PaymentStatus with {
    briefly "Status"
    described by "Invoice status."
  }
  issuedAt is TimeStamp with {
    briefly "Issued"
    described by "Issue time."
  }
  paidAt is optional TimeStamp with {
    briefly "Paid"
    described by "Payment time."
  }
} with {
  briefly "Invoice info"
  described by "Invoice details."
}

type UsageInfo is {
  metricName is String(1, 50) with {
    briefly "Metric"
    described by "Usage metric name."
  }
  quantity is Decimal(15, 4) with {
    briefly "Quantity"
    described by "Usage quantity."
  }
  unitPrice is Decimal(10, 4) with {
    briefly "Unit price"
    described by "Price per unit."
  }
  totalAmount is Decimal(12, 2) with {
    briefly "Total"
    described by "Total usage amount."
  }
} with {
  briefly "Usage info"
  described by "Usage-based billing info."
}

type DiscountInfo is {
  code is String(1, 50) with {
    briefly "Code"
    described by "Discount code."
  }
  percentOff is optional Decimal(5, 2) with {
    briefly "Percent"
    described by "Percentage discount."
  }
  amountOff is optional Decimal(10, 2) with {
    briefly "Amount"
    described by "Fixed discount."
  }
  validUntil is optional Date with {
    briefly "Valid until"
    described by "Expiration date."
  }
} with {
  briefly "Discount info"
  described by "Applied discount details."
}

type CancellationInfo is {
  reason is String(1, 500) with {
    briefly "Reason"
    described by "Cancellation reason."
  }
  feedback is optional String(1, 1000) with {
    briefly "Feedback"
    described by "Customer feedback."
  }
  effectiveDate is Date with {
    briefly "Effective"
    described by "Cancellation effective date."
  }
  canceledAt is TimeStamp with {
    briefly "Canceled"
    described by "Cancellation time."
  }
} with {
  briefly "Cancellation info"
  described by "Cancellation details."
}
