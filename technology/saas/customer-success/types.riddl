// Type definitions for Customer Success domain

type AccountId is Id(CustomerSuccessContext.CustomerAccount) with {
  briefly "Account identifier"
  described by "Unique identifier for a customer account."
}

type HealthScoreId is UUID with {
  briefly "Health score identifier"
  described by "Unique identifier for a health score record."
}

type TouchpointId is UUID with {
  briefly "Touchpoint identifier"
  described by "Unique identifier for a customer touchpoint."
}

type HealthStatus is any of {
  Healthy,
  AtRisk,
  Critical,
  Churned,
  New
} with {
  briefly "Health status"
  described by {
    | Represents the current health status of a customer account:
    | - Healthy: Customer is engaged and likely to renew
    | - AtRisk: Customer shows warning signs of potential churn
    | - Critical: Customer requires immediate intervention
    | - Churned: Customer has cancelled or not renewed
    | - New: Recently onboarded customer in initial assessment period
  }
}

type OnboardingStatus is any of {
  Pending,
  InProgress,
  Completed,
  Stalled
} with {
  briefly "Onboarding status"
  described by "Tracks the progress of a new customer through the onboarding workflow."
}

type RenewalOutcome is any of {
  Renewed,
  Expanded,
  Contracted,
  Churned,
  Pending
} with {
  briefly "Renewal outcome"
  described by "Captures the result of a contract renewal including expansion or contraction."
}

type CustomerAccountData is {
  accountId is AccountId with {
    briefly "Account ID"
    described by "Unique identifier for this account."
  }
  companyName is String(1, 200) with {
    briefly "Company name"
    described by "Name of the customer company."
  }
  contractStartDate is Date with {
    briefly "Contract start"
    described by "When the contract began."
  }
  contractEndDate is Date with {
    briefly "Contract end"
    described by "When the contract expires."
  }
  annualContractValue is Decimal(12, 2) with {
    briefly "ACV"
    described by "Annual contract value in dollars."
  }
  tier is String(1, 50) with {
    briefly "Tier"
    described by "Customer tier or segment."
  }
  primaryContactName is String(1, 100) with {
    briefly "Contact name"
    described by "Name of primary contact."
  }
  primaryContactEmail is String(5, 254) with {
    briefly "Contact email"
    described by "Email of primary contact."
  }
  assignedCsmId is String(1, 50) with {
    briefly "CSM ID"
    described by "Assigned customer success manager."
  }
  onboardingCompletedDate is optional Date with {
    briefly "Onboarding completed"
    described by "When onboarding finished."
  }
  healthStatus is HealthStatus with {
    briefly "Health status"
    described by "Current health classification."
  }
  lastTouchpointDate is optional Date with {
    briefly "Last touchpoint"
    described by "Date of most recent interaction."
  }
  renewalProbability is optional Decimal(5, 2) with {
    briefly "Renewal probability"
    described by "Likelihood of renewal as percentage."
  }
} with {
  briefly "Customer account data"
  described by {
    | Contains all essential information about a customer account including
    | contract details, primary contact, assigned customer success manager,
    | and current health status. This record is the foundation for all
    | customer success activities.
  }
}

type HealthScore is {
  healthScoreId is HealthScoreId with {
    briefly "Score ID"
    described by "Unique identifier for this score."
  }
  accountId is AccountId with {
    briefly "Account ID"
    described by "Account this score belongs to."
  }
  overallScore is Integer with {
    briefly "Overall score"
    described by "Combined health score 0-100."
  }
  productAdoptionScore is Integer with {
    briefly "Adoption score"
    described by "Product adoption score 0-100."
  }
  engagementScore is Integer with {
    briefly "Engagement score"
    described by "Customer engagement score 0-100."
  }
  supportHealthScore is Integer with {
    briefly "Support score"
    described by "Support health score 0-100."
  }
  financialHealthScore is Integer with {
    briefly "Financial score"
    described by "Financial health score 0-100."
  }
  calculatedAt is TimeStamp with {
    briefly "Calculated at"
    described by "When score was calculated."
  }
  factors is many String(1, 200) with {
    briefly "Factors"
    described by "Contributing factors to score."
  }
} with {
  briefly "Health score"
  described by {
    | A comprehensive health score calculation that combines multiple factors:
    | - Product Adoption: How well the customer uses the product features
    | - Engagement: Frequency and quality of customer interactions
    | - Support Health: Support ticket trends and resolution satisfaction
    | - Financial Health: Payment history and expansion indicators
    | Each score is 0-100, with the overall score being a weighted average.
  }
}

type TouchpointRecord is {
  touchpointId is TouchpointId with {
    briefly "Touchpoint ID"
    described by "Unique identifier for this touchpoint."
  }
  accountId is AccountId with {
    briefly "Account ID"
    described by "Account this touchpoint belongs to."
  }
  touchpointType is String(1, 50) with {
    briefly "Type"
    described by "Type of touchpoint (call, email, meeting, QBR)."
  }
  occurredAt is TimeStamp with {
    briefly "Occurred at"
    described by "When the touchpoint occurred."
  }
  conductedBy is String(1, 100) with {
    briefly "Conducted by"
    described by "Person who conducted the touchpoint."
  }
  summary is String(1, 1000) with {
    briefly "Summary"
    described by "Summary of the interaction."
  }
  sentiment is String(1, 20) with {
    briefly "Sentiment"
    described by "Detected sentiment (positive, neutral, negative)."
  }
  followUpRequired is Boolean with {
    briefly "Follow-up required"
    described by "Whether follow-up action is needed."
  }
  followUpDate is optional Date with {
    briefly "Follow-up date"
    described by "When follow-up should occur."
  }
  notes is optional String(1, 2000) with {
    briefly "Notes"
    described by "Additional notes from the interaction."
  }
} with {
  briefly "Touchpoint record"
  described by {
    | Captures details of any interaction with a customer including calls,
    | emails, meetings, QBRs (Quarterly Business Reviews), and escalations.
    | Sentiment tracking helps identify trends in customer satisfaction.
  }
}

type ChurnRisk is {
  accountId is AccountId with {
    briefly "Account ID"
    described by "Account being assessed for churn risk."
  }
  riskLevel is String(1, 20) with {
    briefly "Risk level"
    described by "Risk classification (Low, Medium, High, Critical)."
  }
  riskScore is Integer with {
    briefly "Risk score"
    described by "Numerical risk score 0-100."
  }
  primaryRiskFactors is many String(1, 200) with {
    briefly "Risk factors"
    described by "Primary factors contributing to churn risk."
  }
  identifiedAt is TimeStamp with {
    briefly "Identified at"
    described by "When risk was identified."
  }
  mitigationPlan is optional String(1, 2000) with {
    briefly "Mitigation plan"
    described by "Plan to address churn risk."
  }
  estimatedChurnDate is optional Date with {
    briefly "Estimated churn date"
    described by "When churn is expected if unaddressed."
  }
  revenueAtRisk is Decimal(12, 2) with {
    briefly "Revenue at risk"
    described by "Annual revenue at risk of loss."
  }
} with {
  briefly "Churn risk"
  described by {
    | Documents the churn risk analysis for a customer account including
    | the risk level (Low/Medium/High/Critical), contributing factors,
    | and estimated revenue impact. Used to prioritize CSM interventions
    | and create targeted retention strategies.
  }
}
