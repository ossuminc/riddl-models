// Types for Radiology Workflow Domain
// Defines identifiers, enumerations, and records used across the radiology workflow
// ============================================================================
// Identifiers
// ============================================================================
type ExamId is Id(ImagingExam)  with {
  briefly "Unique identifier for an imaging examination"
  described as {
    | A system-generated identifier that uniquely identifies an imaging
    | examination throughout its lifecycle from order to final report.
  }
}
type StudyId is Id(ImagingExam)  with {
  briefly "Unique identifier for a DICOM study"
  described as {
    | Corresponds to the DICOM Study Instance UID, linking all images
    | acquired during a single imaging session.
  }
}
type ModalityId is String with {
  briefly "Identifier for imaging equipment"
  described as {
    | Identifies specific imaging equipment such as CT scanners, MRI
    | machines, X-ray units, or ultrasound systems.
  }
}
type ReportId is Id(ImagingExam)  with {
  briefly "Unique identifier for a radiology report"
  described as {
    | A system-generated identifier that uniquely identifies a radiology
    | interpretation report.
  }
}
type PatientId is String with {
  briefly "Patient medical record number"
  described as {
    | The unique identifier for a patient within the healthcare system,
    | typically the Medical Record Number (MRN).
  }
}
type PhysicianId is String with {
  briefly "Identifier for a physician"
  described as {
    | Unique identifier for physicians including ordering clinicians
    | and interpreting radiologists.
  }
}
type TechnicianId is String with {
  briefly "Identifier for a radiology technician"
  described as {
    | Unique identifier for radiologic technologists who perform
    | imaging examinations.
  }
}
// ============================================================================
// Enumerations
// ============================================================================
type ExamStatus is any of {
  Ordered,
  Scheduled,
  CheckedIn,
  InProgress,
  Completed,
  Interpreted,
  Finalized
} with {
  briefly "Current status of an imaging examination"
  described as {
    | Tracks the lifecycle state of an imaging examination:
    | - Ordered: Exam has been requested by ordering physician
    | - Scheduled: Appointment time and modality assigned
    | - CheckedIn: Patient has arrived and registered
    | - InProgress: Image acquisition is underway
    | - Completed: Images have been acquired and sent to PACS
    | - Interpreted: Radiologist has created draft report
    | - Finalized: Report has been signed and distributed
  }
}
type ModalityType is any of {
  CT,
  MRI,
  XRay,
  Ultrasound,
  Mammography,
  Fluoroscopy,
  NuclearMedicine,
  PET,
  Interventional
} with {
  briefly "Type of imaging modality"
  described as {
    | Classification of imaging equipment by technology type, used for
    | scheduling, protocol selection, and resource planning.
  }
}
type ExamPriority is any of {
  Routine,
  Urgent,
  Stat,
  Emergent
} with {
  briefly "Priority level for imaging examination"
  described as {
    | Determines scheduling and interpretation priority:
    | - Routine: Standard turnaround, scheduled normally
    | - Urgent: Same-day completion required
    | - Stat: Within hours, interrupts normal workflow
    | - Emergent: Immediate, life-threatening situation
  }
}
type ReportStatus is any of {
  Draft,
  Preliminary,
  Final,
  Amended,
  Addended
} with {
  briefly "Status of the radiology report"
  described as {
    | Tracks the report through its approval workflow from initial
    | dictation to final signature and any subsequent amendments.
  }
}
type CriticalFindingSeverity is any of {
  Urgent,
  Critical,
  LifeThreatening
} with {
  briefly "Severity level of a critical finding"
  described as {
    | Classification of critical findings requiring immediate
    | communication to the ordering physician per ACR guidelines.
  }
}
// ============================================================================
// Records
// ============================================================================
type ImagingOrder is {
  orderId: ExamId
  patientId: PatientId
  orderingPhysicianId: PhysicianId
  examCode: String
  examDescription: String
  modalityType: ModalityType
  priority: ExamPriority
  clinicalIndication: String
  relevantHistory: String
  orderedAt: TimeStamp
  scheduledDateTime: TimeStamp?
  specialInstructions: String?
} with {
  briefly "Imaging examination order details"
  described as {
    | Contains all information from the ordering physician needed to schedule
    | and perform the imaging examination. Includes clinical context to guide
    | protocol selection and interpretation.
  }
}
type ExamProtocol is {
  protocolId: String
  protocolName: String
  modalityType: ModalityType
  contrastRequired: Boolean
  estimatedDuration: Duration
  radiationDose: Number?
  preparationInstructions: String
  contraindications: String*
} with {
  briefly "Imaging protocol specifications"
  described as {
    | Defines the technical parameters and patient preparation requirements
    | for performing a specific type of imaging examination. Protocols ensure
    | standardization and optimal image quality.
  }
}
type StudyInfo is {
  studyId: StudyId
  studyInstanceUid: String
  studyDateTime: TimeStamp
  modalityId: ModalityId
  technicianId: TechnicianId
  numberOfSeries: Integer
  numberOfImages: Integer
  bodyPartExamined: String
  studyDescription: String
  accessionNumber: String
  referringPhysician: PhysicianId
} with {
  briefly "DICOM study metadata"
  described as {
    | Contains metadata about the acquired imaging study following DICOM
    | standards. Links images in PACS to the radiology workflow and enables
    | study identification and retrieval.
  }
}
type RadiologyReport is {
  reportId: ReportId
  examId: ExamId
  studyId: StudyId
  patientId: PatientId
  radiologistId: PhysicianId
  reportStatus: ReportStatus
  findings: String
  impression: String
  recommendations: String?
  comparisonStudies: StudyId*
  criticalFinding: CriticalFinding?
  dictatedAt: TimeStamp
  signedAt: TimeStamp?
  transcribedBy: String?
} with {
  briefly "Radiology interpretation report"
  described as {
    | The formal interpretation of an imaging study by a radiologist. Contains
    | structured sections for findings, impression, and recommendations following
    | ACR reporting guidelines.
  }
}
type CriticalFinding is {
  findingId: String
  severity: CriticalFindingSeverity
  findingDescription: String
  identifiedAt: TimeStamp
  communicatedAt: TimeStamp?
  communicatedTo: PhysicianId?
  communicationMethod: String?
  acknowledgementReceived: Boolean
} with {
  briefly "Critical finding requiring immediate communication"
  described as {
    | Documents unexpected findings requiring urgent communication to the
    | ordering or covering physician. Tracks the closed-loop communication
    | process per ACR Practice Parameter guidelines.
  }
}
type ScheduleSlot is {
  slotDateTime: TimeStamp
  modalityId: ModalityId
  duration: Duration
  roomLocation: String
} with {
  briefly "Available time slot for scheduling"
  described as {
    | Represents an available appointment slot on a specific modality,
    | used for exam scheduling.
  }
}
type TurnaroundMetrics is {
  examId: ExamId
  orderToSchedule: Duration?
  scheduleToAcquisition: Duration?
  acquisitionToInterpretation: Duration?
  interpretationToFinal: Duration?
  totalTurnaround: Duration?
} with {
  briefly "Time metrics for exam workflow"
  described as {
    | Captures duration between each workflow milestone for quality
    | improvement and operational efficiency analysis.
  }
}
type ModalityUtilization is {
  modalityId: ModalityId
  date: Date
  scheduledExams: Integer
  completedExams: Integer
  utilizationPercent: Number
  averageExamDuration: Duration
  downtimeMinutes: Integer
} with {
  briefly "Daily utilization metrics for a modality"
  described as {
    | Tracks equipment utilization for capacity planning and
    | operational efficiency measurement.
  }
}
