// External Contexts for Member Enrollment Domain

context ExchangeIntegration is {

  type ExchangeEnrollmentRequest is {
    exchangeId is String(1, 50) with {
      briefly "Exchange ID"
      described by "Identifier from the health insurance exchange."
    }
    memberInfo is MemberInfo with {
      briefly "Member information"
      described by "Member data from exchange."
    }
    planId is PlanId with {
      briefly "Plan ID"
      described by "Selected plan identifier."
    }
    effectiveDate is Date with {
      briefly "Effective date"
      described by "Requested coverage start date."
    }
    aptcAmount is optional Decimal(8, 2) with {
      briefly "APTC amount"
      described by "Monthly Advanced Premium Tax Credit."
    }
    csrLevel is optional String(1, 20) with {
      briefly "CSR level"
      described by "Cost Sharing Reduction level if applicable."
    }
  } with {
    briefly "Enrollment request from health insurance exchange"
    described by {
      | Inbound enrollment data from federal or state health
      | insurance exchanges including subsidy information.
    }
  }

  type ExchangeEligibilityResponse is {
    exchangeId is String(1, 50) with {
      briefly "Exchange ID"
      described by "Identifier from the exchange."
    }
    isEligible is Boolean with {
      briefly "Is eligible"
      described by "Whether member is eligible."
    }
    aptcEligible is Boolean with {
      briefly "APTC eligible"
      described by "Eligible for premium tax credit."
    }
    aptcAmount is optional Decimal(8, 2) with {
      briefly "APTC amount"
      described by "Monthly tax credit amount."
    }
    csrEligible is Boolean with {
      briefly "CSR eligible"
      described by "Eligible for cost sharing reduction."
    }
    csrLevel is optional String(1, 20) with {
      briefly "CSR level"
      described by "Cost sharing reduction level."
    }
    verificationDate is DateTime with {
      briefly "Verification date"
      described by "When eligibility was verified."
    }
  } with {
    briefly "Eligibility determination from exchange"
    described by {
      | Exchange response with eligibility status and Advanced
      | Premium Tax Credit and Cost Sharing Reduction details.
    }
  }

  event ExchangeEnrollmentReceived is {
    request is ExchangeEnrollmentRequest with {
      briefly "Request"
      described by "The enrollment request data."
    }
    receivedAt is DateTime with {
      briefly "Received at"
      described by "When the request was received."
    }
  } with {
    briefly "Enrollment transmitted from exchange"
    described by {
      | Indicates an 834 enrollment transaction has been received
      | from the health insurance exchange for processing.
    }
  }

  event EligibilityDetermined is {
    response is ExchangeEligibilityResponse with {
      briefly "Response"
      described by "Eligibility determination result."
    }
  } with {
    briefly "Exchange eligibility check completed"
    described by {
      | Result of eligibility verification through the exchange
      | hub including subsidy calculations.
    }
  }

} with {
  option is external
  briefly "Health insurance exchange integration"
  described by {
    | External bounded context representing integration with
    | federal and state health insurance exchanges (Healthcare.gov,
    | state-based marketplaces). Handles 834 enrollment transactions,
    | eligibility verification, and subsidy determinations.
  }
}

context EmployerGroups is {

  type EmployerInfo is {
    employerId is String(1, 50) with {
      briefly "Employer ID"
      described by "Unique employer identifier."
    }
    employerName is String(1, 100) with {
      briefly "Employer name"
      described by "Company name."
    }
    groupNumber is String(1, 20) with {
      briefly "Group number"
      described by "Insurance group number."
    }
    effectiveDate is Date with {
      briefly "Effective date"
      described by "Group coverage start date."
    }
    terminationDate is optional Date with {
      briefly "Termination date"
      described by "Group coverage end date if terminated."
    }
  } with {
    briefly "Employer group information"
    described by {
      | Details about an employer group offering health coverage
      | including group identifiers and contract dates.
    }
  }

  type EmployeeEligibility is {
    employeeId is String(1, 50) with {
      briefly "Employee ID"
      described by "Employee identifier."
    }
    employerId is String(1, 50) with {
      briefly "Employer ID"
      described by "Employer identifier."
    }
    hireDate is Date with {
      briefly "Hire date"
      described by "Employee hire date."
    }
    eligibilityDate is Date with {
      briefly "Eligibility date"
      described by "Date employee becomes eligible."
    }
    employmentStatus is String(1, 20) with {
      briefly "Employment status"
      described by "Current employment status."
    }
    hoursPerWeek is Natural with {
      briefly "Hours per week"
      described by "Average weekly hours worked."
    }
    dependentsEligible is Boolean with {
      briefly "Dependents eligible"
      described by "Whether dependents can be enrolled."
    }
  } with {
    briefly "Employee eligibility from employer"
    described by {
      | Employment details that determine eligibility for
      | employer-sponsored health coverage.
    }
  }

  event EmployeeEligibilityVerified is {
    eligibility is EmployeeEligibility with {
      briefly "Eligibility"
      described by "Employee eligibility details."
    }
    verifiedAt is DateTime with {
      briefly "Verified at"
      described by "Verification timestamp."
    }
  } with {
    briefly "Employer confirmed employee eligibility"
    described by {
      | Indicates employer has verified employee is eligible
      | for group health coverage based on employment status.
    }
  }

  event EmployeeTerminated is {
    employeeId is String(1, 50) with {
      briefly "Employee ID"
      described by "The terminated employee."
    }
    employerId is String(1, 50) with {
      briefly "Employer ID"
      described by "The employer."
    }
    terminationDate is Date with {
      briefly "Termination date"
      described by "Employment termination date."
    }
    cobraEligible is Boolean with {
      briefly "COBRA eligible"
      described by "Whether eligible for COBRA continuation."
    }
  } with {
    briefly "Employee terminated from employer group"
    described by {
      | Indicates employee has been terminated, triggering
      | coverage termination and potential COBRA eligibility.
    }
  }

} with {
  option is external
  briefly "Employer group benefits integration"
  described by {
    | External bounded context for employer-sponsored coverage.
    | Manages group enrollment, employee eligibility verification,
    | COBRA administration, and employer billing integration.
  }
}

context BenefitsAdministration is {

  type BenefitsPlan is {
    planId is PlanId with {
      briefly "Plan ID"
      described by "Plan identifier."
    }
    planName is String(1, 100) with {
      briefly "Plan name"
      described by "Health plan name."
    }
    planType is String(1, 20) with {
      briefly "Plan type"
      described by "Type of health plan (HMO, PPO, etc.)."
    }
    networkType is String(1, 50) with {
      briefly "Network type"
      described by "Provider network configuration."
    }
    formularyId is String(1, 50) with {
      briefly "Formulary ID"
      described by "Drug formulary identifier."
    }
    benefitsSummary is String(1, 1000) with {
      briefly "Benefits summary"
      described by "Summary of plan benefits."
    }
  } with {
    briefly "Health plan benefits configuration"
    described by {
      | Detailed benefits structure including network, formulary,
      | and coverage parameters for a health plan product.
    }
  }

  type AccumulatorInfo is {
    memberId is MemberId with {
      briefly "Member ID"
      described by "Member identifier."
    }
    planYear is Natural with {
      briefly "Plan year"
      described by "Benefit plan year."
    }
    deductibleUsed is Decimal(8, 2) with {
      briefly "Deductible used"
      described by "Amount of deductible already used."
    }
    deductibleMax is Decimal(8, 2) with {
      briefly "Deductible max"
      described by "Annual deductible maximum."
    }
    oopUsed is Decimal(8, 2) with {
      briefly "OOP used"
      described by "Out-of-pocket amount used."
    }
    oopMax is Decimal(8, 2) with {
      briefly "OOP max"
      described by "Annual out-of-pocket maximum."
    }
    asOfDate is Date with {
      briefly "As of date"
      described by "Date of accumulator snapshot."
    }
  } with {
    briefly "Member cost accumulator status"
    described by {
      | Current accumulator balances for deductible and out-of-pocket
      | maximum tracking for a plan year.
    }
  }

  event AccumulatorsTransferred is {
    fromEnrollmentId is EnrollmentId with {
      briefly "From enrollment"
      described by "Source enrollment."
    }
    toEnrollmentId is EnrollmentId with {
      briefly "To enrollment"
      described by "Target enrollment."
    }
    accumulators is AccumulatorInfo with {
      briefly "Accumulators"
      described by "Transferred accumulator balances."
    }
    transferredAt is DateTime with {
      briefly "Transferred at"
      described by "Transfer timestamp."
    }
  } with {
    briefly "Cost accumulators transferred between plans"
    described by {
      | Indicates deductible and out-of-pocket accumulators have
      | been transferred when member changes plans mid-year.
    }
  }

  event CoverageActivated is {
    memberId is MemberId with {
      briefly "Member ID"
      described by "The member."
    }
    planId is PlanId with {
      briefly "Plan ID"
      described by "The activated plan."
    }
    effectiveDate is Date with {
      briefly "Effective date"
      described by "Coverage start date."
    }
    activatedAt is DateTime with {
      briefly "Activated at"
      described by "Activation timestamp."
    }
  } with {
    briefly "Coverage activated in benefits system"
    described by {
      | Confirms coverage has been activated in the benefits
      | administration system for claims processing.
    }
  }

} with {
  option is external
  briefly "Benefits administration system"
  described by {
    | External bounded context for benefits administration including
    | plan configuration, accumulator management, and coverage
    | activation. Provides the foundation for claims processing
    | once enrollment is confirmed.
  }
}
