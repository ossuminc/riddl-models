// Credentialing - Credential Context
context CredentialContext is {
  include "types.riddl"
  include "Credential.riddl"
  // Repository for credential persistence
  repository CredentialRepository is {
    schema CredentialData is relational
      of credentials as type Credential
        index on field Credential.credentialId
        index on field Credential.candidateId

    handler CredentialPersistence is {
      on command Credential.CreateApplication is {
        prompt "Store application record"
      }
      on command Credential.SubmitDocument is {
        prompt "Store document record"
      }
      on command Credential.ReviewApplication is {
        prompt "Update application status"
      }
      on command Credential.ScheduleExamination is {
        prompt "Store exam attempt"
      }
      on command Credential.RecordExamResult is {
        prompt "Update exam result"
      }
      on command Credential.IssueCredential is {
        prompt "Store credential record"
      }
      on command Credential.SuspendCredential is {
        prompt "Update credential status"
      }
      on command Credential.RevokeCredential is {
        prompt "Update credential status"
      }
      on command Credential.RecordContinuingEducation is {
        prompt "Store CE record"
      }
      on command Credential.RenewCredential is {
        prompt "Update credential expiration"
      }
    } with {
      briefly "Persists credential commands"
      described as {
        |Handles command-driven persistence.
      }
    }
  } with {
    briefly "Credential data persistence"
    described as {
      | The CredentialRepository provides persistent storage for
      | credentials, applications, and verification history.
    }
  }
  // Projector for credential analytics
  projector CredentialAnalytics is {
    record CredentialStats is  {
      programId: ProgramId with {
        briefly "Program"
        described as {
          |Program ID.
        }
      }
      totalIssued: Natural with {
        briefly "Issued"
        described as {
          |Total issued.
        }
      }
      totalActive: Natural with {
        briefly "Active"
        described as {
          |Currently active.
        }
      }
      passRate: Decimal(5,2) with {
        briefly "Pass rate"
        described as {
          |Exam pass rate.
        }
      }
      renewalRate: Decimal(5,2) with {
        briefly "Renewal rate"
        described as {
          |Renewal rate.
        }
      }
    } with {
      briefly "Credential statistics"
      described as {
        |Program credential metrics.
      }
    }
    handler AnalyticsHandler is {
      on event Credential.CredentialIssued is {
        prompt "Update issuance counts"
      }
      on event Credential.ExamResultRecorded is {
        prompt "Update pass rate metrics"
      }
      on event Credential.CredentialRenewed is {
        prompt "Update renewal metrics"
      }
      on event Credential.CredentialRevoked is {
        prompt "Update active counts"
      }
    } with {
      briefly "Maintains credential analytics"
      described as {
        |Projects events into analytics views.
      }
    }
  } with {
    briefly "Credential analytics projections"
    described as {
      |Maintains credential analytics data.
    }
  }
} with {
  briefly "Bounded context for credentialing"
  described as {
    | The CredentialContext is the bounded context for professional
    | certification, licensing, and credential verification.
  }
}
