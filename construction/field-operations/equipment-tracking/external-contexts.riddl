// Equipment Tracking - External Contexts

// GPS Tracking Service - Location data
context GPSTrackingService is {

  event LocationPing is {
    deviceId is String(1, 50) with { briefly "Device" described by "GPS device ID." }
    equipmentId is EquipmentId with { briefly "Equipment" described by "Equipment ID." }
    latitude is Decimal(9, 6) with { briefly "Latitude" described by "GPS latitude." }
    longitude is Decimal(9, 6) with { briefly "Longitude" described by "GPS longitude." }
    speed is optional Decimal(5, 2) with { briefly "Speed" described by "Current speed." }
    heading is optional Natural with { briefly "Heading" described by "Direction in degrees." }
    timestamp is TimeStamp with { briefly "Timestamp" described by "Ping time." }
  } with {
    briefly "GPS location ping"
    described by "Emitted when GPS device reports location."
  }

} with {
  option is external
  briefly "External GPS tracking"
  described by "External GPS tracking service."
}

// Maintenance Service - Work order management
context MaintenanceService is {

  command CreateWorkOrder is {
    equipmentId is EquipmentId with { briefly "Equipment" described by "Equipment ID." }
    workType is String(1, 50) with { briefly "Type" described by "Work type." }
    description is String(1, 2000) with { briefly "Description" described by "Work description." }
    priority is String(1, 20) with { briefly "Priority" described by "Priority level." }
    scheduledDate is Date with { briefly "Scheduled" described by "Scheduled date." }
  } with {
    briefly "Create work order"
    described by "Creates maintenance work order."
  }

  event WorkOrderCompleted is {
    workOrderId is UUID with { briefly "Work order" described by "Work order ID." }
    equipmentId is EquipmentId with { briefly "Equipment" described by "Equipment ID." }
    completedAt is TimeStamp with { briefly "Completed" described by "Completion time." }
    cost is Money with { briefly "Cost" described by "Labor and parts cost." }
    notes is String(1, 2000) with { briefly "Notes" described by "Completion notes." }
  } with {
    briefly "Work order was completed"
    described by "Emitted when maintenance is done."
  }

} with {
  option is external
  briefly "External maintenance service"
  described by "External maintenance management system."
}

// Job Site Service - Site information
context JobSiteService is {

  event SiteCreated is {
    siteId is JobSiteId with { briefly "Site" described by "Site ID." }
    siteName is String(1, 200) with { briefly "Name" described by "Site name." }
    address is String(1, 500) with { briefly "Address" described by "Site address." }
    projectId is UUID with { briefly "Project" described by "Associated project." }
  } with {
    briefly "Site was created"
    described by "Emitted when job site is established."
  }

  event SiteClosed is {
    siteId is JobSiteId with { briefly "Site" described by "Site ID." }
    closedAt is TimeStamp with { briefly "Closed" described by "Closure time." }
  } with {
    briefly "Site was closed"
    described by "Emitted when job site closes."
  }

} with {
  option is external
  briefly "External job site service"
  described by "External job site management."
}

// Notification Service - Alerts
context NotificationService is {

  command SendMaintenanceAlert is {
    equipmentId is EquipmentId with { briefly "Equipment" described by "Equipment ID." }
    alertType is String(1, 50) with { briefly "Type" described by "Alert type." }
    message is String(1, 1000) with { briefly "Message" described by "Alert message." }
    recipients is many String(1, 100) with { briefly "Recipients" described by "Alert recipients." }
  } with {
    briefly "Send maintenance alert"
    described by "Sends maintenance notification."
  }

  command SendLocationAlert is {
    equipmentId is EquipmentId with { briefly "Equipment" described by "Equipment ID." }
    alertType is String(1, 50) with { briefly "Type" described by "Geofence violation, etc." }
    message is String(1, 1000) with { briefly "Message" described by "Alert message." }
  } with {
    briefly "Send location alert"
    described by "Sends geofence or location alert."
  }

  event AlertSent is {
    alertId is UUID with { briefly "Alert" described by "Alert ID." }
    alertType is String(1, 50) with { briefly "Type" described by "Alert type." }
    sentAt is TimeStamp with { briefly "Sent" described by "Send time." }
  } with {
    briefly "Alert was sent"
    described by "Emitted when notification is delivered."
  }

} with {
  option is external
  briefly "External notification service"
  described by "External alerting and notification."
}
