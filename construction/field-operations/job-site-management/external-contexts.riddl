// Job Site Management - External Contexts

// Weather Service - Weather data and alerts
context WeatherService is {

  event WeatherAlert is {
    alertId is UUID with { briefly "Alert" described by "Alert ID." }
    location is Location with { briefly "Location" described by "Affected location." }
    condition is WeatherCondition with { briefly "Condition" described by "Weather condition." }
    alertSeverity is String(1, 20) with { briefly "Severity" described by "Alert severity." }
    message is String(1, 500) with { briefly "Message" described by "Alert message." }
    effectiveFrom is TimeStamp with { briefly "From" described by "Alert start." }
    effectiveUntil is TimeStamp with { briefly "Until" described by "Alert end." }
  } with {
    briefly "Weather alert"
    described by "Emitted when weather conditions affect site."
  }

  event ForecastUpdated is {
    location is Location with { briefly "Location" described by "Forecast location." }
    forecastDate is Date with { briefly "Date" described by "Forecast date." }
    highTemp is Integer with { briefly "High" described by "High temperature." }
    lowTemp is Integer with { briefly "Low" described by "Low temperature." }
    precipitation is Natural with { briefly "Precip" described by "Precipitation chance." }
    condition is WeatherCondition with { briefly "Condition" described by "Expected condition." }
  } with {
    briefly "Forecast was updated"
    described by "Emitted when forecast changes."
  }

} with {
  option is external
  briefly "External weather service"
  described by "External weather data provider."
}

// Project Service - Project management
context ProjectService is {

  event ProjectUpdated is {
    projectId is ProjectId with { briefly "Project" described by "Project ID." }
    updateType is String(1, 50) with { briefly "Type" described by "Update type." }
    description is String(1, 500) with { briefly "Description" described by "Update description." }
    updatedAt is TimeStamp with { briefly "Updated" described by "Update time." }
  } with {
    briefly "Project was updated"
    described by "Emitted when project details change."
  }

  event ScheduleChanged is {
    projectId is ProjectId with { briefly "Project" described by "Project ID." }
    newEndDate is Date with { briefly "End date" described by "New project end date." }
    reason is String(1, 500) with { briefly "Reason" described by "Change reason." }
  } with {
    briefly "Schedule was changed"
    described by "Emitted when project schedule changes."
  }

} with {
  option is external
  briefly "External project service"
  described by "External project management system."
}

// Notification Service - Site communications
context NotificationService is {

  command SendSiteAlert is {
    jobSiteId is JobSiteId with { briefly "Site" described by "Site ID." }
    alertType is String(1, 50) with { briefly "Type" described by "Alert type." }
    message is String(1, 1000) with { briefly "Message" described by "Alert message." }
    priority is String(1, 20) with { briefly "Priority" described by "Priority level." }
    recipients is many String(1, 100) with { briefly "Recipients" described by "Alert recipients." }
  } with {
    briefly "Send site alert"
    described by "Sends alert notification to site personnel."
  }

  command SendDailyReportNotification is {
    jobSiteId is JobSiteId with { briefly "Site" described by "Site ID." }
    reportDate is Date with { briefly "Date" described by "Report date." }
    summary is String(1, 500) with { briefly "Summary" described by "Report summary." }
    recipients is many String(1, 100) with { briefly "Recipients" described by "Notification recipients." }
  } with {
    briefly "Send daily report notification"
    described by "Notifies stakeholders of daily report."
  }

  event AlertSent is {
    alertId is UUID with { briefly "Alert" described by "Alert ID." }
    jobSiteId is JobSiteId with { briefly "Site" described by "Site ID." }
    sentAt is TimeStamp with { briefly "Sent" described by "Send time." }
  } with {
    briefly "Alert was sent"
    described by "Emitted when notification is delivered."
  }

} with {
  option is external
  briefly "External notification service"
  described by "External communications service."
}

// Safety Compliance Service - Regulatory compliance
context SafetyComplianceService is {

  command SubmitInspectionReport is {
    jobSiteId is JobSiteId with { briefly "Site" described by "Site ID." }
    inspection is SafetyInspection with { briefly "Inspection" described by "Inspection data." }
  } with {
    briefly "Submit inspection report"
    described by "Submits inspection to compliance system."
  }

  event ComplianceStatusUpdated is {
    jobSiteId is JobSiteId with { briefly "Site" described by "Site ID." }
    complianceStatus is String(1, 50) with { briefly "Status" described by "Compliance status." }
    violations is Natural with { briefly "Violations" described by "Violation count." }
    updatedAt is TimeStamp with { briefly "Updated" described by "Update time." }
  } with {
    briefly "Compliance status was updated"
    described by "Emitted when compliance status changes."
  }

} with {
  option is external
  briefly "External safety compliance"
  described by "External safety compliance system."
}
