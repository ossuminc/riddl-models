// Bid Management - External Contexts

// Contractor Service - Contractor information
context ContractorService is {

  event ContractorRegistered is {
    contractorId is ContractorId with { briefly "Contractor" described by "Contractor ID." }
    name is String(1, 200) with { briefly "Name" described by "Contractor name." }
    licenseNumber is String(1, 50) with { briefly "License" described by "License number." }
    trades is many String(1, 50) with { briefly "Trades" described by "Licensed trades." }
    bondingLimit is Money with { briefly "Bonding" described by "Bonding capacity." }
    registeredAt is TimeStamp with { briefly "Registered" described by "Registration time." }
  } with {
    briefly "Contractor was registered"
    described by "Emitted when contractor registers."
  }

  event ContractorQualified is {
    contractorId is ContractorId with { briefly "Contractor" described by "Contractor ID." }
    earnedQualifications is many String(1, 100) with { briefly "Qualifications" described by "Earned qualifications." }
    qualifiedAt is TimeStamp with { briefly "Qualified" described by "Qualification time." }
  } with {
    briefly "Contractor was qualified"
    described by "Emitted when contractor earns qualifications."
  }

} with {
  option is external
  briefly "External contractor service"
  described by "External contractor management system."
}

// Project Service - Project and RFP information
context ProjectService is {

  event RFPPublished is {
    rfpId is UUID with { briefly "RFP" described by "RFP ID." }
    projectId is ProjectId with { briefly "Project" described by "Project ID." }
    title is String(1, 200) with { briefly "Title" described by "RFP title." }
    bidType is BidType with { briefly "Type" described by "Required bid type." }
    dueDate is Date with { briefly "Due" described by "Submission deadline." }
    publishedAt is TimeStamp with { briefly "Published" described by "Publication time." }
  } with {
    briefly "RFP was published"
    described by "Emitted when RFP is published."
  }

  event RFPClosed is {
    rfpId is UUID with { briefly "RFP" described by "RFP ID." }
    closedAt is TimeStamp with { briefly "Closed" described by "Close time." }
  } with {
    briefly "RFP was closed"
    described by "Emitted when RFP bidding closes."
  }

  event RFPCancelled is {
    rfpId is UUID with { briefly "RFP" described by "RFP ID." }
    reason is String(1, 500) with { briefly "Reason" described by "Cancellation reason." }
    cancelledAt is TimeStamp with { briefly "Cancelled" described by "Cancellation time." }
  } with {
    briefly "RFP was cancelled"
    described by "Emitted when RFP is cancelled."
  }

} with {
  option is external
  briefly "External project service"
  described by "External project management system."
}

// Notification Service - Bid communications
context NotificationService is {

  command NotifyBidReceived is {
    rfpId is UUID with { briefly "RFP" described by "RFP ID." }
    bidId is BidId with { briefly "Bid" described by "Bid ID." }
    contractorName is String(1, 200) with { briefly "Contractor" described by "Contractor name." }
    recipients is many String(1, 100) with { briefly "Recipients" described by "Notification recipients." }
  } with {
    briefly "Notify bid received"
    described by "Notifies team of bid submission."
  }

  command NotifyAwardDecision is {
    bidId is BidId with { briefly "Bid" described by "Bid ID." }
    contractorId is ContractorId with { briefly "Contractor" described by "Contractor ID." }
    awarded is Boolean with { briefly "Awarded" described by "Whether awarded." }
    message is String(1, 2000) with { briefly "Message" described by "Decision message." }
  } with {
    briefly "Notify award decision"
    described by "Notifies contractor of award decision."
  }

  event NotificationSent is {
    notificationId is UUID with { briefly "Notification" described by "Notification ID." }
    notificationType is String(1, 50) with { briefly "Type" described by "Notification type." }
    sentAt is TimeStamp with { briefly "Sent" described by "Send time." }
  } with {
    briefly "Notification was sent"
    described by "Emitted when notification is delivered."
  }

} with {
  option is external
  briefly "External notification service"
  described by "External communications service."
}

// Contract Service - Contract generation
context ContractService is {

  command GenerateContract is {
    bidId is BidId with { briefly "Bid" described by "Awarded bid ID." }
    contractorId is ContractorId with { briefly "Contractor" described by "Contractor ID." }
    proposal is BidProposal with { briefly "Proposal" described by "Winning proposal." }
  } with {
    briefly "Generate contract"
    described by "Generates contract from awarded bid."
  }

  event ContractGenerated is {
    contractId is UUID with { briefly "Contract" described by "Contract ID." }
    bidId is BidId with { briefly "Bid" described by "Source bid." }
    generatedAt is TimeStamp with { briefly "Generated" described by "Generation time." }
  } with {
    briefly "Contract was generated"
    described by "Emitted when contract is created."
  }

} with {
  option is external
  briefly "External contract service"
  described by "External contract management system."
}
