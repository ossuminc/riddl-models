// Bid Management - External Contexts
// Contractor Service - Contractor information
context ContractorService is {
  event ContractorRegistered is  {
    contractorId: ContractorId with {
      briefly "Contractor"
      described as {
        |Contractor ID.
      }
    }
    name: String(1,200) with {
      briefly "Name"
      described as {
        |Contractor name.
      }
    }
    licenseNumber: String(1,50) with {
      briefly "License"
      described as {
        |License number.
      }
    }
    trades: String(1,50)+ with {
      briefly "Trades"
      described as {
        |Licensed trades.
      }
    }
    bondingLimit: Money with {
      briefly "Bonding"
      described as {
        |Bonding capacity.
      }
    }
    registeredAt: TimeStamp with {
      briefly "Registered"
      described as {
        |Registration time.
      }
    }
  } with {
    briefly "Contractor was registered"
    described as {
      |Emitted when contractor registers.
    }
  }
  event ContractorQualified is  {
    contractorId: ContractorId with {
      briefly "Contractor"
      described as {
        |Contractor ID.
      }
    }
    earnedQualifications: String(1,100)+ with {
      briefly "Qualifications"
      described as {
        |Earned qualifications.
      }
    }
    qualifiedAt: TimeStamp with {
      briefly "Qualified"
      described as {
        |Qualification time.
      }
    }
  } with {
    briefly "Contractor was qualified"
    described as {
      |Emitted when contractor earns qualifications.
    }
  }
} with {
  option external()
  briefly "External contractor service"
  described as {
    |External contractor management system.
  }
}
// Project Service - Project and RFP information
context ProjectService is {
  event RFPPublished is  {
    rfpId: UUID with {
      briefly "RFP"
      described as {
        |RFP ID.
      }
    }
    projectId: ProjectId with {
      briefly "Project"
      described as {
        |Project ID.
      }
    }
    title: String(1,200) with {
      briefly "Title"
      described as {
        |RFP title.
      }
    }
    bidType: BidType with {
      briefly "Type"
      described as {
        |Required bid type.
      }
    }
    dueDate: Date with {
      briefly "Due"
      described as {
        |Submission deadline.
      }
    }
    publishedAt: TimeStamp with {
      briefly "Published"
      described as {
        |Publication time.
      }
    }
  } with {
    briefly "RFP was published"
    described as {
      |Emitted when RFP is published.
    }
  }
  event RFPClosed is  {
    rfpId: UUID with {
      briefly "RFP"
      described as {
        |RFP ID.
      }
    }
    closedAt: TimeStamp with {
      briefly "Closed"
      described as {
        |Close time.
      }
    }
  } with {
    briefly "RFP was closed"
    described as {
      |Emitted when RFP bidding closes.
    }
  }
  event RFPCancelled is  {
    rfpId: UUID with {
      briefly "RFP"
      described as {
        |RFP ID.
      }
    }
    reason: String(1,500) with {
      briefly "Reason"
      described as {
        |Cancellation reason.
      }
    }
    cancelledAt: TimeStamp with {
      briefly "Cancelled"
      described as {
        |Cancellation time.
      }
    }
  } with {
    briefly "RFP was cancelled"
    described as {
      |Emitted when RFP is cancelled.
    }
  }
} with {
  option external()
  briefly "External project service"
  described as {
    |External project management system.
  }
}
// Notification Service - Bid communications
context NotificationService is {
  command NotifyBidReceived is  {
    rfpId: UUID with {
      briefly "RFP"
      described as {
        |RFP ID.
      }
    }
    bidId: BidId with {
      briefly "Bid"
      described as {
        |Bid ID.
      }
    }
    contractorName: String(1,200) with {
      briefly "Contractor"
      described as {
        |Contractor name.
      }
    }
    recipients: String(1,100)+ with {
      briefly "Recipients"
      described as {
        |Notification recipients.
      }
    }
  } with {
    briefly "Notify bid received"
    described as {
      |Notifies team of bid submission.
    }
  }
  command NotifyAwardDecision is  {
    bidId: BidId with {
      briefly "Bid"
      described as {
        |Bid ID.
      }
    }
    contractorId: ContractorId with {
      briefly "Contractor"
      described as {
        |Contractor ID.
      }
    }
    awarded: Boolean with {
      briefly "Awarded"
      described as {
        |Whether awarded.
      }
    }
    message: String(1,2000) with {
      briefly "Message"
      described as {
        |Decision message.
      }
    }
  } with {
    briefly "Notify award decision"
    described as {
      |Notifies contractor of award decision.
    }
  }
  event NotificationSent is  {
    notificationId: UUID with {
      briefly "Notification"
      described as {
        |Notification ID.
      }
    }
    notificationType: String(1,50) with {
      briefly "Type"
      described as {
        |Notification type.
      }
    }
    sentAt: TimeStamp with {
      briefly "Sent"
      described as {
        |Send time.
      }
    }
  } with {
    briefly "Notification was sent"
    described as {
      |Emitted when notification is delivered.
    }
  }
} with {
  option external()
  briefly "External notification service"
  described as {
    |External communications service.
  }
}
// Contract Service - Contract generation
context ContractService is {
  command GenerateContract is  {
    bidId: BidId with {
      briefly "Bid"
      described as {
        |Awarded bid ID.
      }
    }
    contractorId: ContractorId with {
      briefly "Contractor"
      described as {
        |Contractor ID.
      }
    }
    proposal: BidProposal with {
      briefly "Proposal"
      described as {
        |Winning proposal.
      }
    }
  } with {
    briefly "Generate contract"
    described as {
      |Generates contract from awarded bid.
    }
  }
  event ContractGenerated is  {
    contractId: UUID with {
      briefly "Contract"
      described as {
        |Contract ID.
      }
    }
    bidId: BidId with {
      briefly "Bid"
      described as {
        |Source bid.
      }
    }
    generatedAt: TimeStamp with {
      briefly "Generated"
      described as {
        |Generation time.
      }
    }
  } with {
    briefly "Contract was generated"
    described as {
      |Emitted when contract is created.
    }
  }
} with {
  option external()
  briefly "External contract service"
  described as {
    |External contract management system.
  }
}
