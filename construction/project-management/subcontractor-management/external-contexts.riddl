// Subcontractor Management - External Contexts

// License Verification Service
context LicenseVerificationService is {

  command VerifyLicense is {
    licenseNumber is String(1, 50) with { briefly "License" described by "License number." }
    state is String(2, 2) with { briefly "State" described by "State code." }
    trade is Trade with { briefly "Trade" described by "Trade type." }
  } with {
    briefly "Verify license"
    described by "Verifies contractor license."
  }

  event LicenseVerified is {
    licenseNumber is String(1, 50) with { briefly "License" described by "License number." }
    isValid is Boolean with { briefly "Valid" described by "Is license valid." }
    expiryDate is Date with { briefly "Expiry" described by "Expiration date." }
    verifiedAt is TimeStamp with { briefly "Verified" described by "Verification time." }
  } with {
    briefly "License was verified"
    described by "Emitted when license is checked."
  }

} with {
  option is external
  briefly "External license service"
  described by "External license verification system."
}

// Insurance Verification Service
context InsuranceVerificationService is {

  command VerifyInsurance is {
    policyNumber is String(1, 50) with { briefly "Policy" described by "Policy number." }
    carrier is String(1, 100) with { briefly "Carrier" described by "Insurance carrier." }
  } with {
    briefly "Verify insurance"
    described by "Verifies insurance policy."
  }

  event InsuranceVerified is {
    policyNumber is String(1, 50) with { briefly "Policy" described by "Policy number." }
    isValid is Boolean with { briefly "Valid" described by "Is policy valid." }
    coverageAmount is Money with { briefly "Coverage" described by "Coverage amount." }
    expiryDate is Date with { briefly "Expiry" described by "Expiration date." }
    verifiedAt is TimeStamp with { briefly "Verified" described by "Verification time." }
  } with {
    briefly "Insurance was verified"
    described by "Emitted when insurance is checked."
  }

} with {
  option is external
  briefly "External insurance service"
  described by "External insurance verification system."
}

// Payment Service
context PaymentService is {

  command ProcessPayment is {
    subcontractorId is SubcontractorId with { briefly "Subcontractor" described by "Subcontractor ID." }
    applicationId is UUID with { briefly "Application" described by "Pay app ID." }
    paymentAmount is Money with { briefly "Amount" described by "Payment amount." }
    paymentMethod is String(1, 50) with { briefly "Method" described by "Payment method." }
  } with {
    briefly "Process payment"
    described by "Processes subcontractor payment."
  }

  event PaymentProcessed is {
    paymentId is UUID with { briefly "Payment" described by "Payment ID." }
    subcontractorId is SubcontractorId with { briefly "Subcontractor" described by "Subcontractor ID." }
    processedAmount is Money with { briefly "Amount" described by "Payment amount." }
    processedAt is TimeStamp with { briefly "Processed" described by "Process time." }
  } with {
    briefly "Payment was processed"
    described by "Emitted when payment is sent."
  }

} with {
  option is external
  briefly "External payment service"
  described by "External payment processing system."
}

// Notification Service
context NotificationService is {

  command SendSubcontractorNotification is {
    subcontractorId is SubcontractorId with { briefly "Subcontractor" described by "Subcontractor ID." }
    notificationType is String(1, 50) with { briefly "Type" described by "Notification type." }
    message is String(1, 2000) with { briefly "Message" described by "Message content." }
  } with {
    briefly "Send notification"
    described by "Sends notification to subcontractor."
  }

  event NotificationSent is {
    notificationId is UUID with { briefly "Notification" described by "Notification ID." }
    subcontractorId is SubcontractorId with { briefly "Subcontractor" described by "Subcontractor ID." }
    sentAt is TimeStamp with { briefly "Sent" described by "Send time." }
  } with {
    briefly "Notification was sent"
    described by "Emitted when notification is delivered."
  }

} with {
  option is external
  briefly "External notification service"
  described by "External communications service."
}
