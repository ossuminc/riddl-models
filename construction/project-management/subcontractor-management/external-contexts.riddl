// Subcontractor Management - External Contexts
// License Verification Service
context LicenseVerificationService is {
  command VerifyLicense is  {
    licenseNumber: String(1,50) with {
      briefly "License"
      described as {
        |License number.
      }
    }
    state: String(2,2) with {
      briefly "State"
      described as {
        |State code.
      }
    }
    trade: Trade with {
      briefly "Trade"
      described as {
        |Trade type.
      }
    }
  } with {
    briefly "Verify license"
    described as {
      |Verifies contractor license.
    }
  }
  event LicenseVerified is  {
    licenseNumber: String(1,50) with {
      briefly "License"
      described as {
        |License number.
      }
    }
    isValid: Boolean with {
      briefly "Valid"
      described as {
        |Is license valid.
      }
    }
    expiryDate: Date with {
      briefly "Expiry"
      described as {
        |Expiration date.
      }
    }
    verifiedAt: TimeStamp with {
      briefly "Verified"
      described as {
        |Verification time.
      }
    }
  } with {
    briefly "License was verified"
    described as {
      |Emitted when license is checked.
    }
  }
} with {
  option external()
  briefly "External license service"
  described as {
    |External license verification system.
  }
}
// Insurance Verification Service
context InsuranceVerificationService is {
  command VerifyInsurance is  {
    policyNumber: String(1,50) with {
      briefly "Policy"
      described as {
        |Policy number.
      }
    }
    carrier: String(1,100) with {
      briefly "Carrier"
      described as {
        |Insurance carrier.
      }
    }
  } with {
    briefly "Verify insurance"
    described as {
      |Verifies insurance policy.
    }
  }
  event InsuranceVerified is  {
    policyNumber: String(1,50) with {
      briefly "Policy"
      described as {
        |Policy number.
      }
    }
    isValid: Boolean with {
      briefly "Valid"
      described as {
        |Is policy valid.
      }
    }
    coverageAmount: Money with {
      briefly "Coverage"
      described as {
        |Coverage amount.
      }
    }
    expiryDate: Date with {
      briefly "Expiry"
      described as {
        |Expiration date.
      }
    }
    verifiedAt: TimeStamp with {
      briefly "Verified"
      described as {
        |Verification time.
      }
    }
  } with {
    briefly "Insurance was verified"
    described as {
      |Emitted when insurance is checked.
    }
  }
} with {
  option external()
  briefly "External insurance service"
  described as {
    |External insurance verification system.
  }
}
// Payment Service
context PaymentService is {
  command ProcessPayment is  {
    subcontractorId: SubcontractorId with {
      briefly "Subcontractor"
      described as {
        |Subcontractor ID.
      }
    }
    applicationId: UUID with {
      briefly "Application"
      described as {
        |Pay app ID.
      }
    }
    paymentAmount: Money with {
      briefly "Amount"
      described as {
        |Payment amount.
      }
    }
    paymentMethod: String(1,50) with {
      briefly "Method"
      described as {
        |Payment method.
      }
    }
  } with {
    briefly "Process payment"
    described as {
      |Processes subcontractor payment.
    }
  }
  event PaymentProcessed is  {
    paymentId: UUID with {
      briefly "Payment"
      described as {
        |Payment ID.
      }
    }
    subcontractorId: SubcontractorId with {
      briefly "Subcontractor"
      described as {
        |Subcontractor ID.
      }
    }
    processedAmount: Money with {
      briefly "Amount"
      described as {
        |Payment amount.
      }
    }
    processedAt: TimeStamp with {
      briefly "Processed"
      described as {
        |Process time.
      }
    }
  } with {
    briefly "Payment was processed"
    described as {
      |Emitted when payment is sent.
    }
  }
} with {
  option external()
  briefly "External payment service"
  described as {
    |External payment processing system.
  }
}
// Notification Service
context NotificationService is {
  command SendSubcontractorNotification is  {
    subcontractorId: SubcontractorId with {
      briefly "Subcontractor"
      described as {
        |Subcontractor ID.
      }
    }
    notificationType: String(1,50) with {
      briefly "Type"
      described as {
        |Notification type.
      }
    }
    message: String(1,2000) with {
      briefly "Message"
      described as {
        |Message content.
      }
    }
  } with {
    briefly "Send notification"
    described as {
      |Sends notification to subcontractor.
    }
  }
  event NotificationSent is  {
    notificationId: UUID with {
      briefly "Notification"
      described as {
        |Notification ID.
      }
    }
    subcontractorId: SubcontractorId with {
      briefly "Subcontractor"
      described as {
        |Subcontractor ID.
      }
    }
    sentAt: TimeStamp with {
      briefly "Sent"
      described as {
        |Send time.
      }
    }
  } with {
    briefly "Notification was sent"
    described as {
      |Emitted when notification is delivered.
    }
  }
} with {
  option external()
  briefly "External notification service"
  described as {
    |External communications service.
  }
}
