// Transaction Management - Shared Types

type TransactionId is Id(TransactionContext.Transaction) with {
  briefly "Transaction identifier"
  described by "Unique identifier for a transaction."
}

type PropertyId is UUID with {
  briefly "Property identifier"
  described by "Reference to a property."
}

type PartyId is UUID with {
  briefly "Party identifier"
  described by "Reference to a transaction party."
}

type Money is {
  amount is Decimal(14, 2) with {
    briefly "Amount"
    described by "Monetary value."
  }
  currency is Currency(USD) with {
    briefly "Currency"
    described by "Currency code."
  }
} with {
  briefly "Monetary value"
  described by "Amount with currency."
}

type TransactionType is any of {
  Purchase,
  Sale,
  Lease,
  LeaseOption,
  Exchange
} with {
  briefly "Transaction type"
  described by "Type of real estate transaction."
}

type TransactionStatus is any of {
  Draft,
  Pending,
  UnderContract,
  InEscrow,
  Closing,
  Closed,
  Cancelled,
  Expired
} with {
  briefly "Transaction status"
  described by "Current transaction status."
}

type Party is {
  partyId is PartyId with {
    briefly "Party ID"
    described by "Party identifier."
  }
  name is String(1, 200) with {
    briefly "Name"
    described by "Party name."
  }
  partyType is PartyType with {
    briefly "Type"
    described by "Party type."
  }
  email is String(1, 100) with {
    briefly "Email"
    described by "Contact email."
  }
  phone is String(1, 20) with {
    briefly "Phone"
    described by "Contact phone."
  }
  agent is optional AgentInfo with {
    briefly "Agent"
    described by "Representing agent."
  }
} with {
  briefly "Transaction party"
  described by "Buyer, seller, or other party."
}

type PartyType is any of {
  BuyerType,
  SellerType,
  AgentType,
  LenderType,
  TitleCompanyType,
  EscrowAgentType,
  AttorneyType
} with {
  briefly "Party type"
  described by "Type of transaction party."
}

type AgentInfo is {
  agentId is UUID with {
    briefly "Agent ID"
    described by "Agent identifier."
  }
  name is String(1, 100) with {
    briefly "Name"
    described by "Agent name."
  }
  licenseNumber is String(1, 50) with {
    briefly "License"
    described by "License number."
  }
  brokerage is String(1, 200) with {
    briefly "Brokerage"
    described by "Brokerage name."
  }
} with {
  briefly "Agent information"
  described by "Real estate agent details."
}

type PropertyDetails is {
  propertyId is PropertyId with {
    briefly "Property ID"
    described by "Property identifier."
  }
  address is String(1, 500) with {
    briefly "Address"
    described by "Property address."
  }
  propertyType is String(1, 50) with {
    briefly "Type"
    described by "Property type."
  }
  listPrice is Money with {
    briefly "List price"
    described by "Listing price."
  }
  squareFootage is Natural with {
    briefly "Sq ft"
    described by "Square footage."
  }
  mlsNumber is optional String(1, 20) with {
    briefly "MLS"
    described by "MLS listing number."
  }
} with {
  briefly "Property details"
  described by "Transaction property information."
}

type Offer is {
  offerId is UUID with {
    briefly "Offer ID"
    described by "Offer identifier."
  }
  offerPrice is Money with {
    briefly "Price"
    described by "Offered price."
  }
  earnestMoney is Money with {
    briefly "Earnest"
    described by "Earnest money deposit."
  }
  financingType is FinancingType with {
    briefly "Financing"
    described by "Financing type."
  }
  contingencies is many Contingency with {
    briefly "Contingencies"
    described by "Offer contingencies."
  }
  closingDate is Date with {
    briefly "Closing"
    described by "Target closing date."
  }
  expirationDate is Date with {
    briefly "Expiration"
    described by "Offer expiration."
  }
  status is OfferStatus with {
    briefly "Status"
    described by "Offer status."
  }
  submittedAt is TimeStamp with {
    briefly "Submitted"
    described by "Submission time."
  }
} with {
  briefly "Purchase offer"
  described by "Buyer offer details."
}

type OfferStatus is any of {
  Submitted,
  Countered,
  Accepted,
  Rejected,
  Withdrawn,
  Expired
} with {
  briefly "Offer status"
  described by "Current offer status."
}

type FinancingType is any of {
  CashFinancing,
  ConventionalLoan,
  FHALoan,
  VALoan,
  USDALoan,
  SellerFinancing
} with {
  briefly "Financing type"
  described by "Type of financing."
}

type Contingency is {
  contingencyType is ContingencyType with {
    briefly "Type"
    described by "Contingency type."
  }
  description is String(1, 500) with {
    briefly "Description"
    described by "Contingency details."
  }
  deadline is Date with {
    briefly "Deadline"
    described by "Contingency deadline."
  }
  contingencyStatus is ContingencyStatus with {
    briefly "Status"
    described by "Contingency status."
  }
} with {
  briefly "Contract contingency"
  described by "Transaction contingency."
}

type ContingencyType is any of {
  Financing,
  Inspection,
  Appraisal,
  TitleSearch,
  HomeownersInsurance,
  SaleOfHome,
  Other
} with {
  briefly "Contingency type"
  described by "Type of contingency."
}

type ContingencyStatus is any of {
  PendingContingency,
  SatisfiedContingency,
  WaivedContingency,
  FailedContingency
} with {
  briefly "Contingency status"
  described by "Status of contingency."
}

type Contract is {
  contractId is UUID with {
    briefly "Contract ID"
    described by "Contract identifier."
  }
  purchasePrice is Money with {
    briefly "Price"
    described by "Purchase price."
  }
  earnestMoney is Money with {
    briefly "Earnest"
    described by "Earnest money."
  }
  closingCosts is ClosingCosts with {
    briefly "Closing costs"
    described by "Closing cost allocation."
  }
  closingDate is Date with {
    briefly "Closing"
    described by "Closing date."
  }
  executedAt is TimeStamp with {
    briefly "Executed"
    described by "Execution time."
  }
} with {
  briefly "Purchase contract"
  described by "Executed purchase agreement."
}

type ClosingCosts is {
  buyerCosts is Money with {
    briefly "Buyer"
    described by "Buyer closing costs."
  }
  sellerCosts is Money with {
    briefly "Seller"
    described by "Seller closing costs."
  }
  sellerConcessions is Money with {
    briefly "Concessions"
    described by "Seller concessions."
  }
} with {
  briefly "Closing costs"
  described by "Closing cost breakdown."
}

type ClosingDocument is {
  documentId is UUID with {
    briefly "Document ID"
    described by "Document identifier."
  }
  documentType is String(1, 100) with {
    briefly "Type"
    described by "Document type."
  }
  name is String(1, 200) with {
    briefly "Name"
    described by "Document name."
  }
  signedByBuyer is Boolean with {
    briefly "Buyer signed"
    described by "Signed by buyer."
  }
  signedBySeller is Boolean with {
    briefly "Seller signed"
    described by "Signed by seller."
  }
} with {
  briefly "Closing document"
  described by "Document required for closing."
}
