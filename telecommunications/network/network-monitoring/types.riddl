// Network Monitoring - Shared Types

type DeviceId is Id(MonitoringContext.NetworkDevice) with {
  briefly "Device identifier"
  described by "Unique identifier for a network device."
}

type AlertId is UUID with {
  briefly "Alert identifier"
  described by "Unique identifier for an alert."
}

type DeviceStatus is any of {
  Online,
  Degraded,
  Warning,
  Critical,
  Offline,
  Maintenance
} with {
  briefly "Device status"
  described by "Network device status."
}

type DeviceType is any of {
  Router,
  Switch,
  Firewall,
  LoadBalancer,
  AccessPoint,
  Server,
  BaseStation,
  Antenna
} with {
  briefly "Device type"
  described by "Type of network device."
}

type AlertSeverity is any of {
  Info,
  Warning,
  Minor,
  Major,
  Critical
} with {
  briefly "Alert severity"
  described by "Alert importance level."
}

type AlertStatus is any of {
  Active,
  Acknowledged,
  InProgress,
  Resolved,
  Suppressed
} with {
  briefly "Alert status"
  described by "Alert lifecycle status."
}

type DeviceInfo is {
  hostname is String(1, 200) with {
    briefly "Hostname"
    described by "Device hostname."
  }
  ipAddress is String(1, 45) with {
    briefly "IP"
    described by "IP address."
  }
  macAddress is optional String(1, 17) with {
    briefly "MAC"
    described by "MAC address."
  }
  vendor is String(1, 100) with {
    briefly "Vendor"
    described by "Device vendor."
  }
  model is String(1, 100) with {
    briefly "Model"
    described by "Device model."
  }
  firmware is optional String(1, 50) with {
    briefly "Firmware"
    described by "Firmware version."
  }
  location is String(1, 200) with {
    briefly "Location"
    described by "Physical location."
  }
} with {
  briefly "Device info"
  described by "Device identification details."
}

type PerformanceMetrics is {
  cpuUtilization is Decimal(5, 2) with {
    briefly "CPU"
    described by "CPU utilization percent."
  }
  memoryUtilization is Decimal(5, 2) with {
    briefly "Memory"
    described by "Memory utilization percent."
  }
  bandwidth is Decimal(15, 2) with {
    briefly "Bandwidth"
    described by "Bandwidth usage Mbps."
  }
  packetLoss is Decimal(5, 4) with {
    briefly "Packet loss"
    described by "Packet loss percent."
  }
  latency is Decimal(8, 2) with {
    briefly "Latency"
    described by "Latency in ms."
  }
  uptime is Natural with {
    briefly "Uptime"
    described by "Uptime in seconds."
  }
  collectedAt is TimeStamp with {
    briefly "Collected"
    described by "Collection time."
  }
} with {
  briefly "Performance metrics"
  described by "Device performance data."
}

type InterfaceMetrics is {
  interfaceName is String(1, 100) with {
    briefly "Interface"
    described by "Interface name."
  }
  interfaceStatus is String(1, 20) with {
    briefly "Status"
    described by "Up or down."
  }
  inBytes is Natural with {
    briefly "In bytes"
    described by "Bytes received."
  }
  outBytes is Natural with {
    briefly "Out bytes"
    described by "Bytes transmitted."
  }
  inErrors is Natural with {
    briefly "In errors"
    described by "Receive errors."
  }
  outErrors is Natural with {
    briefly "Out errors"
    described by "Transmit errors."
  }
  utilization is Decimal(5, 2) with {
    briefly "Utilization"
    described by "Interface utilization."
  }
} with {
  briefly "Interface metrics"
  described by "Network interface statistics."
}

type Threshold is {
  metricName is String(1, 100) with {
    briefly "Metric"
    described by "Metric name."
  }
  warningLevel is Decimal(10, 2) with {
    briefly "Warning"
    described by "Warning threshold."
  }
  criticalLevel is Decimal(10, 2) with {
    briefly "Critical"
    described by "Critical threshold."
  }
  operator is String(1, 10) with {
    briefly "Operator"
    described by "gt, lt, eq, etc."
  }
  duration is Natural with {
    briefly "Duration"
    described by "Sustained seconds."
  }
} with {
  briefly "Threshold"
  described by "Alert threshold definition."
}

type AlertInfo is {
  alertId is AlertId with {
    briefly "Alert ID"
    described by "Alert identifier."
  }
  deviceId is DeviceId with {
    briefly "Device"
    described by "Source device."
  }
  severity is AlertSeverity with {
    briefly "Severity"
    described by "Alert severity."
  }
  alertStatus is AlertStatus with {
    briefly "Status"
    described by "Alert status."
  }
  message is String(1, 1000) with {
    briefly "Message"
    described by "Alert message."
  }
  triggeringMetricName is optional String(1, 100) with {
    briefly "Metric"
    described by "Triggering metric."
  }
  metricValue is optional Decimal(15, 4) with {
    briefly "Value"
    described by "Metric value."
  }
  triggeredAt is TimeStamp with {
    briefly "Triggered"
    described by "Alert trigger time."
  }
} with {
  briefly "Alert info"
  described by "Alert details."
}

type MaintenanceWindow is {
  windowId is UUID with {
    briefly "Window ID"
    described by "Maintenance window ID."
  }
  startTime is TimeStamp with {
    briefly "Start"
    described by "Window start."
  }
  endTime is TimeStamp with {
    briefly "End"
    described by "Window end."
  }
  reason is String(1, 500) with {
    briefly "Reason"
    described by "Maintenance reason."
  }
  suppressAlerts is Boolean with {
    briefly "Suppress"
    described by "Suppress alerts."
  }
} with {
  briefly "Maintenance window"
  described by "Scheduled maintenance period."
}

type TopologyLink is {
  sourceDevice is DeviceId with {
    briefly "Source"
    described by "Source device."
  }
  targetDevice is DeviceId with {
    briefly "Target"
    described by "Target device."
  }
  linkType is String(1, 50) with {
    briefly "Type"
    described by "Connection type."
  }
  bandwidth is Decimal(15, 2) with {
    briefly "Bandwidth"
    described by "Link bandwidth."
  }
  linkStatus is String(1, 20) with {
    briefly "Status"
    described by "Link status."
  }
} with {
  briefly "Topology link"
  described by "Network connection."
}
