// Revenue Assurance - Shared Types

type AuditCaseId is Id(RevenueAssuranceContext.AuditCase) with {
  briefly "Audit case identifier"
  described by "Unique identifier for an audit case."
}

type BillingRecordId is UUID with {
  briefly "Billing record identifier"
  described by "Reference to a billing record."
}

type UsageRecordId is UUID with {
  briefly "Usage record identifier"
  described by "Reference to a network usage record."
}

type CustomerId is UUID with {
  briefly "Customer identifier"
  described by "Reference to a customer account."
}

type ServiceId is UUID with {
  briefly "Service identifier"
  described by "Reference to a subscribed service."
}

type CaseStatus is any of {
  Opened,
  Investigating,
  Reconciling,
  Escalated,
  Resolved,
  Closed,
  Cancelled
} with {
  briefly "Case status"
  described by "Audit case lifecycle status."
}

type LeakageType is any of {
  Unbilled,
  Underbilled,
  Overbilled,
  DuplicateCharge,
  MissingDiscount,
  RatingError,
  NetworkMismatch
} with {
  briefly "Leakage type"
  described by "Classification of revenue leakage."
}

type CasePriority is any of {
  Low,
  Medium,
  High,
  Critical
} with {
  briefly "Case priority"
  described by "Audit case processing priority."
}

type ResolutionAction is any of {
  BillingCorrected,
  CreditIssued,
  ServiceCorrected,
  NoActionRequired,
  EscalatedToManagement
} with {
  briefly "Resolution action"
  described by "Action taken to resolve a case."
}

type AuditCaseInfo is {
  caseId is AuditCaseId with {
    briefly "Case ID"
    described by "Audit case identifier."
  }
  customerId is CustomerId with {
    briefly "Customer"
    described by "Affected customer identifier."
  }
  serviceId is ServiceId with {
    briefly "Service"
    described by "Affected service identifier."
  }
  leakageType is LeakageType with {
    briefly "Leakage type"
    described by "Type of revenue leakage detected."
  }
  priority is CasePriority with {
    briefly "Priority"
    described by "Case priority level."
  }
  description is String(1, 1000) with {
    briefly "Description"
    described by "Detailed description of the discrepancy."
  }
} with {
  briefly "Audit case info"
  described by "Core audit case details."
}

type BillingRecord is {
  billingRecordId is BillingRecordId with {
    briefly "Record ID"
    described by "Billing record identifier."
  }
  customerId is CustomerId with {
    briefly "Customer"
    described by "Customer identifier."
  }
  serviceId is ServiceId with {
    briefly "Service"
    described by "Service identifier."
  }
  billingPeriodStart is Date with {
    briefly "Period start"
    described by "Billing period start date."
  }
  billingPeriodEnd is Date with {
    briefly "Period end"
    described by "Billing period end date."
  }
  billedAmount is Decimal(12, 2) with {
    briefly "Billed amount"
    described by "Amount billed to customer."
  }
  billedUsage is Decimal(12, 2) with {
    briefly "Billed usage"
    described by "Usage quantity billed."
  }
  usageUnit is String(1, 50) with {
    briefly "Usage unit"
    described by "Unit of usage measurement."
  }
} with {
  briefly "Billing record"
  described by "Customer billing record for a period."
}

type UsageRecord is {
  usageRecordId is UsageRecordId with {
    briefly "Record ID"
    described by "Usage record identifier."
  }
  customerId is CustomerId with {
    briefly "Customer"
    described by "Customer identifier."
  }
  serviceId is ServiceId with {
    briefly "Service"
    described by "Service identifier."
  }
  usageStart is TimeStamp with {
    briefly "Usage start"
    described by "Usage session start time."
  }
  usageEnd is TimeStamp with {
    briefly "Usage end"
    described by "Usage session end time."
  }
  actualUsage is Decimal(12, 2) with {
    briefly "Actual usage"
    described by "Measured network usage quantity."
  }
  usageUnit is String(1, 50) with {
    briefly "Usage unit"
    described by "Unit of usage measurement."
  }
  networkElement is String(1, 100) with {
    briefly "Network element"
    described by "Source network element."
  }
} with {
  briefly "Usage record"
  described by "Network usage record from mediation."
}

type ReconciliationResult is {
  billingRecordId is BillingRecordId with {
    briefly "Billing record"
    described by "Reconciled billing record."
  }
  usageRecordId is UsageRecordId with {
    briefly "Usage record"
    described by "Reconciled usage record."
  }
  billedAmount is Decimal(12, 2) with {
    briefly "Billed"
    described by "Amount billed."
  }
  expectedAmount is Decimal(12, 2) with {
    briefly "Expected"
    described by "Expected amount based on usage."
  }
  variance is Decimal(12, 2) with {
    briefly "Variance"
    described by "Difference between billed and expected."
  }
  variancePercent is Decimal(5, 2) with {
    briefly "Variance percent"
    described by "Variance as percentage."
  }
  matched is Boolean with {
    briefly "Matched"
    described by "Whether records reconcile within threshold."
  }
} with {
  briefly "Reconciliation result"
  described by "Result of reconciling billing against usage."
}

type ResolutionDetails is {
  action is ResolutionAction with {
    briefly "Action"
    described by "Resolution action taken."
  }
  updatedAdjustmentAmount is optional Decimal(12, 2) with {
    briefly "Adjustment"
    described by "Financial adjustment amount."
  }
  notes is String(1, 2000) with {
    briefly "Notes"
    described by "Resolution notes and explanation."
  }
  resolvedBy is String(1, 100) with {
    briefly "Resolved by"
    described by "Person who resolved the case."
  }
} with {
  briefly "Resolution details"
  described by "Details of audit case resolution."
}
