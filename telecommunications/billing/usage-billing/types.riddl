// Types for the Usage Billing Domain

// === Identifier Types ===

type AccountId is Id(BillingContext.BillingAccount)
  briefly "Unique identifier for a billing account"
  described by "References a specific customer billing account in the system."

type UsageRecordId is Id(BillingContext.UsageRecord)
  briefly "Unique identifier for a usage record"
  described by "References a specific metered usage event captured from the network."

type InvoiceId is Id(BillingContext.Invoice)
  briefly "Unique identifier for an invoice"
  described by "References a specific invoice generated for a billing period."

type RatePlanId is String
  briefly "Identifier for a rate plan"
  described by "References the pricing plan applied to calculate charges."

type PaymentId is String
  briefly "Identifier for a payment transaction"
  described by "References a payment made against an invoice."

// === Enumeration Types ===

type UsageType is {
  Voice, Data, SMS, MMS, Roaming, International, Premium
} briefly "Categories of telecommunications usage"
  described by {
    | Defines the different types of usage that can be billed:
    | - Voice: Regular voice calls
    | - Data: Mobile or fixed data consumption
    | - SMS: Short message service
    | - MMS: Multimedia messaging service
    | - Roaming: Usage while on partner networks
    | - International: Cross-border communications
    | - Premium: Value-added services
  }

type InvoiceStatus is {
  Draft, Generated, Sent, Paid, PartiallyPaid, Overdue, Disputed, Cancelled
} briefly "Status of an invoice in its lifecycle"
  described by {
    | Tracks the current state of an invoice from creation through payment:
    | Draft indicates the invoice is being prepared, Generated means it is
    | ready for delivery, Sent indicates customer notification, and payment
    | states track the collection process.
  }

type AccountStatus is {
  Active, Suspended, Closed, PendingActivation
} briefly "Status of a billing account"
  described by {
    | Indicates the current operational state of a customer billing account.
    | Active accounts can incur usage, Suspended accounts are blocked due to
    | non-payment or other issues, and Closed accounts are no longer active.
  }

type PaymentMethod is {
  CreditCard, DebitCard, BankTransfer, DirectDebit, Check, Prepaid
} briefly "Supported payment methods"
  described by "The different ways customers can pay their invoices."

// === Value Types ===

type MonetaryAmount is {
  amount: Decimal,
  currency: String
} briefly "Represents a monetary value with currency"
  described by "Used for all financial amounts including charges, credits, and payments."

type Duration is Integer
  briefly "Duration in seconds"
  described by "Used to measure call duration for voice usage billing."

type DataVolume is Integer
  briefly "Data volume in bytes"
  described by "Used to measure data consumption for usage billing."

type PhoneNumber is Pattern("\\+?[1-9]\\d{1,14}")
  briefly "E.164 formatted phone number"
  described by "International phone number format for identifying calling parties."

// === Record Types ===

type UsageRecord is {
  recordId: UsageRecordId,
  accountId: AccountId,
  usageType: UsageType,
  startTime: DateTime,
  endTime: DateTime,
  duration: Duration,
  dataVolume: DataVolume,
  originatingNumber: PhoneNumber,
  terminatingNumber: PhoneNumber,
  networkElement: String,
  rated: Boolean,
  ratedAmount: MonetaryAmount
} briefly "A single usage event captured from the network"
  described by {
    | Represents a metered usage event such as a voice call, data session,
    | or message transmission. Contains all details needed for rating and
    | billing including timing, volume, and party information.
  }

type InvoiceLineItem is {
  description: String,
  usageType: UsageType,
  quantity: Number,
  unitPrice: MonetaryAmount,
  totalAmount: MonetaryAmount,
  usageRecordIds: many optional UsageRecordId
} briefly "A single line item on an invoice"
  described by {
    | Represents a billable item on a customer invoice, which may aggregate
    | multiple usage records or represent a fixed charge like a subscription fee.
  }

type Invoice is {
  invoiceId: InvoiceId,
  accountId: AccountId,
  billingPeriodStart: Date,
  billingPeriodEnd: Date,
  issueDate: Date,
  dueDate: Date,
  lineItems: many InvoiceLineItem,
  subtotal: MonetaryAmount,
  taxes: MonetaryAmount,
  totalAmount: MonetaryAmount,
  status: InvoiceStatus,
  paymentsMade: MonetaryAmount
} briefly "A customer invoice for a billing period"
  described by {
    | Contains all charges for a customer billing period including usage-based
    | charges, recurring fees, taxes, and payment tracking information.
  }

type RatePlan is {
  planId: RatePlanId,
  planName: String,
  voiceRatePerMinute: MonetaryAmount,
  dataRatePerMB: MonetaryAmount,
  smsRate: MonetaryAmount,
  mmsRate: MonetaryAmount,
  includedMinutes: Integer,
  includedDataMB: Integer,
  includedSMS: Integer,
  monthlyFee: MonetaryAmount,
  effectiveFrom: Date,
  effectiveTo: Date?
} briefly "Pricing plan defining rates for usage types"
  described by {
    | Defines the pricing structure applied to customer usage including
    | per-unit rates, included allowances, and recurring monthly fees.
  }

type CustomerInfo is {
  firstName: String,
  lastName: String,
  email: EmailAddress,
  phone: PhoneNumber,
  billingAddress: Address
} briefly "Customer contact and billing information"
  described by "Contains the customer details needed for invoicing and communication."

type Address is {
  street1: String,
  street2: String?,
  city: String,
  state: String,
  postalCode: String,
  country: String
} briefly "Physical mailing address"
  described by "Used for billing address and service location."

type PaymentRecord is {
  paymentId: PaymentId,
  invoiceId: InvoiceId,
  amount: MonetaryAmount,
  method: PaymentMethod,
  transactionDate: DateTime,
  referenceNumber: String,
  status: String
} briefly "Record of a payment transaction"
  described by "Tracks payments received against customer invoices."

type AccountSummary is {
  accountId: AccountId,
  customerName: String,
  currentBalance: MonetaryAmount,
  lastPaymentDate: Date?,
  lastPaymentAmount: MonetaryAmount?,
  accountStatus: AccountStatus,
  unbilledUsage: MonetaryAmount
} briefly "Summary view of account status"
  described by "Provides a quick overview of account health and current balances."
