// Account Management - External Contexts

// Customer Service
context CustomerService is {

  query GetCustomer is {
    customerId is CustomerId with { briefly "Customer" described by "Customer ID." }
  } with {
    briefly "Get customer"
    described by "Retrieves customer details."
  }

  event CustomerUpdated is {
    customerId is CustomerId with { briefly "Customer" described by "Customer ID." }
    updatedAt is TimeStamp with { briefly "Updated" described by "Update time." }
  } with {
    briefly "Customer was updated"
    described by "Emitted when customer changes."
  }

} with {
  option is external
  briefly "External customer service"
  described by "External customer management system."
}

// Fraud Detection Service
context FraudDetectionService is {

  command ScreenTransaction is {
    transactionId is TransactionId with { briefly "Transaction" described by "Transaction ID." }
    accountId is AccountId with { briefly "Account" described by "Account ID." }
    amount is Decimal(15, 2) with { briefly "Amount" described by "Transaction amount." }
  } with {
    briefly "Screen transaction"
    described by "Screens for fraud."
  }

  event TransactionScreened is {
    transactionId is TransactionId with { briefly "Transaction" described by "Transaction ID." }
    approved is Boolean with { briefly "Approved" described by "Is approved." }
    riskScore is Decimal(5, 4) with { briefly "Risk" described by "Risk score." }
  } with {
    briefly "Transaction was screened"
    described by "Emitted when screening completes."
  }

} with {
  option is external
  briefly "External fraud service"
  described by "External fraud detection system."
}

// Core Banking Service
context CoreBankingService is {

  command PostToLedger is {
    accountId is AccountId with { briefly "Account" described by "Account ID." }
    transactionId is TransactionId with { briefly "Transaction" described by "Transaction ID." }
    amount is Decimal(15, 2) with { briefly "Amount" described by "Amount." }
    debitCredit is String(1, 10) with { briefly "Type" described by "Debit or credit." }
  } with {
    briefly "Post to ledger"
    described by "Posts to general ledger."
  }

  event LedgerPosted is {
    transactionId is TransactionId with { briefly "Transaction" described by "Transaction ID." }
    postedAt is TimeStamp with { briefly "Posted" described by "Posting time." }
  } with {
    briefly "Ledger was posted"
    described by "Emitted when posting completes."
  }

} with {
  option is external
  briefly "External core banking"
  described by "External core banking system."
}

// Notification Service
context NotificationService is {

  command SendAccountNotification is {
    customerId is CustomerId with { briefly "Customer" described by "Customer ID." }
    accountId is AccountId with { briefly "Account" described by "Account ID." }
    notificationType is String(1, 50) with { briefly "Type" described by "Notification type." }
    message is String(1, 500) with { briefly "Message" described by "Message content." }
  } with {
    briefly "Send notification"
    described by "Sends account notification."
  }

  event NotificationSent is {
    notificationId is UUID with { briefly "Notification" described by "Notification ID." }
    sentAt is TimeStamp with { briefly "Sent" described by "Send time." }
  } with {
    briefly "Notification was sent"
    described by "Emitted when notification is delivered."
  }

} with {
  option is external
  briefly "External notification service"
  described by "External customer notification system."
}

// Regulatory Reporting Service
context RegulatoryService is {

  command ReportTransaction is {
    transactionId is TransactionId with { briefly "Transaction" described by "Transaction ID." }
    accountId is AccountId with { briefly "Account" described by "Account ID." }
    amount is Decimal(15, 2) with { briefly "Amount" described by "Transaction amount." }
    reportType is String(1, 50) with { briefly "Report" described by "Report type." }
  } with {
    briefly "Report transaction"
    described by "Reports to regulatory system."
  }

  event TransactionReported is {
    transactionId is TransactionId with { briefly "Transaction" described by "Transaction ID." }
    reportedAt is TimeStamp with { briefly "Reported" described by "Report time." }
  } with {
    briefly "Transaction was reported"
    described by "Emitted when reporting completes."
  }

} with {
  option is external
  briefly "External regulatory service"
  described by "External regulatory reporting system."
}
