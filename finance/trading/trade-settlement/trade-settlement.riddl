// Trade Settlement Domain Model
// Post-trade clearing and settlement processing

domain TradeSettlement is {

  author OssumInc is {
    name is "Ossum Inc."
    email is "support@ossum.ai"
  } with {
    briefly "Domain author"
    described by "Organization maintaining this domain model."
  }

  user SettlementOperator is "person managing settlement operations" with {
    briefly "Settlement Operator"
    described by "Person processing trade settlements."
  }

  user ReconciliationAnalyst is "person handling trade breaks" with {
    briefly "Reconciliation Analyst"
    described by "Person resolving settlement discrepancies."
  }

  user CustodianManager is "person managing custody relationships" with {
    briefly "Custodian Manager"
    described by "Person overseeing custodian interactions."
  }

  epic SettlementEpic is {
    user SettlementOperator wants "to settle trades efficiently"
      so that "positions and cash are exchanged correctly"

    case SettleTrade is {
      user SettlementOperator wants "to process a trade for settlement"
        so that "the transaction completes"
      step is "System receives" "executed trade details" "from OMS"
        with { briefly "Receive trade" described by "Get execution." }
      step is "System matches" "trade with counterparty" "for affirmation"
        with { briefly "Match trade" described by "Confirm details." }
      step send command SettlementContext.Settlement.InitiateSettlement from user SettlementOperator to entity SettlementContext.Settlement
        with { briefly "Initiate" described by "Start settlement." }
      step is "System delivers" "securities vs payment" "to custodian"
        with { briefly "DVP" described by "Deliver vs payment." }
    } with {
      briefly "Settlement workflow"
      described by "Standard trade settlement process."
    }
  } with {
    briefly "Trade settlement"
    described by {
      | Epic covering trade settlement from execution
      | through clearing, matching, and final settlement.
    }
  }

  include "SettlementContext.riddl"
  include "external-contexts.riddl"

} with {
  briefly "Trade settlement domain"
  described by {
    | The TradeSettlement domain handles post-trade processing
    | including clearing, matching, and DVP settlement.
  }
}
