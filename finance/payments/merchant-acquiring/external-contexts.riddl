// Merchant Acquiring - External Contexts

// Credit Bureau Service
context CreditBureauService is {

  command CheckBusinessCredit is {
    merchantId is MerchantId with { briefly "Merchant" described by "Merchant ID." }
    taxId is String(1, 20) with { briefly "Tax ID" described by "Business tax ID." }
    legalName is String(1, 200) with { briefly "Name" described by "Legal business name." }
  } with {
    briefly "Check business credit"
    described by "Requests business credit report."
  }

  event CreditReportReceived is {
    merchantId is MerchantId with { briefly "Merchant" described by "Merchant ID." }
    creditScore is Natural with { briefly "Score" described by "Business credit score." }
    reportDate is Date with { briefly "Report date" described by "Report date." }
  } with {
    briefly "Credit report received"
    described by "Emitted when credit report is returned."
  }

} with {
  option is external
  briefly "External credit bureau"
  described by "External business credit reporting."
}

// KYB Verification Service
context KYBService is {

  command VerifyBusiness is {
    merchantId is MerchantId with { briefly "Merchant" described by "Merchant ID." }
    business is BusinessInfo with { briefly "Business" described by "Business details." }
  } with {
    briefly "Verify business"
    described by "Initiates KYB verification."
  }

  event BusinessVerified is {
    merchantId is MerchantId with { briefly "Merchant" described by "Merchant ID." }
    verified is Boolean with { briefly "Verified" described by "Is verified." }
    findings is many optional String(1, 500) with { briefly "Findings" described by "Verification findings." }
  } with {
    briefly "Business verified"
    described by "Emitted when KYB completes."
  }

} with {
  option is external
  briefly "External KYB service"
  described by "External Know Your Business verification."
}

// MATCH List Service
context MATCHService is {

  command CheckMATCH is {
    merchantId is MerchantId with { briefly "Merchant" described by "Merchant ID." }
    ownerName is String(1, 100) with { briefly "Owner" described by "Owner name." }
    taxId is String(1, 20) with { briefly "Tax ID" described by "Tax identifier." }
  } with {
    briefly "Check MATCH list"
    described by "Checks terminated merchant list."
  }

  event MATCHResultReceived is {
    merchantId is MerchantId with { briefly "Merchant" described by "Merchant ID." }
    found is Boolean with { briefly "Found" described by "Found on MATCH." }
    matchReasonCode is optional String(1, 10) with { briefly "Reason" described by "MATCH reason code." }
  } with {
    briefly "MATCH result received"
    described by "Emitted when MATCH check completes."
  }

  command AddToMATCH is {
    merchantId is MerchantId with { briefly "Merchant" described by "Merchant ID." }
    reasonCode is String(1, 10) with { briefly "Reason" described by "Termination reason code." }
  } with {
    briefly "Add to MATCH"
    described by "Adds merchant to MATCH list."
  }

  event AddedToMATCH is {
    merchantId is MerchantId with { briefly "Merchant" described by "Merchant ID." }
    addedAt is TimeStamp with { briefly "Added" described by "When added." }
  } with {
    briefly "Added to MATCH"
    described by "Emitted when merchant added to MATCH."
  }

} with {
  option is external
  briefly "External MATCH service"
  described by "Mastercard Alert to Control High-risk Merchants."
}

// Processor Gateway Service
context ProcessorGatewayService is {

  command SetupMerchantAccount is {
    merchantId is MerchantId with { briefly "Merchant" described by "Merchant ID." }
    business is BusinessInfo with { briefly "Business" described by "Business details." }
    banking is BankingInfo with { briefly "Banking" described by "Settlement account." }
  } with {
    briefly "Setup merchant account"
    described by "Creates processor merchant account."
  }

  event MerchantAccountCreated is {
    merchantId is MerchantId with { briefly "Merchant" described by "Merchant ID." }
    processorMid is String(1, 50) with { briefly "Processor MID" described by "Processor merchant ID." }
    createdAt is TimeStamp with { briefly "Created" described by "Creation time." }
  } with {
    briefly "Merchant account created"
    described by "Emitted when processor account is ready."
  }

} with {
  option is external
  briefly "External processor gateway"
  described by "External payment processor integration."
}

// Document Storage Service
context DocumentStorageService is {

  command StoreDocument is {
    merchantId is MerchantId with { briefly "Merchant" described by "Merchant ID." }
    documentType is String(1, 50) with { briefly "Type" described by "Document type." }
    contentUrl is URL with { briefly "Content" described by "Document content URL." }
  } with {
    briefly "Store document"
    described by "Stores merchant document."
  }

  event DocumentStored is {
    documentId is UUID with { briefly "Document" described by "Document ID." }
    merchantId is MerchantId with { briefly "Merchant" described by "Merchant ID." }
    storedAt is TimeStamp with { briefly "Stored" described by "Storage time." }
  } with {
    briefly "Document stored"
    described by "Emitted when document is stored."
  }

} with {
  option is external
  briefly "External document storage"
  described by "External document management system."
}

// Notification Service
context NotificationService is {

  command SendMerchantNotification is {
    merchantId is MerchantId with { briefly "Merchant" described by "Merchant ID." }
    notificationType is String(1, 50) with { briefly "Type" described by "Notification type." }
    recipient is EmailAddress with { briefly "Recipient" described by "Email recipient." }
    message is String(1, 2000) with { briefly "Message" described by "Message content." }
  } with {
    briefly "Send notification"
    described by "Sends merchant notification."
  }

  event NotificationSent is {
    notificationId is UUID with { briefly "Notification" described by "Notification ID." }
    sentAt is TimeStamp with { briefly "Sent" described by "Send time." }
  } with {
    briefly "Notification sent"
    described by "Emitted when notification is delivered."
  }

} with {
  option is external
  briefly "External notification service"
  described by "External notification system."
}
