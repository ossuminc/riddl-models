// Merchant Acquiring - External Contexts
// Credit Bureau Service
context CreditBureauService is {
  command CheckBusinessCredit is  {
    merchantId: MerchantId with {
      briefly "Merchant"
      described as {
        |Merchant ID.
      }
    }
    taxId: String(1,20) with {
      briefly "Tax ID"
      described as {
        |Business tax ID.
      }
    }
    legalName: String(1,200) with {
      briefly "Name"
      described as {
        |Legal business name.
      }
    }
  } with {
    briefly "Check business credit"
    described as {
      |Requests business credit report.
    }
  }
  event CreditReportReceived is  {
    merchantId: MerchantId with {
      briefly "Merchant"
      described as {
        |Merchant ID.
      }
    }
    creditScore: Natural with {
      briefly "Score"
      described as {
        |Business credit score.
      }
    }
    reportDate: Date with {
      briefly "Report date"
      described as {
        |Report date.
      }
    }
  } with {
    briefly "Credit report received"
    described as {
      |Emitted when credit report is returned.
    }
  }
} with {
  option external()
  briefly "External credit bureau"
  described as {
    |External business credit reporting.
  }
}
// KYB Verification Service
context KYBService is {
  command VerifyBusiness is  {
    merchantId: MerchantId with {
      briefly "Merchant"
      described as {
        |Merchant ID.
      }
    }
    business: BusinessInfo with {
      briefly "Business"
      described as {
        |Business details.
      }
    }
  } with {
    briefly "Verify business"
    described as {
      |Initiates KYB verification.
    }
  }
  event BusinessVerified is  {
    merchantId: MerchantId with {
      briefly "Merchant"
      described as {
        |Merchant ID.
      }
    }
    verified: Boolean with {
      briefly "Verified"
      described as {
        |Is verified.
      }
    }
    findings: String(1,500)* with {
      briefly "Findings"
      described as {
        |Verification findings.
      }
    }
  } with {
    briefly "Business verified"
    described as {
      |Emitted when KYB completes.
    }
  }
} with {
  option external()
  briefly "External KYB service"
  described as {
    |External Know Your Business verification.
  }
}
// MATCH List Service
context MATCHService is {
  command CheckMATCH is  {
    merchantId: MerchantId with {
      briefly "Merchant"
      described as {
        |Merchant ID.
      }
    }
    ownerName: String(1,100) with {
      briefly "Owner"
      described as {
        |Owner name.
      }
    }
    taxId: String(1,20) with {
      briefly "Tax ID"
      described as {
        |Tax identifier.
      }
    }
  } with {
    briefly "Check MATCH list"
    described as {
      |Checks terminated merchant list.
    }
  }
  event MATCHResultReceived is  {
    merchantId: MerchantId with {
      briefly "Merchant"
      described as {
        |Merchant ID.
      }
    }
    found: Boolean with {
      briefly "Found"
      described as {
        |Found on MATCH.
      }
    }
    matchReasonCode: String(1,10)? with {
      briefly "Reason"
      described as {
        |MATCH reason code.
      }
    }
  } with {
    briefly "MATCH result received"
    described as {
      |Emitted when MATCH check completes.
    }
  }
  command AddToMATCH is  {
    merchantId: MerchantId with {
      briefly "Merchant"
      described as {
        |Merchant ID.
      }
    }
    reasonCode: String(1,10) with {
      briefly "Reason"
      described as {
        |Termination reason code.
      }
    }
  } with {
    briefly "Add to MATCH"
    described as {
      |Adds merchant to MATCH list.
    }
  }
  event AddedToMATCH is  {
    merchantId: MerchantId with {
      briefly "Merchant"
      described as {
        |Merchant ID.
      }
    }
    addedAt: TimeStamp with {
      briefly "Added"
      described as {
        |When added.
      }
    }
  } with {
    briefly "Added to MATCH"
    described as {
      |Emitted when merchant added to MATCH.
    }
  }
} with {
  option external()
  briefly "External MATCH service"
  described as {
    |Mastercard Alert to Control High-risk Merchants.
  }
}
// Processor Gateway Service
context ProcessorGatewayService is {
  command SetupMerchantAccount is  {
    merchantId: MerchantId with {
      briefly "Merchant"
      described as {
        |Merchant ID.
      }
    }
    business: BusinessInfo with {
      briefly "Business"
      described as {
        |Business details.
      }
    }
    banking: BankingInfo with {
      briefly "Banking"
      described as {
        |Settlement account.
      }
    }
  } with {
    briefly "Setup merchant account"
    described as {
      |Creates processor merchant account.
    }
  }
  event MerchantAccountCreated is  {
    merchantId: MerchantId with {
      briefly "Merchant"
      described as {
        |Merchant ID.
      }
    }
    processorMid: String(1,50) with {
      briefly "Processor MID"
      described as {
        |Processor merchant ID.
      }
    }
    createdAt: TimeStamp with {
      briefly "Created"
      described as {
        |Creation time.
      }
    }
  } with {
    briefly "Merchant account created"
    described as {
      |Emitted when processor account is ready.
    }
  }
} with {
  option external()
  briefly "External processor gateway"
  described as {
    |External payment processor integration.
  }
}
// Document Storage Service
context DocumentStorageService is {
  command StoreDocument is  {
    merchantId: MerchantId with {
      briefly "Merchant"
      described as {
        |Merchant ID.
      }
    }
    documentType: String(1,50) with {
      briefly "Type"
      described as {
        |Document type.
      }
    }
    contentUrl: URL with {
      briefly "Content"
      described as {
        |Document content URL.
      }
    }
  } with {
    briefly "Store document"
    described as {
      |Stores merchant document.
    }
  }
  event DocumentStored is  {
    documentId: UUID with {
      briefly "Document"
      described as {
        |Document ID.
      }
    }
    merchantId: MerchantId with {
      briefly "Merchant"
      described as {
        |Merchant ID.
      }
    }
    storedAt: TimeStamp with {
      briefly "Stored"
      described as {
        |Storage time.
      }
    }
  } with {
    briefly "Document stored"
    described as {
      |Emitted when document is stored.
    }
  }
} with {
  option external()
  briefly "External document storage"
  described as {
    |External document management system.
  }
}
// Notification Service
context NotificationService is {
  command SendMerchantNotification is  {
    merchantId: MerchantId with {
      briefly "Merchant"
      described as {
        |Merchant ID.
      }
    }
    notificationType: String(1,50) with {
      briefly "Type"
      described as {
        |Notification type.
      }
    }
    recipient: EmailAddress with {
      briefly "Recipient"
      described as {
        |Email recipient.
      }
    }
    message: String(1,2000) with {
      briefly "Message"
      described as {
        |Message content.
      }
    }
  } with {
    briefly "Send notification"
    described as {
      |Sends merchant notification.
    }
  }
  event NotificationSent is  {
    notificationId: UUID with {
      briefly "Notification"
      described as {
        |Notification ID.
      }
    }
    sentAt: TimeStamp with {
      briefly "Sent"
      described as {
        |Send time.
      }
    }
  } with {
    briefly "Notification sent"
    described as {
      |Emitted when notification is delivered.
    }
  }
} with {
  option external()
  briefly "External notification service"
  described as {
    |External notification system.
  }
}
