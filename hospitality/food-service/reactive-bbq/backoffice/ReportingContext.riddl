// Reporting bounded context - CQRS projectors only

context Reporting is {

  projector SalesReport is {

    record SalesReportEntry is {
      reportDate is Date with {
        briefly "Date"
        described by "Report date."
      }
      totalRevenue is Decimal(12, 2) with {
        briefly "Revenue"
        described by "Total revenue for the period."
      }
      dineInRevenue is Decimal(12, 2) with {
        briefly "Dine-in revenue"
        described by "Revenue from dine-in orders."
      }
      onlineRevenue is Decimal(12, 2) with {
        briefly "Online revenue"
        described by "Revenue from online orders."
      }
      orderCount is Natural with {
        briefly "Orders"
        described by "Total number of orders."
      }
      averageOrderValue is Decimal(10, 2) with {
        briefly "Average order"
        described by "Average order value."
      }
    } with {
      briefly "Sales report entry"
      described by "A single sales report data point."
    }

    handler SalesReportHandler is {
      on event Restaurant.FrontOfHouse.TableOrder.PaymentProcessed {
        prompt "Record dine-in sale in report"
      }
      on event Restaurant.OnlineOrdering.OnlineOrder.OnlinePaymentProcessed {
        prompt "Record online sale in report"
      }
    } with {
      briefly "Sales report handler"
      described by "Projects payment events into sales reports."
    }
  } with {
    briefly "Sales report projector"
    described by {
      | Builds sales reports from payment events across
      | dine-in and online channels. Isolated from production
      | so report generation never impacts peak-hour performance.
    }
  }

  projector LaborReport is {

    record LaborReportEntry is {
      laborReportDate is Date with {
        briefly "Date"
        described by "Report date."
      }
      totalHoursWorked is Decimal(8, 2) with {
        briefly "Hours"
        described by "Total hours worked."
      }
      shiftsCompleted is Natural with {
        briefly "Shifts"
        described by "Number of completed shifts."
      }
      shiftsCancelled is Natural with {
        briefly "Cancelled"
        described by "Number of cancelled shifts."
      }
      averageShiftDuration is Decimal(6, 2) with {
        briefly "Average duration"
        described by "Average shift duration in hours."
      }
    } with {
      briefly "Labor report entry"
      described by "A single labor report data point."
    }

    handler LaborReportHandler is {
      on event BackOffice.Scheduling.Shift.ClockedIn {
        prompt "Record shift start in labor report"
      }
      on event BackOffice.Scheduling.Shift.ClockedOut {
        prompt "Record shift end and calculate hours"
      }
      on event BackOffice.Scheduling.Shift.ShiftCancelled {
        prompt "Record shift cancellation"
      }
    } with {
      briefly "Labor report handler"
      described by "Projects scheduling events into labor reports."
    }
  } with {
    briefly "Labor report projector"
    described by "Builds labor reports from scheduling clock events."
  }

  projector InventoryReport is {

    record InventoryReportEntry is {
      inventoryReportDate is Date with {
        briefly "Date"
        described by "Report date."
      }
      totalItemsTracked is Natural with {
        briefly "Items tracked"
        described by "Total inventory items being tracked."
      }
      lowStockItems is Natural with {
        briefly "Low stock"
        described by "Number of items below reorder threshold."
      }
      outOfStockItems is Natural with {
        briefly "Out of stock"
        described by "Number of out-of-stock items."
      }
      totalStockValue is Decimal(14, 2) with {
        briefly "Stock value"
        described by "Estimated total stock value."
      }
    } with {
      briefly "Inventory report entry"
      described by "A single inventory report data point."
    }

    handler InventoryReportHandler is {
      on event BackOffice.Inventory.InventoryItem.StockReceived {
        prompt "Update inventory report with receipt"
      }
      on event BackOffice.Inventory.InventoryItem.StockConsumed {
        prompt "Update inventory report with consumption"
      }
      on event BackOffice.Inventory.InventoryItem.StockAdjusted {
        prompt "Update inventory report with adjustment"
      }
    } with {
      briefly "Inventory report handler"
      described by "Projects inventory events into reports."
    }
  } with {
    briefly "Inventory report projector"
    described by "Builds inventory reports from stock events."
  }

} with {
  briefly "Reporting context"
  described by {
    | CQRS read-model context containing projectors for
    | sales, labor, and inventory reports. Completely
    | isolated from production contexts so that report
    | generation never degrades peak-hour restaurant
    | performance. Addresses the CEO's concern about
    | reports slowing down operations.
  }
}
