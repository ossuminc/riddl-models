// Online Ordering bounded context
context OnlineOrdering is {
  include "online-types.riddl"
  include "OnlineOrder.riddl"
  repository OnlineOrderRepository is {
    schema OnlineOrderData is relational
      of onlineOrders as type OnlineOrder
        index on field OnlineOrder.onlineOrderId
        index on field OnlineOrder.customerId
        index on field OnlineOrder.onlineOrderStatus

    handler OnlineOrderPersistence is {
      on command OnlineOrder.BrowseMenu is {
        prompt "Create new online order session"
      }
      on command OnlineOrder.AddToCart is {
        prompt "Add item to cart"
      }
      on command OnlineOrder.RemoveFromCart is {
        prompt "Remove item from cart"
      }
      on command OnlineOrder.SelectFulfillment is {
        prompt "Store fulfillment selection"
      }
      on command OnlineOrder.SubmitOnlineOrder is {
        prompt "Mark order as submitted"
      }
      on command OnlineOrder.ProcessOnlinePayment is {
        prompt "Record payment"
      }
    } with {
      briefly "Online order persistence"
      described as {
        |Persists online order commands.
      }
    }
  } with {
    briefly "Online order repository"
    described as {
      |Stores and retrieves online order data.
    }
  }
  adaptor ToKitchen to context Restaurant.Kitchen is { 
    handler OnlineKitchenRouting is {
      on command Restaurant.Kitchen.KitchenTicket.ReceiveTicket is {
        prompt "Convert submitted online order into kitchen ticket"
      }
    } with {
      briefly "Kitchen routing"
      described as {
        |Routes online orders to the kitchen.
      }
    }
  } with {
    briefly "Kitchen adaptor"
    described as {
      |Sends submitted online orders to kitchen.
    }
  }
  adaptor ToDelivery to context Restaurant.Delivery is { 
    handler DeliveryRouting is {
      on command Restaurant.Delivery.DeliveryOrder.CreateDelivery is {
        prompt "Create delivery when delivery fulfillment is selected"
      }
    } with {
      briefly "Delivery routing"
      described as {
        |Routes delivery orders to the delivery context.
      }
    }
  } with {
    briefly "Delivery adaptor"
    described as {
      | Sends orders with delivery fulfillment to the
      | delivery context. This decoupling enables electronic
      | menus to operate independently of delivery.
    }
  }
  adaptor ToLoyalty to context Restaurant.Loyalty is { 
    handler OnlineLoyaltyRouting is {
      on command Restaurant.Loyalty.LoyaltyAccount.AccruePoints is {
        prompt "Send online payment event to loyalty for point accrual"
      }
    } with {
      briefly "Loyalty routing"
      described as {
        |Routes payment events for loyalty accrual.
      }
    }
  } with {
    briefly "Loyalty adaptor"
    described as {
      |Sends online payment events to loyalty context.
    }
  }
} with {
  briefly "Online ordering context"
  described as {
    | Manages the online ordering experience including menu
    | browsing, cart management, fulfillment selection, and
    | checkout. Decoupled from delivery context so electronic
    | menus can be developed independently. Communicates with
    | kitchen, delivery, and loyalty via adaptors.
  }
}
