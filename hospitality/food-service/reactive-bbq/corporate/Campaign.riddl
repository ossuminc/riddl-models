// Campaign entity for the Marketing context
entity Campaign is {
  // ---- Commands ----
  command CreateCampaign is  {
    campaignId: CampaignId with {
      briefly "ID"
      described as {
        |Identifier for the new campaign.
      }
    }
    campaignName: String(1,200) with {
      briefly "Name"
      described as {
        |Campaign name.
      }
    }
    campaignDescription: String(1,2000) with {
      briefly "Description"
      described as {
        |Campaign description and goals.
      }
    }
    campaignChannels: CampaignChannel+ with {
      briefly "Channels"
      described as {
        |Marketing channels for the campaign.
      }
    }
    campaignPromotion: CampaignPromotion? with {
      briefly "Promotion"
      described as {
        |Promotional offer if applicable.
      }
    }
  } with {
    briefly "Create campaign"
    described as {
      |Create a new marketing campaign.
    }
  }
  command ScheduleCampaign is  {
    campaignId: CampaignId with {
      briefly "ID"
      described as {
        |Campaign to schedule.
      }
    }
    campaignStartDate: Date with {
      briefly "Start date"
      described as {
        |Campaign start date.
      }
    }
    campaignEndDate: Date with {
      briefly "End date"
      described as {
        |Campaign end date.
      }
    }
  } with {
    briefly "Schedule campaign"
    described as {
      |Schedule the campaign for a date range.
    }
  }
  command LaunchCampaign is  {
    campaignId: CampaignId with {
      briefly "ID"
      described as {
        |Campaign to launch.
      }
    }
    launchedAt: TimeStamp with {
      briefly "Launched at"
      described as {
        |When the campaign was launched.
      }
    }
  } with {
    briefly "Launch campaign"
    described as {
      |Launch the campaign to make it live.
    }
  }
  command PauseCampaign is  {
    campaignId: CampaignId with {
      briefly "ID"
      described as {
        |Campaign to pause.
      }
    }
    pauseReason: String(1,500) with {
      briefly "Reason"
      described as {
        |Reason for pausing.
      }
    }
  } with {
    briefly "Pause campaign"
    described as {
      |Temporarily pause a live campaign.
    }
  }
  command EndCampaign is  {
    campaignId: CampaignId with {
      briefly "ID"
      described as {
        |Campaign to end.
      }
    }
    endedAt: TimeStamp with {
      briefly "Ended at"
      described as {
        |When the campaign ended.
      }
    }
  } with {
    briefly "End campaign"
    described as {
      |End the campaign.
    }
  }
  // ---- Events ----
  event CampaignCreated is  {
    campaignId: CampaignId with {
      briefly "ID"
      described as {
        |Campaign identifier.
      }
    }
    campaignName: String(1,200) with {
      briefly "Name"
      described as {
        |Campaign name.
      }
    }
    campaignChannels: CampaignChannel+ with {
      briefly "Channels"
      described as {
        |Marketing channels.
      }
    }
    campaignCreatedAt: TimeStamp with {
      briefly "Created at"
      described as {
        |When created.
      }
    }
  } with {
    briefly "Campaign created"
    described as {
      |Emitted when a new campaign is created.
    }
  }
  event CampaignScheduled is  {
    campaignId: CampaignId with {
      briefly "ID"
      described as {
        |Campaign identifier.
      }
    }
    campaignStartDate: Date with {
      briefly "Start date"
      described as {
        |Start date.
      }
    }
    campaignEndDate: Date with {
      briefly "End date"
      described as {
        |End date.
      }
    }
    campaignScheduledAt: TimeStamp with {
      briefly "Scheduled at"
      described as {
        |When scheduled.
      }
    }
  } with {
    briefly "Campaign scheduled"
    described as {
      |Emitted when a campaign is scheduled.
    }
  }
  event CampaignLaunched is  {
    campaignId: CampaignId with {
      briefly "ID"
      described as {
        |Campaign identifier.
      }
    }
    launchedAt: TimeStamp with {
      briefly "Launched at"
      described as {
        |When launched.
      }
    }
  } with {
    briefly "Campaign launched"
    described as {
      |Emitted when a campaign goes live.
    }
  }
  event CampaignPaused is  {
    campaignId: CampaignId with {
      briefly "ID"
      described as {
        |Campaign identifier.
      }
    }
    pauseReason: String(1,500) with {
      briefly "Reason"
      described as {
        |Pause reason.
      }
    }
    pausedAt: TimeStamp with {
      briefly "Paused at"
      described as {
        |When paused.
      }
    }
  } with {
    briefly "Campaign paused"
    described as {
      |Emitted when a live campaign is paused.
    }
  }
  event CampaignEnded is  {
    campaignId: CampaignId with {
      briefly "ID"
      described as {
        |Campaign identifier.
      }
    }
    endedAt: TimeStamp with {
      briefly "Ended at"
      described as {
        |When ended.
      }
    }
  } with {
    briefly "Campaign ended"
    described as {
      |Emitted when a campaign ends.
    }
  }
  // ---- State ----
  record CampaignStateData is  {
    campaignId: CampaignId with {
      briefly "ID"
      described as {
        |Campaign identifier.
      }
    }
    campaignName: String(1,200) with {
      briefly "Name"
      described as {
        |Campaign name.
      }
    }
    campaignDescription: String(1,2000) with {
      briefly "Description"
      described as {
        |Campaign description.
      }
    }
    campaignChannels: CampaignChannel+ with {
      briefly "Channels"
      described as {
        |Marketing channels.
      }
    }
    campaignPromotion: CampaignPromotion? with {
      briefly "Promotion"
      described as {
        |Promotional offer.
      }
    }
    campaignStatus: CampaignStatus with {
      briefly "Status"
      described as {
        |Current campaign status.
      }
    }
    scheduledStartDate: Date? with {
      briefly "Start date"
      described as {
        |Scheduled start date.
      }
    }
    scheduledEndDate: Date? with {
      briefly "End date"
      described as {
        |Scheduled end date.
      }
    }
    campaignCreatedAt: TimeStamp with {
      briefly "Created at"
      described as {
        |When created.
      }
    }
    actualLaunchedAt: TimeStamp? with {
      briefly "Launched at"
      described as {
        |When launched.
      }
    }
  } with {
    briefly "Campaign state data"
    described as {
      |Full state of a marketing campaign.
    }
  }
  state ActiveCampaign of type Campaign.CampaignStateData
  handler CampaignHandler is {
    on command CreateCampaign is {
      morph entity Marketing.Campaign to state Marketing.Campaign.ActiveCampaign with command CreateCampaign
      tell event CampaignCreated to entity Marketing.Campaign
    }
    on command ScheduleCampaign is {
      tell event CampaignScheduled to entity Marketing.Campaign
    }
    on command LaunchCampaign is {
      tell event CampaignLaunched to entity Marketing.Campaign
    }
    on command PauseCampaign is {
      tell event CampaignPaused to entity Marketing.Campaign
    }
    on command EndCampaign is {
      tell event CampaignEnded to entity Marketing.Campaign
    }
  } with {
    briefly "Campaign command handler"
    described as {
      |Processes campaign lifecycle commands.
    }
  }
} with {
  briefly "Campaign entity"
  described as {
    | Manages the lifecycle of a marketing campaign from
    | creation through scheduling, launch, pause, and
    | completion.
  }
}
