// Catering Management - External Contexts
// Menu Catalog Service
context MenuCatalogService is {
  query GetMenuItems is  {
    filterMealType: MealType? with {
      briefly "Meal type"
      described as {
        |Filter by meal type.
      }
    }
    dietaryRestrictions: DietaryRestriction* with {
      briefly "Dietary"
      described as {
        |Dietary filters.
      }
    }
  } with {
    briefly "Get menu items"
    described as {
      |Retrieves available menu items.
    }
  }
  result MenuCatalog is  {
    items: MenuItem+ with {
      briefly "Items"
      described as {
        |Available menu items.
      }
    }
  } with {
    briefly "Menu catalog"
    described as {
      |List of available items.
    }
  }
  query GetMenuItemDetails is  {
    itemId: MenuItemId with {
      briefly "Item"
      described as {
        |Menu item ID.
      }
    }
  } with {
    briefly "Get item details"
    described as {
      |Retrieves detailed menu item info.
    }
  }
  result MenuItemDetails is  {
    item: MenuItem with {
      briefly "Item"
      described as {
        |Menu item details.
      }
    }
    ingredients: String(1,100)+ with {
      briefly "Ingredients"
      described as {
        |Item ingredients.
      }
    }
    preparationTime: Duration with {
      briefly "Prep time"
      described as {
        |Preparation time.
      }
    }
    availability: Boolean with {
      briefly "Available"
      described as {
        |Currently available.
      }
    }
  } with {
    briefly "Menu item details"
    described as {
      |Full item information.
    }
  }
} with {
  option external()
  briefly "External menu catalog"
  described as {
    |External menu management service.
  }
}
// Inventory Service
context InventoryService is {
  query CheckIngredientAvailability is  {
    ingredients: String(1,100)+ with {
      briefly "Ingredients"
      described as {
        |Ingredients to check.
      }
    }
    quantity: Natural with {
      briefly "Quantity"
      described as {
        |Required quantity.
      }
    }
  } with {
    briefly "Check availability"
    described as {
      |Checks ingredient availability.
    }
  }
  result IngredientAvailability is  {
    available: Boolean with {
      briefly "Available"
      described as {
        |All ingredients available.
      }
    }
    shortages: String(1,100)* with {
      briefly "Shortages"
      described as {
        |Missing ingredients.
      }
    }
  } with {
    briefly "Ingredient availability"
    described as {
      |Availability status.
    }
  }
  command ReserveIngredients is  {
    orderId: OrderId with {
      briefly "Order"
      described as {
        |Order ID.
      }
    }
    ingredients: String(1,100)+ with {
      briefly "Ingredients"
      described as {
        |Ingredients to reserve.
      }
    }
    quantities: Natural+ with {
      briefly "Quantities"
      described as {
        |Required quantities.
      }
    }
  } with {
    briefly "Reserve ingredients"
    described as {
      |Reserves ingredients for order.
    }
  }
  event IngredientsReserved is  {
    orderId: OrderId with {
      briefly "Order"
      described as {
        |Order ID.
      }
    }
    reservedAt: TimeStamp with {
      briefly "Reserved"
      described as {
        |Reservation time.
      }
    }
  } with {
    briefly "Ingredients reserved"
    described as {
      |Emitted when ingredients are reserved.
    }
  }
} with {
  option external()
  briefly "External inventory"
  described as {
    |External inventory management service.
  }
}
// Pricing Service
context PricingService is {
  query CalculateOrderTotal is  {
    lineItems: OrderLineItem+ with {
      briefly "Items"
      described as {
        |Order items.
      }
    }
    guestCount: Natural with {
      briefly "Guests"
      described as {
        |Guest count.
      }
    }
    serviceType: ServiceType with {
      briefly "Service"
      described as {
        |Service type.
      }
    }
  } with {
    briefly "Calculate total"
    described as {
      |Calculates order total.
    }
  }
  result OrderPricing is  {
    subtotal: Decimal(10,2) with {
      briefly "Subtotal"
      described as {
        |Item subtotal.
      }
    }
    serviceCharge: Decimal(10,2) with {
      briefly "Service"
      described as {
        |Service charge.
      }
    }
    taxAmount: Decimal(10,2) with {
      briefly "Tax"
      described as {
        |Tax amount.
      }
    }
    depositRequired: Decimal(10,2) with {
      briefly "Deposit"
      described as {
        |Required deposit.
      }
    }
    totalAmount: Decimal(10,2) with {
      briefly "Total"
      described as {
        |Total amount.
      }
    }
  } with {
    briefly "Order pricing"
    described as {
      |Calculated pricing.
    }
  }
} with {
  option external()
  briefly "External pricing"
  described as {
    |External pricing calculation service.
  }
}
// Staff Scheduling Service
context StaffSchedulingService is {
  query GetAvailableStaff is  {
    eventDate: Date with {
      briefly "Date"
      described as {
        |Event date.
      }
    }
    eventTime: Time with {
      briefly "Time"
      described as {
        |Event time.
      }
    }
    roles: String(1,50)+ with {
      briefly "Roles"
      described as {
        |Required roles.
      }
    }
  } with {
    briefly "Get available staff"
    described as {
      |Retrieves available staff members.
    }
  }
  result AvailableStaff is  {
    staff: StaffAssignment+ with {
      briefly "Staff"
      described as {
        |Available staff.
      }
    }
  } with {
    briefly "Available staff"
    described as {
      |Staff available for event.
    }
  }
  command ScheduleStaff is  {
    orderId: OrderId with {
      briefly "Order"
      described as {
        |Order ID.
      }
    }
    assignments: StaffAssignment+ with {
      briefly "Assignments"
      described as {
        |Staff assignments.
      }
    }
  } with {
    briefly "Schedule staff"
    described as {
      |Schedules staff for event.
    }
  }
  event StaffScheduled is  {
    orderId: OrderId with {
      briefly "Order"
      described as {
        |Order ID.
      }
    }
    assignmentCount: Natural with {
      briefly "Count"
      described as {
        |Staff assigned count.
      }
    }
    scheduledAt: TimeStamp with {
      briefly "Scheduled"
      described as {
        |Scheduling time.
      }
    }
  } with {
    briefly "Staff scheduled"
    described as {
      |Emitted when staff is scheduled.
    }
  }
} with {
  option external()
  briefly "External staff scheduling"
  described as {
    |External staff scheduling service.
  }
}
// Delivery Service
context DeliveryService is {
  command ScheduleDelivery is  {
    orderId: OrderId with {
      briefly "Order"
      described as {
        |Order ID.
      }
    }
    delivery: DeliveryInfo with {
      briefly "Delivery"
      described as {
        |Delivery details.
      }
    }
  } with {
    briefly "Schedule delivery"
    described as {
      |Schedules order delivery.
    }
  }
  event DeliveryScheduled is  {
    orderId: OrderId with {
      briefly "Order"
      described as {
        |Order ID.
      }
    }
    scheduledTime: TimeStamp with {
      briefly "Scheduled"
      described as {
        |Scheduled delivery time.
      }
    }
  } with {
    briefly "Delivery scheduled"
    described as {
      |Emitted when delivery is scheduled.
    }
  }
  command UpdateDeliveryStatus is  {
    orderId: OrderId with {
      briefly "Order"
      described as {
        |Order ID.
      }
    }
    deliveryStatus: String(1,50) with {
      briefly "Status"
      described as {
        |Delivery status.
      }
    }
    location: String(1,200)? with {
      briefly "Location"
      described as {
        |Current location.
      }
    }
  } with {
    briefly "Update delivery status"
    described as {
      |Updates delivery tracking.
    }
  }
  event DeliveryStatusUpdated is  {
    orderId: OrderId with {
      briefly "Order"
      described as {
        |Order ID.
      }
    }
    deliveryStatus: String(1,50) with {
      briefly "Status"
      described as {
        |Current status.
      }
    }
    updatedAt: TimeStamp with {
      briefly "Updated"
      described as {
        |Update time.
      }
    }
  } with {
    briefly "Delivery status updated"
    described as {
      |Emitted when delivery status changes.
    }
  }
} with {
  option external()
  briefly "External delivery"
  described as {
    |External delivery logistics service.
  }
}
// Payment Processing Service
context PaymentProcessingService is {
  command ProcessPayment is  {
    orderId: OrderId with {
      briefly "Order"
      described as {
        |Order ID.
      }
    }
    amount: Decimal(10,2) with {
      briefly "Amount"
      described as {
        |Payment amount.
      }
    }
    paymentMethod: String(1,50) with {
      briefly "Method"
      described as {
        |Payment method.
      }
    }
    paymentToken: String(1,200) with {
      briefly "Token"
      described as {
        |Payment token.
      }
    }
  } with {
    briefly "Process payment"
    described as {
      |Processes payment for order.
    }
  }
  event PaymentProcessed is  {
    orderId: OrderId with {
      briefly "Order"
      described as {
        |Order ID.
      }
    }
    transactionId: String(1,100) with {
      briefly "Transaction"
      described as {
        |Transaction ID.
      }
    }
    amount: Decimal(10,2) with {
      briefly "Amount"
      described as {
        |Processed amount.
      }
    }
    processedAt: TimeStamp with {
      briefly "Processed"
      described as {
        |Processing time.
      }
    }
  } with {
    briefly "Payment processed"
    described as {
      |Emitted when payment is processed.
    }
  }
  event PaymentFailed is  {
    orderId: OrderId with {
      briefly "Order"
      described as {
        |Order ID.
      }
    }
    errorCode: String(1,50) with {
      briefly "Error"
      described as {
        |Error code.
      }
    }
    errorMessage: String(1,500) with {
      briefly "Message"
      described as {
        |Error message.
      }
    }
    failedAt: TimeStamp with {
      briefly "Failed"
      described as {
        |Failure time.
      }
    }
  } with {
    briefly "Payment failed"
    described as {
      |Emitted when payment fails.
    }
  }
  command ProcessRefund is  {
    orderId: OrderId with {
      briefly "Order"
      described as {
        |Order ID.
      }
    }
    amount: Decimal(10,2) with {
      briefly "Amount"
      described as {
        |Refund amount.
      }
    }
    reason: String(1,500) with {
      briefly "Reason"
      described as {
        |Refund reason.
      }
    }
  } with {
    briefly "Process refund"
    described as {
      |Processes refund for cancelled order.
    }
  }
  event RefundProcessed is  {
    orderId: OrderId with {
      briefly "Order"
      described as {
        |Order ID.
      }
    }
    amount: Decimal(10,2) with {
      briefly "Amount"
      described as {
        |Refund amount.
      }
    }
    processedAt: TimeStamp with {
      briefly "Processed"
      described as {
        |Processing time.
      }
    }
  } with {
    briefly "Refund processed"
    described as {
      |Emitted when refund is processed.
    }
  }
} with {
  option external()
  briefly "External payment processing"
  described as {
    |External payment processing service.
  }
}
// Notification Service
context NotificationService is {
  command SendOrderConfirmation is  {
    orderId: OrderId with {
      briefly "Order"
      described as {
        |Order ID.
      }
    }
    customerEmail: String(5,254) with {
      briefly "Email"
      described as {
        |Customer email.
      }
    }
    orderDetails: String(1,5000) with {
      briefly "Details"
      described as {
        |Order details.
      }
    }
  } with {
    briefly "Send confirmation"
    described as {
      |Sends order confirmation.
    }
  }
  event ConfirmationSent is  {
    orderId: OrderId with {
      briefly "Order"
      described as {
        |Order ID.
      }
    }
    sentAt: TimeStamp with {
      briefly "Sent"
      described as {
        |Send time.
      }
    }
  } with {
    briefly "Confirmation sent"
    described as {
      |Emitted when confirmation is sent.
    }
  }
  command SendDeliveryNotification is  {
    orderId: OrderId with {
      briefly "Order"
      described as {
        |Order ID.
      }
    }
    customerEmail: String(5,254) with {
      briefly "Email"
      described as {
        |Customer email.
      }
    }
    estimatedArrival: TimeStamp with {
      briefly "ETA"
      described as {
        |Estimated arrival.
      }
    }
  } with {
    briefly "Send delivery notification"
    described as {
      |Sends delivery notification.
    }
  }
  event DeliveryNotificationSent is  {
    orderId: OrderId with {
      briefly "Order"
      described as {
        |Order ID.
      }
    }
    sentAt: TimeStamp with {
      briefly "Sent"
      described as {
        |Send time.
      }
    }
  } with {
    briefly "Delivery notification sent"
    described as {
      |Emitted when notification is sent.
    }
  }
} with {
  option external()
  briefly "External notifications"
  described as {
    |External notification service.
  }
}
