// Venue Management - External Contexts
// Space Availability Service
context SpaceAvailabilityService is {
  query SearchAvailableSpaces is  {
    filterVenueId: VenueId? with {
      briefly "Venue"
      described as {
        |Venue filter.
      }
    }
    filterSpaceType: SpaceType? with {
      briefly "Type"
      described as {
        |Space type filter.
      }
    }
    startDateTime: TimeStamp with {
      briefly "Start"
      described as {
        |Start time.
      }
    }
    endDateTime: TimeStamp with {
      briefly "End"
      described as {
        |End time.
      }
    }
    minCapacity: Natural with {
      briefly "Capacity"
      described as {
        |Minimum capacity.
      }
    }
  } with {
    briefly "Search available spaces"
    described as {
      |Searches for available spaces.
    }
  }
  result AvailableSpaces is  {
    spaces: SpaceInfo+ with {
      briefly "Spaces"
      described as {
        |Available spaces.
      }
    }
  } with {
    briefly "Available spaces"
    described as {
      |List of available spaces.
    }
  }
  query CheckSpaceAvailability is  {
    spaceId: SpaceId with {
      briefly "Space"
      described as {
        |Space ID.
      }
    }
    startDateTime: TimeStamp with {
      briefly "Start"
      described as {
        |Start time.
      }
    }
    endDateTime: TimeStamp with {
      briefly "End"
      described as {
        |End time.
      }
    }
  } with {
    briefly "Check availability"
    described as {
      |Checks specific space availability.
    }
  }
  result SpaceAvailability is  {
    available: Boolean with {
      briefly "Available"
      described as {
        |Whether available.
      }
    }
    conflictingBookings: BookingId* with {
      briefly "Conflicts"
      described as {
        |Conflicting bookings.
      }
    }
  } with {
    briefly "Space availability"
    described as {
      |Availability check result.
    }
  }
  command ReserveSpace is  {
    spaceId: SpaceId with {
      briefly "Space"
      described as {
        |Space ID.
      }
    }
    bookingId: BookingId with {
      briefly "Booking"
      described as {
        |Booking ID.
      }
    }
    period: BookingPeriod with {
      briefly "Period"
      described as {
        |Reservation period.
      }
    }
  } with {
    briefly "Reserve space"
    described as {
      |Reserves space for booking.
    }
  }
  event SpaceReserved is  {
    spaceId: SpaceId with {
      briefly "Space"
      described as {
        |Space ID.
      }
    }
    bookingId: BookingId with {
      briefly "Booking"
      described as {
        |Booking ID.
      }
    }
    reservedAt: TimeStamp with {
      briefly "Reserved"
      described as {
        |Reservation time.
      }
    }
  } with {
    briefly "Space reserved"
    described as {
      |Emitted when space is reserved.
    }
  }
  command ReleaseSpace is  {
    spaceId: SpaceId with {
      briefly "Space"
      described as {
        |Space ID.
      }
    }
    bookingId: BookingId with {
      briefly "Booking"
      described as {
        |Booking ID.
      }
    }
  } with {
    briefly "Release space"
    described as {
      |Releases space reservation.
    }
  }
  event SpaceReleased is  {
    spaceId: SpaceId with {
      briefly "Space"
      described as {
        |Space ID.
      }
    }
    bookingId: BookingId with {
      briefly "Booking"
      described as {
        |Booking ID.
      }
    }
    releasedAt: TimeStamp with {
      briefly "Released"
      described as {
        |Release time.
      }
    }
  } with {
    briefly "Space released"
    described as {
      |Emitted when space is released.
    }
  }
} with {
  option external()
  briefly "External space availability"
  described as {
    |External availability service.
  }
}
// Resource Inventory Service
context ResourceInventoryService is {
  query GetAvailableResources is  {
    venueId: VenueId with {
      briefly "Venue"
      described as {
        |Venue ID.
      }
    }
    resourceType: String(1,50)? with {
      briefly "Type"
      described as {
        |Resource type.
      }
    }
    dateTime: TimeStamp with {
      briefly "Date"
      described as {
        |Availability date.
      }
    }
  } with {
    briefly "Get available resources"
    described as {
      |Retrieves available resources.
    }
  }
  result AvailableResources is  {
    resources: ResourceItem+ with {
      briefly "Resources"
      described as {
        |Available resources.
      }
    }
  } with {
    briefly "Available resources"
    described as {
      |List of available resources.
    }
  }
  command ReserveResources is  {
    bookingId: BookingId with {
      briefly "Booking"
      described as {
        |Booking ID.
      }
    }
    resources: ResourceItem+ with {
      briefly "Resources"
      described as {
        |Resources to reserve.
      }
    }
    period: BookingPeriod with {
      briefly "Period"
      described as {
        |Reservation period.
      }
    }
  } with {
    briefly "Reserve resources"
    described as {
      |Reserves resources for booking.
    }
  }
  event ResourcesReserved is  {
    bookingId: BookingId with {
      briefly "Booking"
      described as {
        |Booking ID.
      }
    }
    resourceCount: Natural with {
      briefly "Count"
      described as {
        |Resources reserved.
      }
    }
    reservedAt: TimeStamp with {
      briefly "Reserved"
      described as {
        |Reservation time.
      }
    }
  } with {
    briefly "Resources reserved"
    described as {
      |Emitted when resources are reserved.
    }
  }
  command ReleaseResources is  {
    bookingId: BookingId with {
      briefly "Booking"
      described as {
        |Booking ID.
      }
    }
  } with {
    briefly "Release resources"
    described as {
      |Releases reserved resources.
    }
  }
  event ResourcesReleased is  {
    bookingId: BookingId with {
      briefly "Booking"
      described as {
        |Booking ID.
      }
    }
    releasedAt: TimeStamp with {
      briefly "Released"
      described as {
        |Release time.
      }
    }
  } with {
    briefly "Resources released"
    described as {
      |Emitted when resources are released.
    }
  }
} with {
  option external()
  briefly "External resource inventory"
  described as {
    |External resource management service.
  }
}
// Catering Service
context CateringService is {
  query GetCateringPackages is  {
    venueId: VenueId with {
      briefly "Venue"
      described as {
        |Venue ID.
      }
    }
    filterEventType: EventType? with {
      briefly "Event type"
      described as {
        |Event type filter.
      }
    }
  } with {
    briefly "Get catering packages"
    described as {
      |Retrieves available packages.
    }
  }
  result CateringPackages is  {
    packages: CateringSelection+ with {
      briefly "Packages"
      described as {
        |Available packages.
      }
    }
  } with {
    briefly "Catering packages"
    described as {
      |List of catering options.
    }
  }
  command BookCatering is  {
    bookingId: BookingId with {
      briefly "Booking"
      described as {
        |Booking ID.
      }
    }
    catering: CateringSelection with {
      briefly "Catering"
      described as {
        |Catering selection.
      }
    }
    eventDate: Date with {
      briefly "Date"
      described as {
        |Event date.
      }
    }
  } with {
    briefly "Book catering"
    described as {
      |Books catering for event.
    }
  }
  event CateringBooked is  {
    bookingId: BookingId with {
      briefly "Booking"
      described as {
        |Booking ID.
      }
    }
    totalAmount: Decimal(10,2) with {
      briefly "Amount"
      described as {
        |Catering amount.
      }
    }
    bookedAt: TimeStamp with {
      briefly "Booked"
      described as {
        |Booking time.
      }
    }
  } with {
    briefly "Catering booked"
    described as {
      |Emitted when catering is booked.
    }
  }
  command CancelCatering is  {
    bookingId: BookingId with {
      briefly "Booking"
      described as {
        |Booking ID.
      }
    }
  } with {
    briefly "Cancel catering"
    described as {
      |Cancels catering booking.
    }
  }
  event CateringCancelled is  {
    bookingId: BookingId with {
      briefly "Booking"
      described as {
        |Booking ID.
      }
    }
    cancelledAt: TimeStamp with {
      briefly "Cancelled"
      described as {
        |Cancellation time.
      }
    }
  } with {
    briefly "Catering cancelled"
    described as {
      |Emitted when catering is cancelled.
    }
  }
} with {
  option external()
  briefly "External catering service"
  described as {
    |External catering management.
  }
}
// Pricing Service
context PricingService is {
  query CalculateBookingPrice is  {
    space: SpaceInfo with {
      briefly "Space"
      described as {
        |Space info.
      }
    }
    period: BookingPeriod with {
      briefly "Period"
      described as {
        |Booking period.
      }
    }
    estimateResources: ResourceItem* with {
      briefly "Resources"
      described as {
        |Resources.
      }
    }
    estimateCatering: CateringSelection? with {
      briefly "Catering"
      described as {
        |Catering.
      }
    }
  } with {
    briefly "Calculate price"
    described as {
      |Calculates booking price.
    }
  }
  result BookingPrice is  {
    pricing: BookingPricing with {
      briefly "Pricing"
      described as {
        |Pricing details.
      }
    }
  } with {
    briefly "Booking price"
    described as {
      |Calculated pricing.
    }
  }
} with {
  option external()
  briefly "External pricing service"
  described as {
    |External pricing calculation.
  }
}
// Payment Processing Service
context PaymentProcessingService is {
  command ProcessPayment is  {
    bookingId: BookingId with {
      briefly "Booking"
      described as {
        |Booking ID.
      }
    }
    amount: Decimal(10,2) with {
      briefly "Amount"
      described as {
        |Payment amount.
      }
    }
    paymentMethod: String(1,50) with {
      briefly "Method"
      described as {
        |Payment method.
      }
    }
    paymentToken: String(1,200) with {
      briefly "Token"
      described as {
        |Payment token.
      }
    }
  } with {
    briefly "Process payment"
    described as {
      |Processes payment.
    }
  }
  event PaymentProcessed is  {
    bookingId: BookingId with {
      briefly "Booking"
      described as {
        |Booking ID.
      }
    }
    transactionId: String(1,100) with {
      briefly "Transaction"
      described as {
        |Transaction ID.
      }
    }
    amount: Decimal(10,2) with {
      briefly "Amount"
      described as {
        |Amount processed.
      }
    }
    processedAt: TimeStamp with {
      briefly "Processed"
      described as {
        |Process time.
      }
    }
  } with {
    briefly "Payment processed"
    described as {
      |Emitted when payment succeeds.
    }
  }
  event PaymentFailed is  {
    bookingId: BookingId with {
      briefly "Booking"
      described as {
        |Booking ID.
      }
    }
    errorCode: String(1,50) with {
      briefly "Error"
      described as {
        |Error code.
      }
    }
    errorMessage: String(1,500) with {
      briefly "Message"
      described as {
        |Error message.
      }
    }
    failedAt: TimeStamp with {
      briefly "Failed"
      described as {
        |Failure time.
      }
    }
  } with {
    briefly "Payment failed"
    described as {
      |Emitted when payment fails.
    }
  }
  command ProcessRefund is  {
    bookingId: BookingId with {
      briefly "Booking"
      described as {
        |Booking ID.
      }
    }
    amount: Decimal(10,2) with {
      briefly "Amount"
      described as {
        |Refund amount.
      }
    }
    reason: String(1,500) with {
      briefly "Reason"
      described as {
        |Refund reason.
      }
    }
  } with {
    briefly "Process refund"
    described as {
      |Processes refund.
    }
  }
  event RefundProcessed is  {
    bookingId: BookingId with {
      briefly "Booking"
      described as {
        |Booking ID.
      }
    }
    refundId: String(1,100) with {
      briefly "Refund"
      described as {
        |Refund ID.
      }
    }
    amount: Decimal(10,2) with {
      briefly "Amount"
      described as {
        |Refund amount.
      }
    }
    processedAt: TimeStamp with {
      briefly "Processed"
      described as {
        |Process time.
      }
    }
  } with {
    briefly "Refund processed"
    described as {
      |Emitted when refund is processed.
    }
  }
} with {
  option external()
  briefly "External payment processing"
  described as {
    |External payment service.
  }
}
// Notification Service
context NotificationService is {
  command SendBookingConfirmation is  {
    bookingId: BookingId with {
      briefly "Booking"
      described as {
        |Booking ID.
      }
    }
    customerEmail: String(5,254) with {
      briefly "Email"
      described as {
        |Customer email.
      }
    }
    bookingDetails: String(1,5000) with {
      briefly "Details"
      described as {
        |Booking details.
      }
    }
  } with {
    briefly "Send confirmation"
    described as {
      |Sends booking confirmation.
    }
  }
  event ConfirmationSent is  {
    bookingId: BookingId with {
      briefly "Booking"
      described as {
        |Booking ID.
      }
    }
    sentAt: TimeStamp with {
      briefly "Sent"
      described as {
        |Send time.
      }
    }
  } with {
    briefly "Confirmation sent"
    described as {
      |Emitted when confirmation is sent.
    }
  }
  command SendEventReminder is  {
    bookingId: BookingId with {
      briefly "Booking"
      described as {
        |Booking ID.
      }
    }
    customerEmail: String(5,254) with {
      briefly "Email"
      described as {
        |Customer email.
      }
    }
    daysUntilEvent: Natural with {
      briefly "Days"
      described as {
        |Days until event.
      }
    }
  } with {
    briefly "Send reminder"
    described as {
      |Sends event reminder.
    }
  }
  event ReminderSent is  {
    bookingId: BookingId with {
      briefly "Booking"
      described as {
        |Booking ID.
      }
    }
    sentAt: TimeStamp with {
      briefly "Sent"
      described as {
        |Send time.
      }
    }
  } with {
    briefly "Reminder sent"
    described as {
      |Emitted when reminder is sent.
    }
  }
} with {
  option external()
  briefly "External notifications"
  described as {
    |External notification service.
  }
}
// Facilities Management Service
context FacilitiesManagementService is {
  command ScheduleSetup is  {
    bookingId: BookingId with {
      briefly "Booking"
      described as {
        |Booking ID.
      }
    }
    spaceId: SpaceId with {
      briefly "Space"
      described as {
        |Space ID.
      }
    }
    setupStyle: SetupStyle with {
      briefly "Setup"
      described as {
        |Setup style.
      }
    }
    scheduledSetupTime: TimeStamp with {
      briefly "Time"
      described as {
        |Setup time.
      }
    }
  } with {
    briefly "Schedule setup"
    described as {
      |Schedules room setup.
    }
  }
  event SetupScheduled is  {
    bookingId: BookingId with {
      briefly "Booking"
      described as {
        |Booking ID.
      }
    }
    scheduledFor: TimeStamp with {
      briefly "Scheduled"
      described as {
        |Scheduled time.
      }
    }
  } with {
    briefly "Setup scheduled"
    described as {
      |Emitted when setup is scheduled.
    }
  }
  command ScheduleTeardown is  {
    bookingId: BookingId with {
      briefly "Booking"
      described as {
        |Booking ID.
      }
    }
    spaceId: SpaceId with {
      briefly "Space"
      described as {
        |Space ID.
      }
    }
    scheduledTeardownTime: TimeStamp with {
      briefly "Time"
      described as {
        |Teardown time.
      }
    }
  } with {
    briefly "Schedule teardown"
    described as {
      |Schedules room teardown.
    }
  }
  event TeardownScheduled is  {
    bookingId: BookingId with {
      briefly "Booking"
      described as {
        |Booking ID.
      }
    }
    scheduledFor: TimeStamp with {
      briefly "Scheduled"
      described as {
        |Scheduled time.
      }
    }
  } with {
    briefly "Teardown scheduled"
    described as {
      |Emitted when teardown is scheduled.
    }
  }
} with {
  option external()
  briefly "External facilities management"
  described as {
    |External facilities service.
  }
}
