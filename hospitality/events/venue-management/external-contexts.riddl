// Venue Management - External Contexts

// Space Availability Service
context SpaceAvailabilityService is {

  query SearchAvailableSpaces is {
    venueId is optional VenueId with { briefly "Venue" described by "Venue filter." }
    spaceType is optional SpaceType with { briefly "Type" described by "Space type filter." }
    startDateTime is TimeStamp with { briefly "Start" described by "Start time." }
    endDateTime is TimeStamp with { briefly "End" described by "End time." }
    minCapacity is Natural with { briefly "Capacity" described by "Minimum capacity." }
  } with {
    briefly "Search available spaces"
    described by "Searches for available spaces."
  }

  result AvailableSpaces is {
    spaces is many SpaceInfo with { briefly "Spaces" described by "Available spaces." }
  } with {
    briefly "Available spaces"
    described by "List of available spaces."
  }

  query CheckSpaceAvailability is {
    spaceId is SpaceId with { briefly "Space" described by "Space ID." }
    startDateTime is TimeStamp with { briefly "Start" described by "Start time." }
    endDateTime is TimeStamp with { briefly "End" described by "End time." }
  } with {
    briefly "Check availability"
    described by "Checks specific space availability."
  }

  result SpaceAvailability is {
    available is Boolean with { briefly "Available" described by "Whether available." }
    conflictingBookings is many optional BookingId with { briefly "Conflicts" described by "Conflicting bookings." }
  } with {
    briefly "Space availability"
    described by "Availability check result."
  }

  command ReserveSpace is {
    spaceId is SpaceId with { briefly "Space" described by "Space ID." }
    bookingId is BookingId with { briefly "Booking" described by "Booking ID." }
    period is BookingPeriod with { briefly "Period" described by "Reservation period." }
  } with {
    briefly "Reserve space"
    described by "Reserves space for booking."
  }

  event SpaceReserved is {
    spaceId is SpaceId with { briefly "Space" described by "Space ID." }
    bookingId is BookingId with { briefly "Booking" described by "Booking ID." }
    reservedAt is TimeStamp with { briefly "Reserved" described by "Reservation time." }
  } with {
    briefly "Space reserved"
    described by "Emitted when space is reserved."
  }

  command ReleaseSpace is {
    spaceId is SpaceId with { briefly "Space" described by "Space ID." }
    bookingId is BookingId with { briefly "Booking" described by "Booking ID." }
  } with {
    briefly "Release space"
    described by "Releases space reservation."
  }

  event SpaceReleased is {
    spaceId is SpaceId with { briefly "Space" described by "Space ID." }
    bookingId is BookingId with { briefly "Booking" described by "Booking ID." }
    releasedAt is TimeStamp with { briefly "Released" described by "Release time." }
  } with {
    briefly "Space released"
    described by "Emitted when space is released."
  }

} with {
  option is external
  briefly "External space availability"
  described by "External availability service."
}

// Resource Inventory Service
context ResourceInventoryService is {

  query GetAvailableResources is {
    venueId is VenueId with { briefly "Venue" described by "Venue ID." }
    resourceType is optional String(1, 50) with { briefly "Type" described by "Resource type." }
    dateTime is TimeStamp with { briefly "Date" described by "Availability date." }
  } with {
    briefly "Get available resources"
    described by "Retrieves available resources."
  }

  result AvailableResources is {
    resources is many ResourceItem with { briefly "Resources" described by "Available resources." }
  } with {
    briefly "Available resources"
    described by "List of available resources."
  }

  command ReserveResources is {
    bookingId is BookingId with { briefly "Booking" described by "Booking ID." }
    resources is many ResourceItem with { briefly "Resources" described by "Resources to reserve." }
    period is BookingPeriod with { briefly "Period" described by "Reservation period." }
  } with {
    briefly "Reserve resources"
    described by "Reserves resources for booking."
  }

  event ResourcesReserved is {
    bookingId is BookingId with { briefly "Booking" described by "Booking ID." }
    resourceCount is Natural with { briefly "Count" described by "Resources reserved." }
    reservedAt is TimeStamp with { briefly "Reserved" described by "Reservation time." }
  } with {
    briefly "Resources reserved"
    described by "Emitted when resources are reserved."
  }

  command ReleaseResources is {
    bookingId is BookingId with { briefly "Booking" described by "Booking ID." }
  } with {
    briefly "Release resources"
    described by "Releases reserved resources."
  }

  event ResourcesReleased is {
    bookingId is BookingId with { briefly "Booking" described by "Booking ID." }
    releasedAt is TimeStamp with { briefly "Released" described by "Release time." }
  } with {
    briefly "Resources released"
    described by "Emitted when resources are released."
  }

} with {
  option is external
  briefly "External resource inventory"
  described by "External resource management service."
}

// Catering Service
context CateringService is {

  query GetCateringPackages is {
    venueId is VenueId with { briefly "Venue" described by "Venue ID." }
    eventType is optional EventType with { briefly "Event type" described by "Event type filter." }
  } with {
    briefly "Get catering packages"
    described by "Retrieves available packages."
  }

  result CateringPackages is {
    packages is many CateringSelection with { briefly "Packages" described by "Available packages." }
  } with {
    briefly "Catering packages"
    described by "List of catering options."
  }

  command BookCatering is {
    bookingId is BookingId with { briefly "Booking" described by "Booking ID." }
    catering is CateringSelection with { briefly "Catering" described by "Catering selection." }
    eventDate is Date with { briefly "Date" described by "Event date." }
  } with {
    briefly "Book catering"
    described by "Books catering for event."
  }

  event CateringBooked is {
    bookingId is BookingId with { briefly "Booking" described by "Booking ID." }
    totalAmount is Decimal(10, 2) with { briefly "Amount" described by "Catering amount." }
    bookedAt is TimeStamp with { briefly "Booked" described by "Booking time." }
  } with {
    briefly "Catering booked"
    described by "Emitted when catering is booked."
  }

  command CancelCatering is {
    bookingId is BookingId with { briefly "Booking" described by "Booking ID." }
  } with {
    briefly "Cancel catering"
    described by "Cancels catering booking."
  }

  event CateringCancelled is {
    bookingId is BookingId with { briefly "Booking" described by "Booking ID." }
    cancelledAt is TimeStamp with { briefly "Cancelled" described by "Cancellation time." }
  } with {
    briefly "Catering cancelled"
    described by "Emitted when catering is cancelled."
  }

} with {
  option is external
  briefly "External catering service"
  described by "External catering management."
}

// Pricing Service
context PricingService is {

  query CalculateBookingPrice is {
    space is SpaceInfo with { briefly "Space" described by "Space info." }
    period is BookingPeriod with { briefly "Period" described by "Booking period." }
    resources is many optional ResourceItem with { briefly "Resources" described by "Resources." }
    catering is optional CateringSelection with { briefly "Catering" described by "Catering." }
  } with {
    briefly "Calculate price"
    described by "Calculates booking price."
  }

  result BookingPrice is {
    pricing is BookingPricing with { briefly "Pricing" described by "Pricing details." }
  } with {
    briefly "Booking price"
    described by "Calculated pricing."
  }

} with {
  option is external
  briefly "External pricing service"
  described by "External pricing calculation."
}

// Payment Processing Service
context PaymentProcessingService is {

  command ProcessPayment is {
    bookingId is BookingId with { briefly "Booking" described by "Booking ID." }
    amount is Decimal(10, 2) with { briefly "Amount" described by "Payment amount." }
    paymentMethod is String(1, 50) with { briefly "Method" described by "Payment method." }
    paymentToken is String(1, 200) with { briefly "Token" described by "Payment token." }
  } with {
    briefly "Process payment"
    described by "Processes payment."
  }

  event PaymentProcessed is {
    bookingId is BookingId with { briefly "Booking" described by "Booking ID." }
    transactionId is String(1, 100) with { briefly "Transaction" described by "Transaction ID." }
    amount is Decimal(10, 2) with { briefly "Amount" described by "Amount processed." }
    processedAt is TimeStamp with { briefly "Processed" described by "Process time." }
  } with {
    briefly "Payment processed"
    described by "Emitted when payment succeeds."
  }

  event PaymentFailed is {
    bookingId is BookingId with { briefly "Booking" described by "Booking ID." }
    errorCode is String(1, 50) with { briefly "Error" described by "Error code." }
    errorMessage is String(1, 500) with { briefly "Message" described by "Error message." }
    failedAt is TimeStamp with { briefly "Failed" described by "Failure time." }
  } with {
    briefly "Payment failed"
    described by "Emitted when payment fails."
  }

  command ProcessRefund is {
    bookingId is BookingId with { briefly "Booking" described by "Booking ID." }
    amount is Decimal(10, 2) with { briefly "Amount" described by "Refund amount." }
    reason is String(1, 500) with { briefly "Reason" described by "Refund reason." }
  } with {
    briefly "Process refund"
    described by "Processes refund."
  }

  event RefundProcessed is {
    bookingId is BookingId with { briefly "Booking" described by "Booking ID." }
    refundId is String(1, 100) with { briefly "Refund" described by "Refund ID." }
    amount is Decimal(10, 2) with { briefly "Amount" described by "Refund amount." }
    processedAt is TimeStamp with { briefly "Processed" described by "Process time." }
  } with {
    briefly "Refund processed"
    described by "Emitted when refund is processed."
  }

} with {
  option is external
  briefly "External payment processing"
  described by "External payment service."
}

// Notification Service
context NotificationService is {

  command SendBookingConfirmation is {
    bookingId is BookingId with { briefly "Booking" described by "Booking ID." }
    customerEmail is String(5, 254) with { briefly "Email" described by "Customer email." }
    bookingDetails is String(1, 5000) with { briefly "Details" described by "Booking details." }
  } with {
    briefly "Send confirmation"
    described by "Sends booking confirmation."
  }

  event ConfirmationSent is {
    bookingId is BookingId with { briefly "Booking" described by "Booking ID." }
    sentAt is TimeStamp with { briefly "Sent" described by "Send time." }
  } with {
    briefly "Confirmation sent"
    described by "Emitted when confirmation is sent."
  }

  command SendEventReminder is {
    bookingId is BookingId with { briefly "Booking" described by "Booking ID." }
    customerEmail is String(5, 254) with { briefly "Email" described by "Customer email." }
    daysUntilEvent is Natural with { briefly "Days" described by "Days until event." }
  } with {
    briefly "Send reminder"
    described by "Sends event reminder."
  }

  event ReminderSent is {
    bookingId is BookingId with { briefly "Booking" described by "Booking ID." }
    sentAt is TimeStamp with { briefly "Sent" described by "Send time." }
  } with {
    briefly "Reminder sent"
    described by "Emitted when reminder is sent."
  }

} with {
  option is external
  briefly "External notifications"
  described by "External notification service."
}

// Facilities Management Service
context FacilitiesManagementService is {

  command ScheduleSetup is {
    bookingId is BookingId with { briefly "Booking" described by "Booking ID." }
    spaceId is SpaceId with { briefly "Space" described by "Space ID." }
    setupStyle is SetupStyle with { briefly "Setup" described by "Setup style." }
    setupTime is TimeStamp with { briefly "Time" described by "Setup time." }
  } with {
    briefly "Schedule setup"
    described by "Schedules room setup."
  }

  event SetupScheduled is {
    bookingId is BookingId with { briefly "Booking" described by "Booking ID." }
    scheduledFor is TimeStamp with { briefly "Scheduled" described by "Scheduled time." }
  } with {
    briefly "Setup scheduled"
    described by "Emitted when setup is scheduled."
  }

  command ScheduleTeardown is {
    bookingId is BookingId with { briefly "Booking" described by "Booking ID." }
    spaceId is SpaceId with { briefly "Space" described by "Space ID." }
    teardownTime is TimeStamp with { briefly "Time" described by "Teardown time." }
  } with {
    briefly "Schedule teardown"
    described by "Schedules room teardown."
  }

  event TeardownScheduled is {
    bookingId is BookingId with { briefly "Booking" described by "Booking ID." }
    scheduledFor is TimeStamp with { briefly "Scheduled" described by "Scheduled time." }
  } with {
    briefly "Teardown scheduled"
    described by "Emitted when teardown is scheduled."
  }

} with {
  option is external
  briefly "External facilities management"
  described by "External facilities service."
}
