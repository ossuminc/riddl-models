// Hotel Reservations - External Contexts
// Channel Manager Service
context ChannelManagerService is {
  command SyncAvailability is  {
    propertyId: PropertyId with {
      briefly "Property"
      described as {
        |Property ID.
      }
    }
    roomType: RoomType with {
      briefly "Room type"
      described as {
        |Room type.
      }
    }
    date: Date with {
      briefly "Date"
      described as {
        |Date to sync.
      }
    }
    available: Natural with {
      briefly "Available"
      described as {
        |Available count.
      }
    }
  } with {
    briefly "Sync availability"
    described as {
      |Syncs availability to channels.
    }
  }
  event AvailabilitySynced is  {
    propertyId: PropertyId with {
      briefly "Property"
      described as {
        |Property ID.
      }
    }
    channels: String(1,50)+ with {
      briefly "Channels"
      described as {
        |Synced channels.
      }
    }
    syncedAt: TimeStamp with {
      briefly "Synced"
      described as {
        |Sync time.
      }
    }
  } with {
    briefly "Availability synced"
    described as {
      |Emitted when availability is synced.
    }
  }
  command SyncRates is  {
    propertyId: PropertyId with {
      briefly "Property"
      described as {
        |Property ID.
      }
    }
    roomType: RoomType with {
      briefly "Room type"
      described as {
        |Room type.
      }
    }
    date: Date with {
      briefly "Date"
      described as {
        |Rate date.
      }
    }
    rate: Decimal(10,2) with {
      briefly "Rate"
      described as {
        |Nightly rate.
      }
    }
  } with {
    briefly "Sync rates"
    described as {
      |Syncs rates to channels.
    }
  }
  event RatesSynced is  {
    propertyId: PropertyId with {
      briefly "Property"
      described as {
        |Property ID.
      }
    }
    channels: String(1,50)+ with {
      briefly "Channels"
      described as {
        |Synced channels.
      }
    }
    syncedAt: TimeStamp with {
      briefly "Synced"
      described as {
        |Sync time.
      }
    }
  } with {
    briefly "Rates synced"
    described as {
      |Emitted when rates are synced.
    }
  }
} with {
  option external()
  briefly "External channel manager"
  described as {
    |External OTA channel management service.
  }
}
// Payment Gateway Service
context PaymentGatewayService is {
  command AuthorizePayment is  {
    reservationId: ReservationId with {
      briefly "Reservation"
      described as {
        |Reservation ID.
      }
    }
    amount: Decimal(10,2) with {
      briefly "Amount"
      described as {
        |Authorization amount.
      }
    }
    currency: String(3,3) with {
      briefly "Currency"
      described as {
        |Currency code.
      }
    }
    paymentToken: String(1,200) with {
      briefly "Token"
      described as {
        |Payment token.
      }
    }
  } with {
    briefly "Authorize payment"
    described as {
      |Authorizes payment.
    }
  }
  event PaymentAuthorized is  {
    reservationId: ReservationId with {
      briefly "Reservation"
      described as {
        |Reservation ID.
      }
    }
    authorizationCode: String(1,50) with {
      briefly "Auth code"
      described as {
        |Authorization code.
      }
    }
    authorizedAt: TimeStamp with {
      briefly "Authorized"
      described as {
        |Authorization time.
      }
    }
  } with {
    briefly "Payment authorized"
    described as {
      |Emitted when payment is authorized.
    }
  }
  command CapturePayment is  {
    reservationId: ReservationId with {
      briefly "Reservation"
      described as {
        |Reservation ID.
      }
    }
    authorizationCode: String(1,50) with {
      briefly "Auth code"
      described as {
        |Authorization code.
      }
    }
    amount: Decimal(10,2) with {
      briefly "Amount"
      described as {
        |Capture amount.
      }
    }
  } with {
    briefly "Capture payment"
    described as {
      |Captures authorized payment.
    }
  }
  event PaymentCaptured is  {
    reservationId: ReservationId with {
      briefly "Reservation"
      described as {
        |Reservation ID.
      }
    }
    transactionId: String(1,50) with {
      briefly "Transaction"
      described as {
        |Transaction ID.
      }
    }
    capturedAt: TimeStamp with {
      briefly "Captured"
      described as {
        |Capture time.
      }
    }
  } with {
    briefly "Payment captured"
    described as {
      |Emitted when payment is captured.
    }
  }
  command RefundPayment is  {
    reservationId: ReservationId with {
      briefly "Reservation"
      described as {
        |Reservation ID.
      }
    }
    transactionId: String(1,50) with {
      briefly "Transaction"
      described as {
        |Original transaction.
      }
    }
    amount: Decimal(10,2) with {
      briefly "Amount"
      described as {
        |Refund amount.
      }
    }
  } with {
    briefly "Refund payment"
    described as {
      |Refunds a payment.
    }
  }
  event PaymentRefunded is  {
    reservationId: ReservationId with {
      briefly "Reservation"
      described as {
        |Reservation ID.
      }
    }
    refundId: String(1,50) with {
      briefly "Refund"
      described as {
        |Refund ID.
      }
    }
    refundedAt: TimeStamp with {
      briefly "Refunded"
      described as {
        |Refund time.
      }
    }
  } with {
    briefly "Payment refunded"
    described as {
      |Emitted when payment is refunded.
    }
  }
} with {
  option external()
  briefly "External payment gateway"
  described as {
    |External payment processing service.
  }
}
// Housekeeping Service
context HousekeepingService is {
  command AssignRoom is  {
    roomId: RoomId with {
      briefly "Room"
      described as {
        |Room ID.
      }
    }
    assignedTo: String(1,200) with {
      briefly "Assigned to"
      described as {
        |Housekeeper name.
      }
    }
    priority: Natural with {
      briefly "Priority"
      described as {
        |Cleaning priority.
      }
    }
  } with {
    briefly "Assign room"
    described as {
      |Assigns room for cleaning.
    }
  }
  event RoomAssigned is  {
    roomId: RoomId with {
      briefly "Room"
      described as {
        |Room ID.
      }
    }
    assignedTo: String(1,200) with {
      briefly "Assigned to"
      described as {
        |Housekeeper.
      }
    }
    assignedAt: TimeStamp with {
      briefly "Assigned"
      described as {
        |Assignment time.
      }
    }
  } with {
    briefly "Room assigned"
    described as {
      |Emitted when room is assigned.
    }
  }
  command MarkRoomClean is  {
    roomId: RoomId with {
      briefly "Room"
      described as {
        |Room ID.
      }
    }
    cleanedBy: String(1,200) with {
      briefly "Cleaned by"
      described as {
        |Housekeeper.
      }
    }
    inspected: Boolean with {
      briefly "Inspected"
      described as {
        |Whether inspected.
      }
    }
  } with {
    briefly "Mark room clean"
    described as {
      |Marks room as clean.
    }
  }
  event RoomCleaned is  {
    roomId: RoomId with {
      briefly "Room"
      described as {
        |Room ID.
      }
    }
    cleanedBy: String(1,200) with {
      briefly "Cleaned by"
      described as {
        |Housekeeper.
      }
    }
    cleanedAt: TimeStamp with {
      briefly "Cleaned"
      described as {
        |Cleaning time.
      }
    }
  } with {
    briefly "Room cleaned"
    described as {
      |Emitted when room is cleaned.
    }
  }
  command ReportMaintenance is  {
    roomId: RoomId with {
      briefly "Room"
      described as {
        |Room ID.
      }
    }
    issue: String(1,500) with {
      briefly "Issue"
      described as {
        |Maintenance issue.
      }
    }
    priority: Natural with {
      briefly "Priority"
      described as {
        |Issue priority.
      }
    }
  } with {
    briefly "Report maintenance"
    described as {
      |Reports maintenance issue.
    }
  }
  event MaintenanceReported is  {
    roomId: RoomId with {
      briefly "Room"
      described as {
        |Room ID.
      }
    }
    ticketId: UUID with {
      briefly "Ticket"
      described as {
        |Maintenance ticket ID.
      }
    }
    reportedAt: TimeStamp with {
      briefly "Reported"
      described as {
        |Report time.
      }
    }
  } with {
    briefly "Maintenance reported"
    described as {
      |Emitted when maintenance is reported.
    }
  }
} with {
  option external()
  briefly "External housekeeping"
  described as {
    |External housekeeping management service.
  }
}
// Loyalty Program Service
context LoyaltyProgramService is {
  query GetMemberStatus is  {
    loyaltyNumber: String(1,50) with {
      briefly "Loyalty"
      described as {
        |Loyalty number.
      }
    }
  } with {
    briefly "Get member status"
    described as {
      |Retrieves loyalty member status.
    }
  }
  result MemberStatus is  {
    loyaltyNumber: String(1,50) with {
      briefly "Loyalty"
      described as {
        |Loyalty number.
      }
    }
    tier: String(1,50) with {
      briefly "Tier"
      described as {
        |Membership tier.
      }
    }
    points: Natural with {
      briefly "Points"
      described as {
        |Available points.
      }
    }
    benefits: String(1,200)+ with {
      briefly "Benefits"
      described as {
        |Tier benefits.
      }
    }
  } with {
    briefly "Member status"
    described as {
      |Loyalty member information.
    }
  }
  command AccruePoints is  {
    loyaltyNumber: String(1,50) with {
      briefly "Loyalty"
      described as {
        |Loyalty number.
      }
    }
    reservationId: ReservationId with {
      briefly "Reservation"
      described as {
        |Reservation ID.
      }
    }
    points: Natural with {
      briefly "Points"
      described as {
        |Points to accrue.
      }
    }
  } with {
    briefly "Accrue points"
    described as {
      |Accrues loyalty points.
    }
  }
  event PointsAccrued is  {
    loyaltyNumber: String(1,50) with {
      briefly "Loyalty"
      described as {
        |Loyalty number.
      }
    }
    points: Natural with {
      briefly "Points"
      described as {
        |Points accrued.
      }
    }
    newBalance: Natural with {
      briefly "Balance"
      described as {
        |New point balance.
      }
    }
    accruedAt: TimeStamp with {
      briefly "Accrued"
      described as {
        |Accrual time.
      }
    }
  } with {
    briefly "Points accrued"
    described as {
      |Emitted when points are accrued.
    }
  }
  command RedeemPoints is  {
    loyaltyNumber: String(1,50) with {
      briefly "Loyalty"
      described as {
        |Loyalty number.
      }
    }
    reservationId: ReservationId with {
      briefly "Reservation"
      described as {
        |Reservation ID.
      }
    }
    points: Natural with {
      briefly "Points"
      described as {
        |Points to redeem.
      }
    }
  } with {
    briefly "Redeem points"
    described as {
      |Redeems loyalty points.
    }
  }
  event PointsRedeemed is  {
    loyaltyNumber: String(1,50) with {
      briefly "Loyalty"
      described as {
        |Loyalty number.
      }
    }
    points: Natural with {
      briefly "Points"
      described as {
        |Points redeemed.
      }
    }
    value: Decimal(10,2) with {
      briefly "Value"
      described as {
        |Redemption value.
      }
    }
    redeemedAt: TimeStamp with {
      briefly "Redeemed"
      described as {
        |Redemption time.
      }
    }
  } with {
    briefly "Points redeemed"
    described as {
      |Emitted when points are redeemed.
    }
  }
} with {
  option external()
  briefly "External loyalty program"
  described as {
    |External loyalty and rewards service.
  }
}
// Guest Communication Service
context GuestCommunicationService is {
  command SendConfirmation is  {
    reservationId: ReservationId with {
      briefly "Reservation"
      described as {
        |Reservation ID.
      }
    }
    guest: GuestInfo with {
      briefly "Guest"
      described as {
        |Guest info.
      }
    }
    confirmationNumber: String(1,20) with {
      briefly "Confirmation"
      described as {
        |Confirmation number.
      }
    }
  } with {
    briefly "Send confirmation"
    described as {
      |Sends booking confirmation.
    }
  }
  event ConfirmationSent is  {
    reservationId: ReservationId with {
      briefly "Reservation"
      described as {
        |Reservation ID.
      }
    }
    channel: String(1,50) with {
      briefly "Channel"
      described as {
        |Communication channel.
      }
    }
    sentAt: TimeStamp with {
      briefly "Sent"
      described as {
        |Send time.
      }
    }
  } with {
    briefly "Confirmation sent"
    described as {
      |Emitted when confirmation is sent.
    }
  }
  command SendPreArrivalMessage is  {
    reservationId: ReservationId with {
      briefly "Reservation"
      described as {
        |Reservation ID.
      }
    }
    guest: GuestInfo with {
      briefly "Guest"
      described as {
        |Guest info.
      }
    }
    checkInDate: Date with {
      briefly "Check-in"
      described as {
        |Check-in date.
      }
    }
  } with {
    briefly "Send pre-arrival"
    described as {
      |Sends pre-arrival information.
    }
  }
  event PreArrivalSent is  {
    reservationId: ReservationId with {
      briefly "Reservation"
      described as {
        |Reservation ID.
      }
    }
    sentAt: TimeStamp with {
      briefly "Sent"
      described as {
        |Send time.
      }
    }
  } with {
    briefly "Pre-arrival sent"
    described as {
      |Emitted when pre-arrival is sent.
    }
  }
} with {
  option external()
  briefly "External guest communications"
  described as {
    |External guest messaging service.
  }
}
