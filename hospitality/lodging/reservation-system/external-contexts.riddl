// Reservation System - External Contexts
// Channel Management System
context ChannelManagementService is {
  command UpdateInventory is  {
    roomType: RoomType with {
      briefly "Type"
      described as {
        |Room type.
      }
    }
    date: Date with {
      briefly "Date"
      described as {
        |Availability date.
      }
    }
    available: Natural with {
      briefly "Available"
      described as {
        |Available rooms.
      }
    }
  } with {
    briefly "Update inventory"
    described as {
      |Updates room availability across channels.
    }
  }
  event InventoryUpdated is  {
    roomType: RoomType with {
      briefly "Type"
      described as {
        |Room type.
      }
    }
    date: Date with {
      briefly "Date"
      described as {
        |Date updated.
      }
    }
    updatedAt: TimeStamp with {
      briefly "Updated"
      described as {
        |Update time.
      }
    }
  } with {
    briefly "Inventory updated"
    described as {
      |Emitted when inventory is synced.
    }
  }
  command SyncRates is  {
    ratePlanId: RatePlanId with {
      briefly "Plan"
      described as {
        |Rate plan.
      }
    }
    rates: RateInfo+ with {
      briefly "Rates"
      described as {
        |Rates to sync.
      }
    }
  } with {
    briefly "Sync rates"
    described as {
      |Synchronizes rates to distribution channels.
    }
  }
  event RatesSynced is  {
    ratePlanId: RatePlanId with {
      briefly "Plan"
      described as {
        |Rate plan.
      }
    }
    syncedAt: TimeStamp with {
      briefly "Synced"
      described as {
        |Sync time.
      }
    }
  } with {
    briefly "Rates synced"
    described as {
      |Emitted when rates are synced.
    }
  }
} with {
  option external()
  briefly "External channel management"
  described as {
    |External channel distribution service.
  }
}
// Payment Processing Service
context PaymentProcessingService is {
  command AuthorizePayment is  {
    reservationId: ReservationId with {
      briefly "Reservation"
      described as {
        |Reservation ID.
      }
    }
    amount: Decimal(10,2) with {
      briefly "Amount"
      described as {
        |Authorization amount.
      }
    }
    paymentMethod: PaymentMethod with {
      briefly "Method"
      described as {
        |Payment method.
      }
    }
  } with {
    briefly "Authorize payment"
    described as {
      |Authorizes payment on card.
    }
  }
  event PaymentAuthorized is  {
    reservationId: ReservationId with {
      briefly "Reservation"
      described as {
        |Reservation ID.
      }
    }
    authorizationCode: String(1,50) with {
      briefly "Auth code"
      described as {
        |Authorization code.
      }
    }
    authorizedAt: TimeStamp with {
      briefly "Authorized"
      described as {
        |Authorization time.
      }
    }
  } with {
    briefly "Payment authorized"
    described as {
      |Emitted when payment is authorized.
    }
  }
  command CapturePayment is  {
    reservationId: ReservationId with {
      briefly "Reservation"
      described as {
        |Reservation ID.
      }
    }
    amount: Decimal(10,2) with {
      briefly "Amount"
      described as {
        |Capture amount.
      }
    }
    authorizationCode: String(1,50) with {
      briefly "Auth code"
      described as {
        |Authorization code.
      }
    }
  } with {
    briefly "Capture payment"
    described as {
      |Captures authorized payment.
    }
  }
  event PaymentCaptured is  {
    reservationId: ReservationId with {
      briefly "Reservation"
      described as {
        |Reservation ID.
      }
    }
    amount: Decimal(10,2) with {
      briefly "Amount"
      described as {
        |Captured amount.
      }
    }
    capturedAt: TimeStamp with {
      briefly "Captured"
      described as {
        |Capture time.
      }
    }
  } with {
    briefly "Payment captured"
    described as {
      |Emitted when payment is captured.
    }
  }
  command RefundPayment is  {
    reservationId: ReservationId with {
      briefly "Reservation"
      described as {
        |Reservation ID.
      }
    }
    amount: Decimal(10,2) with {
      briefly "Amount"
      described as {
        |Refund amount.
      }
    }
    reason: String(1,500) with {
      briefly "Reason"
      described as {
        |Refund reason.
      }
    }
  } with {
    briefly "Refund payment"
    described as {
      |Refunds a payment.
    }
  }
  event PaymentRefunded is  {
    reservationId: ReservationId with {
      briefly "Reservation"
      described as {
        |Reservation ID.
      }
    }
    amount: Decimal(10,2) with {
      briefly "Amount"
      described as {
        |Refunded amount.
      }
    }
    refundedAt: TimeStamp with {
      briefly "Refunded"
      described as {
        |Refund time.
      }
    }
  } with {
    briefly "Payment refunded"
    described as {
      |Emitted when payment is refunded.
    }
  }
} with {
  option external()
  briefly "External payment processing"
  described as {
    |External payment processor service.
  }
}
// Guest Communication Service
context GuestCommunicationService is {
  command SendConfirmationEmail is  {
    reservationId: ReservationId with {
      briefly "Reservation"
      described as {
        |Reservation ID.
      }
    }
    guestEmail: String(5,254) with {
      briefly "Email"
      described as {
        |Guest email.
      }
    }
    confirmationNumber: String(1,50) with {
      briefly "Confirmation"
      described as {
        |Confirmation number.
      }
    }
    stayDetails: StayDetails with {
      briefly "Stay"
      described as {
        |Stay details.
      }
    }
  } with {
    briefly "Send confirmation"
    described as {
      |Sends booking confirmation email.
    }
  }
  event ConfirmationEmailSent is  {
    reservationId: ReservationId with {
      briefly "Reservation"
      described as {
        |Reservation ID.
      }
    }
    sentAt: TimeStamp with {
      briefly "Sent"
      described as {
        |Send time.
      }
    }
  } with {
    briefly "Confirmation sent"
    described as {
      |Emitted when confirmation is sent.
    }
  }
  command SendPreArrivalEmail is  {
    reservationId: ReservationId with {
      briefly "Reservation"
      described as {
        |Reservation ID.
      }
    }
    guestEmail: String(5,254) with {
      briefly "Email"
      described as {
        |Guest email.
      }
    }
    checkInDate: Date with {
      briefly "Check-in"
      described as {
        |Check-in date.
      }
    }
  } with {
    briefly "Send pre-arrival"
    described as {
      |Sends pre-arrival information email.
    }
  }
  event PreArrivalEmailSent is  {
    reservationId: ReservationId with {
      briefly "Reservation"
      described as {
        |Reservation ID.
      }
    }
    sentAt: TimeStamp with {
      briefly "Sent"
      described as {
        |Send time.
      }
    }
  } with {
    briefly "Pre-arrival sent"
    described as {
      |Emitted when pre-arrival email is sent.
    }
  }
  command SendCheckoutReceipt is  {
    reservationId: ReservationId with {
      briefly "Reservation"
      described as {
        |Reservation ID.
      }
    }
    guestEmail: String(5,254) with {
      briefly "Email"
      described as {
        |Guest email.
      }
    }
    billing: BillingDetails with {
      briefly "Billing"
      described as {
        |Billing details.
      }
    }
  } with {
    briefly "Send checkout receipt"
    described as {
      |Sends checkout receipt email.
    }
  }
  event CheckoutReceiptSent is  {
    reservationId: ReservationId with {
      briefly "Reservation"
      described as {
        |Reservation ID.
      }
    }
    sentAt: TimeStamp with {
      briefly "Sent"
      described as {
        |Send time.
      }
    }
  } with {
    briefly "Receipt sent"
    described as {
      |Emitted when checkout receipt is sent.
    }
  }
} with {
  option external()
  briefly "External guest communication"
  described as {
    |External email and SMS service.
  }
}
// Loyalty Program Service
context LoyaltyProgramService is {
  query GetMemberTier is  {
    loyaltyNumber: String(1,50) with {
      briefly "Number"
      described as {
        |Loyalty number.
      }
    }
  } with {
    briefly "Get member tier"
    described as {
      |Retrieves member loyalty tier.
    }
  }
  result MemberTierResult is  {
    tier: String(1,50) with {
      briefly "Tier"
      described as {
        |Member tier.
      }
    }
    pointsBalance: Natural with {
      briefly "Points"
      described as {
        |Points balance.
      }
    }
    benefits: String(1,200)+ with {
      briefly "Benefits"
      described as {
        |Tier benefits.
      }
    }
  } with {
    briefly "Member tier result"
    described as {
      |Loyalty tier information.
    }
  }
  command AwardPoints is  {
    loyaltyNumber: String(1,50) with {
      briefly "Number"
      described as {
        |Loyalty number.
      }
    }
    reservationId: ReservationId with {
      briefly "Reservation"
      described as {
        |Reservation ID.
      }
    }
    points: Natural with {
      briefly "Points"
      described as {
        |Points to award.
      }
    }
    reason: String(1,200) with {
      briefly "Reason"
      described as {
        |Award reason.
      }
    }
  } with {
    briefly "Award points"
    described as {
      |Awards loyalty points for stay.
    }
  }
  event PointsAwarded is  {
    loyaltyNumber: String(1,50) with {
      briefly "Number"
      described as {
        |Loyalty number.
      }
    }
    points: Natural with {
      briefly "Points"
      described as {
        |Points awarded.
      }
    }
    awardedAt: TimeStamp with {
      briefly "Awarded"
      described as {
        |Award time.
      }
    }
  } with {
    briefly "Points awarded"
    described as {
      |Emitted when points are awarded.
    }
  }
} with {
  option external()
  briefly "External loyalty program"
  described as {
    |External loyalty rewards service.
  }
}
// Room Management Service
context RoomManagementService is {
  query GetAvailableRooms is  {
    checkInDate: Date with {
      briefly "Check-in"
      described as {
        |Check-in date.
      }
    }
    checkOutDate: Date with {
      briefly "Check-out"
      described as {
        |Check-out date.
      }
    }
    roomType: RoomType with {
      briefly "Type"
      described as {
        |Room type.
      }
    }
    numberOfRooms: Natural with {
      briefly "Count"
      described as {
        |Number of rooms needed.
      }
    }
  } with {
    briefly "Get available rooms"
    described as {
      |Queries available rooms for dates.
    }
  }
  result AvailableRoomsResult is  {
    rooms: RoomAssignment+ with {
      briefly "Rooms"
      described as {
        |Available rooms.
      }
    }
    totalAvailable: Natural with {
      briefly "Total"
      described as {
        |Total available.
      }
    }
  } with {
    briefly "Available rooms result"
    described as {
      |List of available rooms.
    }
  }
  command ReserveRoom is  {
    roomId: RoomId with {
      briefly "Room"
      described as {
        |Room ID.
      }
    }
    reservationId: ReservationId with {
      briefly "Reservation"
      described as {
        |Reservation ID.
      }
    }
    fromDate: Date with {
      briefly "From"
      described as {
        |Start date.
      }
    }
    toDate: Date with {
      briefly "To"
      described as {
        |End date.
      }
    }
  } with {
    briefly "Reserve room"
    described as {
      |Reserves a room for dates.
    }
  }
  event RoomReserved is  {
    roomId: RoomId with {
      briefly "Room"
      described as {
        |Room ID.
      }
    }
    reservationId: ReservationId with {
      briefly "Reservation"
      described as {
        |Reservation ID.
      }
    }
    reservedAt: TimeStamp with {
      briefly "Reserved"
      described as {
        |Reservation time.
      }
    }
  } with {
    briefly "Room reserved"
    described as {
      |Emitted when room is reserved.
    }
  }
  command ReleaseRoom is  {
    roomId: RoomId with {
      briefly "Room"
      described as {
        |Room ID.
      }
    }
    reservationId: ReservationId with {
      briefly "Reservation"
      described as {
        |Reservation ID.
      }
    }
  } with {
    briefly "Release room"
    described as {
      |Releases a room reservation.
    }
  }
  event RoomReleased is  {
    roomId: RoomId with {
      briefly "Room"
      described as {
        |Room ID.
      }
    }
    releasedAt: TimeStamp with {
      briefly "Released"
      described as {
        |Release time.
      }
    }
  } with {
    briefly "Room released"
    described as {
      |Emitted when room is released.
    }
  }
} with {
  option external()
  briefly "External room management"
  described as {
    |External room inventory service.
  }
}
// Housekeeping Service
context HousekeepingService is {
  command RequestRoomCleaning is  {
    roomId: RoomId with {
      briefly "Room"
      described as {
        |Room ID.
      }
    }
    roomNumber: String(1,20) with {
      briefly "Number"
      described as {
        |Room number.
      }
    }
    priority: String(1,20) with {
      briefly "Priority"
      described as {
        |Cleaning priority.
      }
    }
    expectedCheckIn: TimeStamp? with {
      briefly "Check-in"
      described as {
        |Expected check-in.
      }
    }
  } with {
    briefly "Request cleaning"
    described as {
      |Requests room to be cleaned.
    }
  }
  event CleaningRequested is  {
    roomId: RoomId with {
      briefly "Room"
      described as {
        |Room ID.
      }
    }
    requestedAt: TimeStamp with {
      briefly "Requested"
      described as {
        |Request time.
      }
    }
  } with {
    briefly "Cleaning requested"
    described as {
      |Emitted when cleaning is requested.
    }
  }
  event RoomCleaningCompleted is  {
    roomId: RoomId with {
      briefly "Room"
      described as {
        |Room ID.
      }
    }
    completedAt: TimeStamp with {
      briefly "Completed"
      described as {
        |Completion time.
      }
    }
    inspectedBy: String(1,200)? with {
      briefly "Inspector"
      described as {
        |Inspector name.
      }
    }
  } with {
    briefly "Cleaning completed"
    described as {
      |Emitted when room is clean.
    }
  }
} with {
  option external()
  briefly "External housekeeping"
  described as {
    |External housekeeping service.
  }
}
