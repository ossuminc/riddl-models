// Benefits Administration - External Contexts

context InsuranceCarrier is {

  command SubmitEnrollmentFile is {
    carrierId is CarrierId with { briefly "Carrier" described by "Carrier ID." }
    enrollments is many PlanElection with { briefly "Enrollments" described by "Plan elections to submit." }
    effectiveDate is Date with { briefly "Effective" described by "Coverage effective date." }
  } with {
    briefly "Submit enrollment file"
    described by "Submits enrollment data to insurance carrier."
  }

  event EnrollmentFileAccepted is {
    carrierId is CarrierId with { briefly "Carrier" described by "Carrier ID." }
    acceptedAt is TimeStamp with { briefly "Accepted" described by "Acceptance time." }
    recordCount is Natural with { briefly "Records" described by "Number of records accepted." }
  } with {
    briefly "Enrollment file accepted"
    described by "Emitted when carrier accepts enrollment file."
  }

  event EnrollmentFileRejected is {
    carrierId is CarrierId with { briefly "Carrier" described by "Carrier ID." }
    rejectedAt is TimeStamp with { briefly "Rejected" described by "Rejection time." }
    errors is many String(3, 500) with { briefly "Errors" described by "Rejection errors." }
  } with {
    briefly "Enrollment file rejected"
    described by "Emitted when carrier rejects enrollment file."
  }

  query GetPlanDetails is {
    carrierId is CarrierId with { briefly "Carrier" described by "Carrier ID." }
    planId is PlanId with { briefly "Plan" described by "Plan ID." }
  } with {
    briefly "Get plan details"
    described by "Retrieves plan details from carrier."
  }

  result PlanDetails is {
    planInfo is BenefitsPlanInfo with { briefly "Plan info" described by "Plan details." }
    premiumSchedule is many Decimal(10, 2) with { briefly "Premiums" described by "Premium schedule." }
    networkProviders is Natural with { briefly "Providers" described by "Network provider count." }
  } with {
    briefly "Plan details"
    described by "Insurance plan details from carrier."
  }

} with {
  option is external
  briefly "External insurance carrier"
  described by "Insurance carrier system for plan and enrollment management."
}

context PayrollSystem is {

  command UpdateDeductions is {
    employeeId is EmployeeId with { briefly "Employee" described by "Employee ID." }
    elections is many PlanElection with { briefly "Elections" described by "Plan elections." }
    effectiveDate is Date with { briefly "Effective" described by "Deduction effective date." }
  } with {
    briefly "Update deductions"
    described by "Updates payroll deductions for benefit elections."
  }

  event DeductionsUpdated is {
    employeeId is EmployeeId with { briefly "Employee" described by "Employee ID." }
    totalDeduction is Decimal(10, 2) with { briefly "Total" described by "Total per-period deduction." }
    updatedAt is TimeStamp with { briefly "Updated" described by "Update time." }
  } with {
    briefly "Deductions updated"
    described by "Emitted when payroll deductions are updated."
  }

  query GetEmployeeCompensation is {
    employeeId is EmployeeId with { briefly "Employee" described by "Employee ID." }
  } with {
    briefly "Get employee compensation"
    described by "Retrieves employee compensation details."
  }

  result EmployeeCompensation is {
    employeeId is EmployeeId with { briefly "Employee" described by "Employee ID." }
    annualSalary is Decimal(12, 2) with { briefly "Salary" described by "Annual salary." }
    payFrequency is String(3, 50) with { briefly "Frequency" described by "Pay frequency." }
  } with {
    briefly "Employee compensation"
    described by "Employee compensation details."
  }

} with {
  option is external
  briefly "External payroll system"
  described by "Payroll system for benefits deduction management."
}

context ComplianceReportingSystem is {

  command GenerateAcaReport is {
    reportingYear is Year with { briefly "Year" described by "ACA reporting year." }
    employeeRecords is many AcaReportingInfo with { briefly "Records" described by "Employee ACA records." }
  } with {
    briefly "Generate ACA report"
    described by "Generates ACA compliance report."
  }

  event AcaReportGenerated is {
    reportingYear is Year with { briefly "Year" described by "Reporting year." }
    generatedAt is TimeStamp with { briefly "Generated" described by "Generation time." }
    employeeCount is Natural with { briefly "Employees" described by "Employee count." }
  } with {
    briefly "ACA report generated"
    described by "Emitted when ACA report is generated."
  }

  command GenerateCobraNotice is {
    employeeId is EmployeeId with { briefly "Employee" described by "Employee ID." }
    cobraInfo is CobraInfo with { briefly "COBRA" described by "COBRA details." }
  } with {
    briefly "Generate COBRA notice"
    described by "Generates COBRA election notice."
  }

  event CobraNoticeGenerated is {
    employeeId is EmployeeId with { briefly "Employee" described by "Employee ID." }
    generatedAt is TimeStamp with { briefly "Generated" described by "Generation time." }
    electionDeadline is Date with { briefly "Deadline" described by "Election deadline." }
  } with {
    briefly "COBRA notice generated"
    described by "Emitted when COBRA notice is generated."
  }

} with {
  option is external
  briefly "External compliance reporting"
  described by "Compliance reporting system for ACA and COBRA."
}
