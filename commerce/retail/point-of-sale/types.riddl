// Point of Sale - Shared Types

type TransactionId is Id(POSContext.Transaction) with {
  briefly "Transaction identifier"
  described by "Unique identifier for a POS transaction."
}

type TerminalId is UUID with {
  briefly "Terminal identifier"
  described by "Reference to a POS terminal."
}

type CashierId is UUID with {
  briefly "Cashier identifier"
  described by "Reference to the operating cashier."
}

type ProductId is UUID with {
  briefly "Product identifier"
  described by "Reference to a product."
}

type SKU is Pattern("^[A-Z0-9-]{6,20}$") with {
  briefly "Stock keeping unit"
  described by "Product SKU."
}

type Barcode is String(1, 50) with {
  briefly "Barcode"
  described by "Product barcode for scanning."
}

type Quantity is Decimal(10, 3) with {
  briefly "Quantity"
  described by "Item quantity (supports partial units)."
}

type Money is {
  amount is Decimal(10, 2) with {
    briefly "Amount"
    described by "Monetary value."
  }
  currency is Currency(USD) with {
    briefly "Currency"
    described by "Currency code."
  }
} with {
  briefly "Monetary value"
  described by "Amount with currency."
}

type LineItem is {
  lineNumber is Natural with {
    briefly "Line number"
    described by "Position in transaction."
  }
  productId is ProductId with {
    briefly "Product ID"
    described by "Product identifier."
  }
  sku is SKU with {
    briefly "SKU"
    described by "Product SKU."
  }
  description is String(1, 200) with {
    briefly "Description"
    described by "Product description."
  }
  quantity is Quantity with {
    briefly "Quantity"
    described by "Units purchased."
  }
  unitPrice is Money with {
    briefly "Unit price"
    described by "Price per unit."
  }
  discount is optional Money with {
    briefly "Discount"
    described by "Line item discount."
  }
  lineTotal is Money with {
    briefly "Line total"
    described by "Total for this line."
  }
  scannedAt is TimeStamp with {
    briefly "Scanned at"
    described by "When item was scanned."
  }
} with {
  briefly "Transaction line item"
  described by "A single item in the transaction."
}

type PaymentMethod is any of {
  CashPayment with {
    briefly "Cash"
    described by "Cash payment."
  },
  CreditCardPayment with {
    briefly "Credit card"
    described by "Credit card payment."
  },
  DebitCardPayment with {
    briefly "Debit card"
    described by "Debit card payment."
  },
  GiftCardPayment with {
    briefly "Gift card"
    described by "Gift card payment."
  },
  MobilePayment with {
    briefly "Mobile"
    described by "Mobile wallet payment."
  }
} with {
  briefly "Payment method"
  described by "Type of payment tender."
}

type PaymentTender is {
  method is PaymentMethod with {
    briefly "Method"
    described by "Payment method type."
  }
  amount is Money with {
    briefly "Amount"
    described by "Tender amount."
  }
  reference is optional String(1, 100) with {
    briefly "Reference"
    described by "Card or transaction reference."
  }
  approved is Boolean with {
    briefly "Approved"
    described by "Whether payment was approved."
  }
} with {
  briefly "Payment tender"
  described by "A single payment in the transaction."
}

type TransactionTotals is {
  subtotal is Money with {
    briefly "Subtotal"
    described by "Total before tax and discounts."
  }
  discountTotal is Money with {
    briefly "Discounts"
    described by "Total discounts applied."
  }
  taxTotal is Money with {
    briefly "Tax"
    described by "Total tax."
  }
  grandTotal is Money with {
    briefly "Grand total"
    described by "Final transaction total."
  }
  amountPaid is Money with {
    briefly "Paid"
    described by "Total amount tendered."
  }
  changeDue is Money with {
    briefly "Change"
    described by "Change to return."
  }
} with {
  briefly "Transaction totals"
  described by "Calculated totals for the transaction."
}

type DiscountInfo is {
  discountType is DiscountType with {
    briefly "Type"
    described by "Type of discount."
  }
  description is String(1, 200) with {
    briefly "Description"
    described by "Discount description."
  }
  amount is Money with {
    briefly "Amount"
    described by "Discount value."
  }
  code is optional String(1, 50) with {
    briefly "Code"
    described by "Promo code if applicable."
  }
} with {
  briefly "Discount information"
  described by "Applied discount details."
}

type DiscountType is any of {
  PercentageDiscount with {
    briefly "Percentage"
    described by "Percentage off discount."
  },
  FixedAmountDiscount with {
    briefly "Fixed"
    described by "Fixed amount discount."
  },
  PromotionalDiscount with {
    briefly "Promotional"
    described by "Promotional discount."
  },
  EmployeeDiscount with {
    briefly "Employee"
    described by "Employee discount."
  }
} with {
  briefly "Discount type"
  described by "Category of discount."
}
