// Vendor Management - Vendor Context
context VendorContext is {
  include "types.riddl"
  include "Vendor.riddl"
  // Adaptors for external system integration
  adaptor PaymentAdapter to context PaymentService is { 
    handler PayoutProcessing is {
      on command PaymentService.CreatePayoutAccount is {
        prompt "Create vendor payout account"
      }
      on command PaymentService.ProcessPayout is {
        prompt "Process vendor payout"
      }
    } with {
      briefly "Handles payout setup"
      described as {
        |Configures vendor payment accounts.
      }
    }
  } with {
    briefly "Payment integration"
    described as {
      |Manages vendor payout configuration.
    }
  }
  adaptor OrderAdapter from context OrderService is { 
    handler OrderEvents is {
      on event OrderService.OrderFulfilled is {
        prompt "Calculate vendor commission and queue payout"
      }
      on event OrderService.OrderReturned is {
        prompt "Adjust vendor balance for return"
      }
    } with {
      briefly "Handles order events"
      described as {
        |Processes orders for commission calculation.
      }
    }
  } with {
    briefly "Order service integration"
    described as {
      |Receives order events for vendor earnings.
    }
  }
  adaptor NotificationAdapter to context NotificationService is { 
    handler VendorNotifications is {
      on command NotificationService.SendEmail is {
        prompt "Send vendor lifecycle notification email"
      }
    } with {
      briefly "Handles vendor notifications"
      described as {
        |Sends notifications for vendor lifecycle events.
      }
    }
  } with {
    briefly "Notification integration"
    described as {
      |Publishes vendor events for notifications.
    }
  }
  // Repository for vendor persistence
  repository VendorRepository is {
    schema VendorData is relational
      of vendors as type Vendor
        index on field Vendor.businessName
        index on field Vendor.storeName
        index on field Vendor.email

    handler VendorPersistence is {
      on command Vendor.SubmitApplication is {
        prompt "Persist new vendor application"
      }
      on command Vendor.ApproveVendor is {
        prompt "Update vendor status to active"
      }
      on command Vendor.RejectVendor is {
        prompt "Update vendor status to rejected"
      }
      on command Vendor.UpdateVendorInfo is {
        prompt "Update vendor profile"
      }
      on command Vendor.SetBankAccount is {
        prompt "Update payout account"
      }
      on command Vendor.SuspendVendor is {
        prompt "Update vendor status to suspended"
      }
      on command Vendor.ReinstateVendor is {
        prompt "Update vendor status to active"
      }
      on command Vendor.TerminateVendor is {
        prompt "Update vendor status to terminated"
      }
      on command Vendor.UpdatePerformance is {
        prompt "Update vendor performance metrics"
      }
    } with {
      briefly "Persists vendor commands"
      described as {
        |Handles command-driven persistence for vendor data.
      }
    }
  } with {
    briefly "Vendor data persistence"
    described as {
      | The VendorRepository provides persistent storage for vendors
      | with indexes for searching by name and email.
    }
  }
  // Projector for vendor analytics
  projector VendorAnalytics is {
    record VendorPerformanceSummary is  {
      vendorId: VendorId with {
        briefly "Vendor"
        described as {
          |Vendor identifier.
        }
      }
      storeName: StoreName with {
        briefly "Store"
        described as {
          |Store name.
        }
      }
      tier: VendorTier with {
        briefly "Tier"
        described as {
          |Vendor tier.
        }
      }
      totalOrders: Natural with {
        briefly "Orders"
        described as {
          |Total orders fulfilled.
        }
      }
      totalRevenue: Money with {
        briefly "Revenue"
        described as {
          |Total revenue generated.
        }
      }
      avgRating: Decimal(3,2) with {
        briefly "Rating"
        described as {
          |Average rating.
        }
      }
    } with {
      briefly "Vendor performance summary"
      described as {
        |Aggregated vendor performance data.
      }
    }
    handler AnalyticsHandler is {
      on event Vendor.PerformanceUpdated is {
        prompt "Update vendor performance summary"
      }
      on event Vendor.VendorApproved is {
        prompt "Initialize vendor analytics record"
      }
    } with {
      briefly "Maintains analytics views"
      described as {
        |Projects events into analytics data.
      }
    }
  } with {
    briefly "Vendor analytics projections"
    described as {
      |Maintains performance analytics for vendors.
    }
  }
} with {
  briefly "Bounded context for vendor management"
  described as {
    | The VendorContext is the bounded context for marketplace vendor
    | management. It contains the Vendor entity with integrations to
    | payment, order, and notification systems.
  }
}
