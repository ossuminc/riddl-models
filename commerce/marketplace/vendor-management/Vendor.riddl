// Vendor Management - Vendor Entity
entity Vendor is {
  // Commands
  command SubmitApplication is  {
    vendorId: VendorId with {
      briefly "Vendor ID"
      described as {
        |Unique identifier for the new vendor.
      }
    }
    businessName: BusinessName with {
      briefly "Business name"
      described as {
        |Legal business name.
      }
    }
    storeName: StoreName with {
      briefly "Store name"
      described as {
        |Display name for storefront.
      }
    }
    taxId: TaxId with {
      briefly "Tax ID"
      described as {
        |Business tax identification.
      }
    }
    email: Email with {
      briefly "Email"
      described as {
        |Primary contact email.
      }
    }
    phone: PhoneNumber with {
      briefly "Phone"
      described as {
        |Contact phone number.
      }
    }
    businessAddress: Address with {
      briefly "Business address"
      described as {
        |Business location address.
      }
    }
    category: VendorCategory with {
      briefly "Category"
      described as {
        |Primary product category.
      }
    }
  } with {
    briefly "Submit vendor application"
    described as {
      |Submits a new vendor application for review.
    }
  }
  command ApproveVendor is  {
    vendorId: VendorId with {
      briefly "Vendor ID"
      described as {
        |Vendor to approve.
      }
    }
    tier: VendorTier with {
      briefly "Tier"
      described as {
        |Assigned vendor tier.
      }
    }
    commissionRates: CommissionRate+ with {
      briefly "Commission rates"
      described as {
        |Commission rates by category.
      }
    }
    approvedBy: String(1,100) with {
      briefly "Approved by"
      described as {
        |Administrator who approved.
      }
    }
  } with {
    briefly "Approve vendor application"
    described as {
      |Approves a pending vendor application.
    }
  }
  command RejectVendor is  {
    vendorId: VendorId with {
      briefly "Vendor ID"
      described as {
        |Vendor to reject.
      }
    }
    reason: String(1,500) with {
      briefly "Reason"
      described as {
        |Rejection reason.
      }
    }
    rejectedBy: String(1,100) with {
      briefly "Rejected by"
      described as {
        |Administrator who rejected.
      }
    }
  } with {
    briefly "Reject vendor application"
    described as {
      |Rejects a pending vendor application.
    }
  }
  command UpdateVendorInfo is  {
    vendorId: VendorId with {
      briefly "Vendor ID"
      described as {
        |Vendor to update.
      }
    }
    updatedStoreName: StoreName? with {
      briefly "Store name"
      described as {
        |New store name if changing.
      }
    }
    updatedEmail: Email? with {
      briefly "Email"
      described as {
        |New email if changing.
      }
    }
    updatedPhone: PhoneNumber? with {
      briefly "Phone"
      described as {
        |New phone if changing.
      }
    }
    updatedBusinessAddress: Address? with {
      briefly "Address"
      described as {
        |New address if changing.
      }
    }
  } with {
    briefly "Update vendor information"
    described as {
      |Updates vendor profile information.
    }
  }
  command SetBankAccount is  {
    vendorId: VendorId with {
      briefly "Vendor ID"
      described as {
        |Vendor to update.
      }
    }
    bankAccount: BankAccount with {
      briefly "Bank account"
      described as {
        |New banking details.
      }
    }
  } with {
    briefly "Set payout bank account"
    described as {
      |Sets or updates the vendor's payout account.
    }
  }
  command SuspendVendor is  {
    vendorId: VendorId with {
      briefly "Vendor ID"
      described as {
        |Vendor to suspend.
      }
    }
    reason: String(1,500) with {
      briefly "Reason"
      described as {
        |Suspension reason.
      }
    }
    suspendedBy: String(1,100) with {
      briefly "Suspended by"
      described as {
        |Administrator who suspended.
      }
    }
  } with {
    briefly "Suspend vendor"
    described as {
      |Temporarily suspends a vendor's selling privileges.
    }
  }
  command ReinstateVendor is  {
    vendorId: VendorId with {
      briefly "Vendor ID"
      described as {
        |Vendor to reinstate.
      }
    }
    reinstatedBy: String(1,100) with {
      briefly "Reinstated by"
      described as {
        |Administrator who reinstated.
      }
    }
  } with {
    briefly "Reinstate vendor"
    described as {
      |Restores a suspended vendor's privileges.
    }
  }
  command TerminateVendor is  {
    vendorId: VendorId with {
      briefly "Vendor ID"
      described as {
        |Vendor to terminate.
      }
    }
    reason: String(1,500) with {
      briefly "Reason"
      described as {
        |Termination reason.
      }
    }
    terminatedBy: String(1,100) with {
      briefly "Terminated by"
      described as {
        |Administrator who terminated.
      }
    }
  } with {
    briefly "Terminate vendor relationship"
    described as {
      |Permanently ends the vendor relationship.
    }
  }
  command UpdatePerformance is  {
    vendorId: VendorId with {
      briefly "Vendor ID"
      described as {
        |Vendor to update.
      }
    }
    metrics: PerformanceMetrics with {
      briefly "Metrics"
      described as {
        |Updated performance metrics.
      }
    }
  } with {
    briefly "Update performance metrics"
    described as {
      |Updates vendor performance tracking data.
    }
  }
  // Events
  event ApplicationSubmitted is  {
    vendorId: VendorId with {
      briefly "Vendor ID"
      described as {
        |New vendor identifier.
      }
    }
    businessName: BusinessName with {
      briefly "Business"
      described as {
        |Business name.
      }
    }
    storeName: StoreName with {
      briefly "Store"
      described as {
        |Store name.
      }
    }
    category: VendorCategory with {
      briefly "Category"
      described as {
        |Product category.
      }
    }
    submittedAt: TimeStamp with {
      briefly "Submitted"
      described as {
        |Submission time.
      }
    }
  } with {
    briefly "Application was submitted"
    described as {
      |Emitted when a new vendor application is received.
    }
  }
  event VendorApproved is  {
    vendorId: VendorId with {
      briefly "Vendor ID"
      described as {
        |Approved vendor.
      }
    }
    tier: VendorTier with {
      briefly "Tier"
      described as {
        |Assigned tier.
      }
    }
    approvedBy: String(1,100) with {
      briefly "Approved by"
      described as {
        |Administrator.
      }
    }
    approvedAt: TimeStamp with {
      briefly "Approved"
      described as {
        |Approval time.
      }
    }
  } with {
    briefly "Vendor was approved"
    described as {
      |Emitted when a vendor application is approved.
    }
  }
  event VendorRejected is  {
    vendorId: VendorId with {
      briefly "Vendor ID"
      described as {
        |Rejected vendor.
      }
    }
    reason: String(1,500) with {
      briefly "Reason"
      described as {
        |Rejection reason.
      }
    }
    rejectedBy: String(1,100) with {
      briefly "Rejected by"
      described as {
        |Administrator.
      }
    }
    rejectedAt: TimeStamp with {
      briefly "Rejected"
      described as {
        |Rejection time.
      }
    }
  } with {
    briefly "Vendor was rejected"
    described as {
      |Emitted when a vendor application is rejected.
    }
  }
  event VendorInfoUpdated is  {
    vendorId: VendorId with {
      briefly "Vendor ID"
      described as {
        |Updated vendor.
      }
    }
    updatedAt: TimeStamp with {
      briefly "Updated"
      described as {
        |Update time.
      }
    }
  } with {
    briefly "Vendor info was updated"
    described as {
      |Emitted when vendor profile is modified.
    }
  }
  event BankAccountSet is  {
    vendorId: VendorId with {
      briefly "Vendor ID"
      described as {
        |Vendor.
      }
    }
    bankName: String(1,100) with {
      briefly "Bank"
      described as {
        |Bank name.
      }
    }
    setAt: TimeStamp with {
      briefly "Set at"
      described as {
        |When set.
      }
    }
  } with {
    briefly "Bank account was set"
    described as {
      |Emitted when payout account is configured.
    }
  }
  event VendorSuspended is  {
    vendorId: VendorId with {
      briefly "Vendor ID"
      described as {
        |Suspended vendor.
      }
    }
    reason: String(1,500) with {
      briefly "Reason"
      described as {
        |Suspension reason.
      }
    }
    suspendedBy: String(1,100) with {
      briefly "Suspended by"
      described as {
        |Administrator.
      }
    }
    suspendedAt: TimeStamp with {
      briefly "Suspended"
      described as {
        |Suspension time.
      }
    }
  } with {
    briefly "Vendor was suspended"
    described as {
      |Emitted when vendor selling is suspended.
    }
  }
  event VendorReinstated is  {
    vendorId: VendorId with {
      briefly "Vendor ID"
      described as {
        |Reinstated vendor.
      }
    }
    reinstatedBy: String(1,100) with {
      briefly "Reinstated by"
      described as {
        |Administrator.
      }
    }
    reinstatedAt: TimeStamp with {
      briefly "Reinstated"
      described as {
        |Reinstatement time.
      }
    }
  } with {
    briefly "Vendor was reinstated"
    described as {
      |Emitted when suspended vendor is restored.
    }
  }
  event VendorTerminated is  {
    vendorId: VendorId with {
      briefly "Vendor ID"
      described as {
        |Terminated vendor.
      }
    }
    reason: String(1,500) with {
      briefly "Reason"
      described as {
        |Termination reason.
      }
    }
    terminatedBy: String(1,100) with {
      briefly "Terminated by"
      described as {
        |Administrator.
      }
    }
    terminatedAt: TimeStamp with {
      briefly "Terminated"
      described as {
        |Termination time.
      }
    }
  } with {
    briefly "Vendor was terminated"
    described as {
      |Emitted when vendor relationship ends.
    }
  }
  event PerformanceUpdated is  {
    vendorId: VendorId with {
      briefly "Vendor ID"
      described as {
        |Vendor.
      }
    }
    metrics: PerformanceMetrics with {
      briefly "Metrics"
      described as {
        |Updated metrics.
      }
    }
    updatedAt: TimeStamp with {
      briefly "Updated"
      described as {
        |Update time.
      }
    }
  } with {
    briefly "Performance was updated"
    described as {
      |Emitted when vendor metrics are refreshed.
    }
  }
  // State Records
  record PendingVendorData is  {
    vendorId: VendorId with {
      briefly "Vendor ID"
      described as {
        |Vendor identifier.
      }
    }
    businessName: BusinessName with {
      briefly "Business"
      described as {
        |Business name.
      }
    }
    storeName: StoreName with {
      briefly "Store"
      described as {
        |Store name.
      }
    }
    taxId: TaxId with {
      briefly "Tax ID"
      described as {
        |Tax identification.
      }
    }
    email: Email with {
      briefly "Email"
      described as {
        |Contact email.
      }
    }
    phone: PhoneNumber with {
      briefly "Phone"
      described as {
        |Contact phone.
      }
    }
    businessAddress: Address with {
      briefly "Address"
      described as {
        |Business address.
      }
    }
    category: VendorCategory with {
      briefly "Category"
      described as {
        |Product category.
      }
    }
    submittedAt: TimeStamp with {
      briefly "Submitted"
      described as {
        |Submission time.
      }
    }
  } with {
    briefly "Pending vendor data"
    described as {
      |State data for a vendor application under review.
    }
  }
  record ActiveVendorData is  {
    vendorId: VendorId with {
      briefly "Vendor ID"
      described as {
        |Vendor identifier.
      }
    }
    businessName: BusinessName with {
      briefly "Business"
      described as {
        |Business name.
      }
    }
    storeName: StoreName with {
      briefly "Store"
      described as {
        |Store name.
      }
    }
    taxId: TaxId with {
      briefly "Tax ID"
      described as {
        |Tax identification.
      }
    }
    email: Email with {
      briefly "Email"
      described as {
        |Contact email.
      }
    }
    phone: PhoneNumber with {
      briefly "Phone"
      described as {
        |Contact phone.
      }
    }
    businessAddress: Address with {
      briefly "Address"
      described as {
        |Business address.
      }
    }
    category: VendorCategory with {
      briefly "Category"
      described as {
        |Product category.
      }
    }
    tier: VendorTier with {
      briefly "Tier"
      described as {
        |Vendor tier.
      }
    }
    commissionRates: CommissionRate+ with {
      briefly "Rates"
      described as {
        |Commission rates.
      }
    }
    payoutBankAccount: BankAccount? with {
      briefly "Bank"
      described as {
        |Payout account.
      }
    }
    performance: PerformanceMetrics with {
      briefly "Performance"
      described as {
        |Metrics.
      }
    }
    approvedAt: TimeStamp with {
      briefly "Approved"
      described as {
        |Approval time.
      }
    }
  } with {
    briefly "Active vendor data"
    described as {
      |State data for an approved and active vendor.
    }
  }
  record SuspendedVendorData is  {
    vendorId: VendorId with {
      briefly "Vendor ID"
      described as {
        |Vendor identifier.
      }
    }
    businessName: BusinessName with {
      briefly "Business"
      described as {
        |Business name.
      }
    }
    storeName: StoreName with {
      briefly "Store"
      described as {
        |Store name.
      }
    }
    reason: String(1,500) with {
      briefly "Reason"
      described as {
        |Suspension reason.
      }
    }
    suspendedAt: TimeStamp with {
      briefly "Suspended"
      described as {
        |Suspension time.
      }
    }
  } with {
    briefly "Suspended vendor data"
    described as {
      |State data for a suspended vendor.
    }
  }
  record TerminatedVendorData is  {
    vendorId: VendorId with {
      briefly "Vendor ID"
      described as {
        |Vendor identifier.
      }
    }
    businessName: BusinessName with {
      briefly "Business"
      described as {
        |Business name.
      }
    }
    reason: String(1,500) with {
      briefly "Reason"
      described as {
        |Termination reason.
      }
    }
    terminatedAt: TimeStamp with {
      briefly "Terminated"
      described as {
        |Termination time.
      }
    }
  } with {
    briefly "Terminated vendor data"
    described as {
      |State data for a terminated vendor.
    }
  }
  // States
  state PendingState of type Vendor.PendingVendorData
  state ActiveState of type Vendor.ActiveVendorData
  state SuspendedState of type Vendor.SuspendedVendorData
  state TerminatedState of type Vendor.TerminatedVendorData
  // Handler
  handler VendorHandler is {
    on command SubmitApplication is {
      morph entity VendorContext.Vendor to state VendorContext.Vendor.PendingState with command SubmitApplication
      tell event ApplicationSubmitted to entity VendorContext.Vendor
    }
    on command ApproveVendor is {
      morph entity VendorContext.Vendor to state VendorContext.Vendor.ActiveState with command ApproveVendor
      tell event VendorApproved to entity VendorContext.Vendor
    }
    on command RejectVendor is {
      morph entity VendorContext.Vendor to state VendorContext.Vendor.TerminatedState with command RejectVendor
      tell event VendorRejected to entity VendorContext.Vendor
    }
    on command UpdateVendorInfo is {
      tell event VendorInfoUpdated to entity VendorContext.Vendor
    }
    on command SetBankAccount is {
      tell event BankAccountSet to entity VendorContext.Vendor
    }
    on command SuspendVendor is {
      morph entity VendorContext.Vendor to state VendorContext.Vendor.SuspendedState with command SuspendVendor
      tell event VendorSuspended to entity VendorContext.Vendor
    }
    on command ReinstateVendor is {
      morph entity VendorContext.Vendor to state VendorContext.Vendor.ActiveState with command ReinstateVendor
      tell event VendorReinstated to entity VendorContext.Vendor
    }
    on command TerminateVendor is {
      morph entity VendorContext.Vendor to state VendorContext.Vendor.TerminatedState with command TerminateVendor
      tell event VendorTerminated to entity VendorContext.Vendor
    }
    on command UpdatePerformance is {
      tell event PerformanceUpdated to entity VendorContext.Vendor
    }
  } with {
    briefly "Processes vendor commands"
    described as {
      | Handles all vendor lifecycle operations including application,
      | approval, suspension, and termination.
    }
  }
} with {
  briefly "Marketplace vendor aggregate"
  described as {
    | The Vendor entity manages marketplace sellers including their
    | application process, profile information, performance tracking,
    | and payout configuration.
  }
}
