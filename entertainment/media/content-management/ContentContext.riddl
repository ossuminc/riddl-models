// Content Management - Content Context
context ContentContext is {
  include "types.riddl"
  include "Content.riddl"
  // Repository for content persistence
  repository ContentRepository is {
    schema ContentData is relational
      of contents as type Content
        index on field Content.contentId
        index on field Content.info.contentType

    handler ContentPersistence is {
      on command Content.CreateContent is {
        prompt "Store content record"
      }
      on command Content.UpdateMetadata is {
        prompt "Update content metadata"
      }
      on command Content.AddAsset is {
        prompt "Store asset reference"
      }
      on command Content.RemoveAsset is {
        prompt "Remove asset reference"
      }
      on command Content.CreateVersion is {
        prompt "Store content version"
      }
      on command Content.AssignRights is {
        prompt "Store rights assignment"
      }
      on command Content.SubmitForReview is {
        prompt "Update status to in review"
      }
      on command Content.ApproveContent is {
        prompt "Update status to approved"
      }
      on command Content.RejectContent is {
        prompt "Update status to rejected"
      }
      on command Content.PublishContent is {
        prompt "Update status to published"
      }
      on command Content.UnpublishContent is {
        prompt "Update status to unpublished"
      }
      on command Content.ArchiveContent is {
        prompt "Update status to archived"
      }
    } with {
      briefly "Persists content commands"
      described as {
        |Handles command-driven persistence.
      }
    }
  } with {
    briefly "Content data persistence"
    described as {
      | The ContentRepository provides persistent storage for
      | content items, assets, and rights.
    }
  }
  // Projector for content analytics
  projector ContentAnalytics is {
    record ContentStats is  {
      contentType: ContentType with {
        briefly "Type"
        described as {
          |Content type.
        }
      }
      totalItems: Natural with {
        briefly "Items"
        described as {
          |Total content items.
        }
      }
      publishedItems: Natural with {
        briefly "Published"
        described as {
          |Published items.
        }
      }
      totalAssets: Natural with {
        briefly "Assets"
        described as {
          |Total assets.
        }
      }
      totalStorageBytes: Natural with {
        briefly "Storage"
        described as {
          |Total storage used.
        }
      }
    } with {
      briefly "Content statistics"
      described as {
        |Content library metrics.
      }
    }
    handler AnalyticsHandler is {
      on event Content.ContentCreated is {
        prompt "Update content counts"
      }
      on event Content.AssetAdded is {
        prompt "Update asset metrics"
      }
      on event Content.ContentPublished is {
        prompt "Update publication metrics"
      }
      on event Content.ContentArchived is {
        prompt "Update archive metrics"
      }
    } with {
      briefly "Maintains content analytics"
      described as {
        |Projects events into analytics views.
      }
    }
  } with {
    briefly "Content analytics projections"
    described as {
      |Maintains content library analytics data.
    }
  }
} with {
  briefly "Bounded context for content management"
  described as {
    | The ContentContext is the bounded context for digital
    | content lifecycle, metadata, and distribution management.
  }
}
