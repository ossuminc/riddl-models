// Content Management - External Contexts
// Media Asset Service
context MediaAssetService is {
  command UploadAsset is  {
    assetId: AssetId with {
      briefly "Asset"
      described as {
        |Asset ID.
      }
    }
    fileName: String(1,200) with {
      briefly "Name"
      described as {
        |File name.
      }
    }
    content: String(1,100000) with {
      briefly "Content"
      described as {
        |File content.
      }
    }
  } with {
    briefly "Upload asset"
    described as {
      |Uploads a media file.
    }
  }
  event AssetUploaded is  {
    assetId: AssetId with {
      briefly "Asset"
      described as {
        |Asset ID.
      }
    }
    url: URL with {
      briefly "URL"
      described as {
        |Asset URL.
      }
    }
    uploadedAt: TimeStamp with {
      briefly "Uploaded"
      described as {
        |Upload time.
      }
    }
  } with {
    briefly "Asset was uploaded"
    described as {
      |Emitted when asset is uploaded.
    }
  }
} with {
  option external()
  briefly "External media asset service"
  described as {
    |External media storage system.
  }
}
// Transcoding Service
context TranscodingService is {
  command TranscodeAsset is  {
    assetId: AssetId with {
      briefly "Asset"
      described as {
        |Asset ID.
      }
    }
    formats: String(1,50)+ with {
      briefly "Formats"
      described as {
        |Output formats.
      }
    }
    qualities: String(1,50)+ with {
      briefly "Qualities"
      described as {
        |Output qualities.
      }
    }
  } with {
    briefly "Transcode asset"
    described as {
      |Converts media to multiple formats.
    }
  }
  event TranscodingCompleted is  {
    assetId: AssetId with {
      briefly "Asset"
      described as {
        |Asset ID.
      }
    }
    outputs: URL+ with {
      briefly "Outputs"
      described as {
        |Output URLs.
      }
    }
    completedAt: TimeStamp with {
      briefly "Completed"
      described as {
        |Completion time.
      }
    }
  } with {
    briefly "Transcoding was completed"
    described as {
      |Emitted when transcoding finishes.
    }
  }
} with {
  option external()
  briefly "External transcoding service"
  described as {
    |External media transcoding system.
  }
}
// CDN Service
context CDNService is {
  command DistributeContent is  {
    contentId: ContentId with {
      briefly "Content"
      described as {
        |Content ID.
      }
    }
    assetUrls: URL+ with {
      briefly "Assets"
      described as {
        |Asset URLs.
      }
    }
    regions: String(1,50)+ with {
      briefly "Regions"
      described as {
        |Target regions.
      }
    }
  } with {
    briefly "Distribute content"
    described as {
      |Pushes content to CDN.
    }
  }
  event ContentDistributed is  {
    contentId: ContentId with {
      briefly "Content"
      described as {
        |Content ID.
      }
    }
    cdnUrls: URL+ with {
      briefly "CDN URLs"
      described as {
        |CDN URLs.
      }
    }
    distributedAt: TimeStamp with {
      briefly "Distributed"
      described as {
        |Distribution time.
      }
    }
  } with {
    briefly "Content was distributed"
    described as {
      |Emitted when content reaches CDN.
    }
  }
} with {
  option external()
  briefly "External CDN service"
  described as {
    |External content delivery network.
  }
}
// Rights Management Service
context RightsService is {
  query CheckRightsClearance is  {
    contentId: ContentId with {
      briefly "Content"
      described as {
        |Content ID.
      }
    }
    territory: String(1,100) with {
      briefly "Territory"
      described as {
        |Target territory.
      }
    }
    channel: DistributionChannel with {
      briefly "Channel"
      described as {
        |Target channel.
      }
    }
  } with {
    briefly "Check rights"
    described as {
      |Verifies distribution rights.
    }
  }
  result RightsClearance is  {
    cleared: Boolean with {
      briefly "Cleared"
      described as {
        |Rights cleared.
      }
    }
    restrictions: String(1,500)* with {
      briefly "Restrictions"
      described as {
        |Any restrictions.
      }
    }
  } with {
    briefly "Rights clearance"
    described as {
      |Rights verification result.
    }
  }
} with {
  option external()
  briefly "External rights service"
  described as {
    |External rights management system.
  }
}
// Search Service
context SearchService is {
  command IndexContent is  {
    contentId: ContentId with {
      briefly "Content"
      described as {
        |Content ID.
      }
    }
    metadata: ContentInfo with {
      briefly "Metadata"
      described as {
        |Content metadata.
      }
    }
  } with {
    briefly "Index content"
    described as {
      |Adds content to search index.
    }
  }
  event ContentIndexed is  {
    contentId: ContentId with {
      briefly "Content"
      described as {
        |Content ID.
      }
    }
    indexedAt: TimeStamp with {
      briefly "Indexed"
      described as {
        |Index time.
      }
    }
  } with {
    briefly "Content was indexed"
    described as {
      |Emitted when content is indexed.
    }
  }
} with {
  option external()
  briefly "External search service"
  described as {
    |External search and discovery system.
  }
}
// Notification Service
context NotificationService is {
  command SendContentNotification is  {
    recipients: UserId+ with {
      briefly "Recipients"
      described as {
        |Notification recipients.
      }
    }
    contentId: ContentId with {
      briefly "Content"
      described as {
        |Content ID.
      }
    }
    notificationType: String(1,50) with {
      briefly "Type"
      described as {
        |Notification type.
      }
    }
    message: String(1,500) with {
      briefly "Message"
      described as {
        |Notification message.
      }
    }
  } with {
    briefly "Send notification"
    described as {
      |Sends content notification.
    }
  }
  event NotificationSent is  {
    notificationId: UUID with {
      briefly "Notification"
      described as {
        |Notification ID.
      }
    }
    sentAt: TimeStamp with {
      briefly "Sent"
      described as {
        |Send time.
      }
    }
  } with {
    briefly "Notification was sent"
    described as {
      |Emitted when notification is delivered.
    }
  }
} with {
  option external()
  briefly "External notification service"
  described as {
    |External communications service.
  }
}
