// Matchmaking - Shared Types

type MatchId is Id(MatchContext.Match) with {
  briefly "Match identifier"
  described by "Unique identifier for a game match."
}

type PlayerId is UUID with {
  briefly "Player identifier"
  described by "Reference to a player."
}

type QueueId is UUID with {
  briefly "Queue identifier"
  described by "Reference to a matchmaking queue."
}

type ServerId is UUID with {
  briefly "Server identifier"
  described by "Reference to a game server."
}

type LobbyId is UUID with {
  briefly "Lobby identifier"
  described by "Reference to a game lobby."
}

type MatchStatus is any of {
  Pending,
  Forming,
  Ready,
  InProgress,
  Completed,
  Cancelled
} with {
  briefly "Match status"
  described by "Current match status."
}

type GameMode is any of {
  Casual,
  Ranked,
  Competitive,
  Custom,
  Tutorial,
  Practice
} with {
  briefly "Game mode"
  described by "Type of game mode."
}

type MatchType is any of {
  OneVsOne,
  TeamVsTeam,
  FreeForAll,
  Cooperative,
  BattleRoyale
} with {
  briefly "Match type"
  described by "Type of match format."
}

type PlayerRank is any of {
  Bronze,
  Silver,
  Gold,
  Platinum,
  Diamond,
  Master,
  Champion
} with {
  briefly "Player rank"
  described by "Player skill rank."
}

type QueueStatus is any of {
  Queued,
  Matched,
  Confirmed,
  Cancelled,
  Expired
} with {
  briefly "Queue status"
  described by "Player queue status."
}

type PlayerProfile is {
  playerId is PlayerId with {
    briefly "Player ID"
    described by "Player identifier."
  }
  displayName is String(1, 50) with {
    briefly "Name"
    described by "Display name."
  }
  skillRating is Decimal(8, 2) with {
    briefly "Skill"
    described by "Skill rating (MMR)."
  }
  rank is PlayerRank with {
    briefly "Rank"
    described by "Player rank."
  }
  gamesPlayed is Natural with {
    briefly "Games"
    described by "Total games played."
  }
  winRate is Decimal(5, 4) with {
    briefly "Win rate"
    described by "Win percentage."
  }
} with {
  briefly "Player profile"
  described by "Player statistics for matching."
}

type QueueEntry is {
  playerId is PlayerId with {
    briefly "Player"
    described by "Queued player."
  }
  profile is PlayerProfile with {
    briefly "Profile"
    described by "Player profile."
  }
  gameMode is GameMode with {
    briefly "Mode"
    described by "Requested mode."
  }
  matchType is MatchType with {
    briefly "Type"
    described by "Match type."
  }
  queuedAt is TimeStamp with {
    briefly "Queued"
    described by "Queue entry time."
  }
  status is QueueStatus with {
    briefly "Status"
    described by "Queue status."
  }
  preferences is optional MatchPreferences with {
    briefly "Preferences"
    described by "Match preferences."
  }
} with {
  briefly "Queue entry"
  described by "Player in matchmaking queue."
}

type MatchPreferences is {
  maxLatency is Natural with {
    briefly "Latency"
    described by "Max acceptable latency."
  }
  preferredRegions is many String(1, 50) with {
    briefly "Regions"
    described by "Preferred server regions."
  }
  skillRange is Decimal(5, 2) with {
    briefly "Skill range"
    described by "Acceptable skill difference."
  }
  partyMembers is many optional PlayerId with {
    briefly "Party"
    described by "Party members to match with."
  }
} with {
  briefly "Match preferences"
  described by "Player matching preferences."
}

type MatchTeam is {
  teamId is UUID with {
    briefly "Team ID"
    described by "Team identifier."
  }
  players is many PlayerId with {
    briefly "Players"
    described by "Team players."
  }
  averageSkill is Decimal(8, 2) with {
    briefly "Avg skill"
    described by "Team average skill."
  }
  side is String(1, 20) with {
    briefly "Side"
    described by "Team side."
  }
} with {
  briefly "Match team"
  described by "Team in a match."
}

type ServerAssignment is {
  serverId is ServerId with {
    briefly "Server"
    described by "Game server."
  }
  region is String(1, 50) with {
    briefly "Region"
    described by "Server region."
  }
  address is String(1, 200) with {
    briefly "Address"
    described by "Server address."
  }
  port is Natural with {
    briefly "Port"
    described by "Server port."
  }
  capacity is Natural with {
    briefly "Capacity"
    described by "Player capacity."
  }
} with {
  briefly "Server assignment"
  described by "Assigned game server."
}

type MatchResult is {
  winningTeam is optional UUID with {
    briefly "Winner"
    described by "Winning team."
  }
  duration is Duration with {
    briefly "Duration"
    described by "Match duration."
  }
  playerStats is many PlayerStats with {
    briefly "Stats"
    described by "Player statistics."
  }
} with {
  briefly "Match result"
  described by "Match outcome details."
}

type PlayerStats is {
  playerId is PlayerId with {
    briefly "Player"
    described by "Player ID."
  }
  score is Natural with {
    briefly "Score"
    described by "Player score."
  }
  kills is Natural with {
    briefly "Kills"
    described by "Kill count."
  }
  deaths is Natural with {
    briefly "Deaths"
    described by "Death count."
  }
  assists is Natural with {
    briefly "Assists"
    described by "Assist count."
  }
  ratingChange is Decimal(6, 2) with {
    briefly "Rating change"
    described by "MMR change."
  }
} with {
  briefly "Player stats"
  described by "Player match statistics."
}
