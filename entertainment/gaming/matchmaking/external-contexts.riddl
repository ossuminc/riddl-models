// Matchmaking - External Contexts

// Queue Service
context QueueService is {

  command AddToQueue is {
    entry is QueueEntry with { briefly "Entry" described by "Queue entry." }
  } with {
    briefly "Add to queue"
    described by "Adds player to matchmaking queue."
  }

  command RemoveFromQueue is {
    playerId is PlayerId with { briefly "Player" described by "Player to remove." }
  } with {
    briefly "Remove from queue"
    described by "Removes player from queue."
  }

  event PlayerQueued is {
    playerId is PlayerId with { briefly "Player" described by "Queued player." }
    queuedAt is TimeStamp with { briefly "Queued" described by "Queue time." }
  } with {
    briefly "Player was queued"
    described by "Emitted when player joins queue."
  }

} with {
  option is external
  briefly "External queue service"
  described by "External matchmaking queue manager."
}

// Server Allocation Service
context ServerAllocationService is {

  command RequestServer is {
    matchId is MatchId with { briefly "Match" described by "Match ID." }
    region is String(1, 50) with { briefly "Region" described by "Preferred region." }
    playerCount is Natural with { briefly "Players" described by "Required capacity." }
  } with {
    briefly "Request server"
    described by "Requests game server allocation."
  }

  event ServerAllocated is {
    matchId is MatchId with { briefly "Match" described by "Match ID." }
    server is ServerAssignment with { briefly "Server" described by "Allocated server." }
    allocatedAt is TimeStamp with { briefly "Allocated" described by "Allocation time." }
  } with {
    briefly "Server was allocated"
    described by "Emitted when server is assigned."
  }

} with {
  option is external
  briefly "External server service"
  described by "External game server allocation."
}

// Player Rating Service
context RatingService is {

  command UpdateRating is {
    playerId is PlayerId with { briefly "Player" described by "Player ID." }
    matchId is MatchId with { briefly "Match" described by "Match ID." }
    ratingChange is Decimal(6, 2) with { briefly "Change" described by "Rating change." }
  } with {
    briefly "Update rating"
    described by "Updates player skill rating."
  }

  event RatingUpdated is {
    playerId is PlayerId with { briefly "Player" described by "Player ID." }
    newRating is Decimal(8, 2) with { briefly "Rating" described by "New rating." }
    updatedAt is TimeStamp with { briefly "Updated" described by "Update time." }
  } with {
    briefly "Rating was updated"
    described by "Emitted when rating changes."
  }

} with {
  option is external
  briefly "External rating service"
  described by "External player rating system."
}

// Anti-Cheat Service
context AntiCheatService is {

  command ValidatePlayer is {
    playerId is PlayerId with { briefly "Player" described by "Player ID." }
    matchId is MatchId with { briefly "Match" described by "Match ID." }
  } with {
    briefly "Validate player"
    described by "Checks player for cheating."
  }

  event PlayerValidated is {
    playerId is PlayerId with { briefly "Player" described by "Player ID." }
    valid is Boolean with { briefly "Valid" described by "Is valid." }
    validatedAt is TimeStamp with { briefly "Validated" described by "Validation time." }
  } with {
    briefly "Player was validated"
    described by "Emitted when validation completes."
  }

} with {
  option is external
  briefly "External anti-cheat service"
  described by "External anti-cheat system."
}

// Notification Service
context NotificationService is {

  command SendMatchNotification is {
    playerId is PlayerId with { briefly "Player" described by "Player ID." }
    matchId is MatchId with { briefly "Match" described by "Match ID." }
    notificationType is String(1, 50) with { briefly "Type" described by "Notification type." }
    message is String(1, 500) with { briefly "Message" described by "Notification message." }
  } with {
    briefly "Send notification"
    described by "Sends match notification."
  }

  event NotificationSent is {
    notificationId is UUID with { briefly "Notification" described by "Notification ID." }
    sentAt is TimeStamp with { briefly "Sent" described by "Send time." }
  } with {
    briefly "Notification was sent"
    described by "Emitted when notification is delivered."
  }

} with {
  option is external
  briefly "External notification service"
  described by "External player notification system."
}
