// Quality Control - Shared Types

type InspectionId is Id(QualityContext.Inspection) with {
  briefly "Inspection identifier"
  described by "Unique identifier for a quality inspection."
}

type SpecificationId is UUID with {
  briefly "Specification identifier"
  described by "Reference to a quality specification."
}

type SampleId is UUID with {
  briefly "Sample identifier"
  described by "Unique identifier for a collected sample."
}

type LotId is UUID with {
  briefly "Lot identifier"
  described by "Reference to a production lot or batch."
}

type BatchId is UUID with {
  briefly "Batch identifier"
  described by "Reference to a process batch."
}

type TestMethodId is UUID with {
  briefly "Test method identifier"
  described by "Reference to a standard test method."
}

type InspectionResult is any of {
  Pass,
  Fail,
  ConditionalPass,
  Pending
} with {
  briefly "Inspection result status"
  described by "Overall result of a quality inspection."
}

type InspectionType is any of {
  Incoming,
  InProcess,
  Final,
  Periodic,
  CustomerReturn
} with {
  briefly "Inspection type"
  described by "Category of quality inspection."
}

type SampleStatus is any of {
  Collected,
  InTransit,
  AtLab,
  Testing,
  Tested,
  Discarded
} with {
  briefly "Sample status"
  described by "Current status of a sample."
}

type TestStatus is any of {
  Scheduled,
  InProgress,
  Completed,
  Cancelled,
  Invalid
} with {
  briefly "Test status"
  described by "Current status of a test."
}

type NCRStatus is any of {
  Open,
  UnderReview,
  DispositionPending,
  Dispositioned,
  Closed
} with {
  briefly "NCR status"
  described by "Current status of non-conformance report."
}

type DispositionType is any of {
  UseAsIs,
  Rework,
  Scrap,
  ReturnToVendor,
  Concession
} with {
  briefly "Disposition type"
  described by "How non-conforming material will be handled."
}

type InspectionPlan is {
  specificationId is SpecificationId with {
    briefly "Specification"
    described by "Quality specification reference."
  }
  specificationName is String(1, 200) with {
    briefly "Name"
    described by "Specification name."
  }
  revisionNumber is String(1, 20) with {
    briefly "Revision"
    described by "Specification revision."
  }
  inspectionType is InspectionType with {
    briefly "Type"
    described by "Type of inspection."
  }
  sampleSizePercent is Decimal(5, 2) with {
    briefly "Sample size"
    described by "Percentage of lot to sample."
  }
  sampleSizeFixed is optional Natural with {
    briefly "Fixed size"
    described by "Fixed number of samples if applicable."
  }
  testMethods is many TestMethodInfo with {
    briefly "Tests"
    described by "Required test methods."
  }
  acceptanceCriteria is String(1, 2000) with {
    briefly "Criteria"
    described by "Overall acceptance criteria."
  }
} with {
  briefly "Inspection plan"
  described by "Quality inspection plan with test requirements."
}

type TestMethodInfo is {
  testMethodId is TestMethodId with {
    briefly "Method"
    described by "Test method identifier."
  }
  testName is String(1, 200) with {
    briefly "Name"
    described by "Test name."
  }
  parameter is String(1, 100) with {
    briefly "Parameter"
    described by "Parameter being measured."
  }
  unitOfMeasure is String(1, 30) with {
    briefly "UOM"
    described by "Unit of measure."
  }
  limits is SpecificationLimit with {
    briefly "Limits"
    described by "Specification limits."
  }
  isCritical is Boolean with {
    briefly "Critical"
    described by "Whether test is critical to quality."
  }
} with {
  briefly "Test method info"
  described by "Details of a required test method."
}

type SpecificationLimit is {
  targetValue is optional Decimal(15, 6) with {
    briefly "Target"
    described by "Target value."
  }
  lowerLimit is optional Decimal(15, 6) with {
    briefly "Lower"
    described by "Lower specification limit."
  }
  upperLimit is optional Decimal(15, 6) with {
    briefly "Upper"
    described by "Upper specification limit."
  }
  lowerControlLimit is optional Decimal(15, 6) with {
    briefly "LCL"
    described by "Lower control limit for SPC."
  }
  upperControlLimit is optional Decimal(15, 6) with {
    briefly "UCL"
    described by "Upper control limit for SPC."
  }
} with {
  briefly "Specification limit"
  described by "Specification and control limits for a parameter."
}

type Sample is {
  sampleId is SampleId with {
    briefly "Sample"
    described by "Sample identifier."
  }
  sampleNumber is String(1, 50) with {
    briefly "Number"
    described by "Sample tracking number."
  }
  lotId is LotId with {
    briefly "Lot"
    described by "Source lot identifier."
  }
  collectionPoint is String(1, 200) with {
    briefly "Collection point"
    described by "Where sample was collected."
  }
  collectedBy is String(1, 200) with {
    briefly "Collected by"
    described by "Person who collected sample."
  }
  collectedAt is TimeStamp with {
    briefly "Collected"
    described by "Collection timestamp."
  }
  quantity is Decimal(10, 4) with {
    briefly "Quantity"
    described by "Sample quantity."
  }
  unitOfMeasure is String(1, 30) with {
    briefly "UOM"
    described by "Unit of measure."
  }
  status is SampleStatus with {
    briefly "Status"
    described by "Current sample status."
  }
  storageConditions is optional String(1, 500) with {
    briefly "Storage"
    described by "Required storage conditions."
  }
} with {
  briefly "Sample"
  described by "Collected sample for quality testing."
}

type TestResult is {
  testMethodId is TestMethodId with {
    briefly "Method"
    described by "Test method identifier."
  }
  sampleId is SampleId with {
    briefly "Sample"
    described by "Tested sample."
  }
  parameter is String(1, 100) with {
    briefly "Parameter"
    described by "Parameter tested."
  }
  measuredValue is Decimal(15, 6) with {
    briefly "Value"
    described by "Measured value."
  }
  unitOfMeasure is String(1, 30) with {
    briefly "UOM"
    described by "Unit of measure."
  }
  withinSpec is Boolean with {
    briefly "In spec"
    described by "Whether result is within specification."
  }
  status is TestStatus with {
    briefly "Status"
    described by "Test status."
  }
  testedBy is String(1, 200) with {
    briefly "Tested by"
    described by "Person who performed test."
  }
  testedAt is TimeStamp with {
    briefly "Tested"
    described by "Test timestamp."
  }
  equipmentId is optional String(1, 100) with {
    briefly "Equipment"
    described by "Test equipment identifier."
  }
  notes is optional String(1, 1000) with {
    briefly "Notes"
    described by "Test notes."
  }
} with {
  briefly "Test result"
  described by "Result of a quality test."
}

type NonConformance is {
  ncrNumber is String(1, 50) with {
    briefly "NCR number"
    described by "Non-conformance report number."
  }
  description is String(1, 2000) with {
    briefly "Description"
    described by "Description of non-conformance."
  }
  defectCategory is String(1, 100) with {
    briefly "Category"
    described by "Defect category."
  }
  severity is String(1, 50) with {
    briefly "Severity"
    described by "Severity level."
  }
  affectedQuantity is Decimal(15, 4) with {
    briefly "Quantity"
    described by "Affected quantity."
  }
  status is NCRStatus with {
    briefly "Status"
    described by "NCR status."
  }
  disposition is optional DispositionType with {
    briefly "Disposition"
    described by "Material disposition."
  }
  dispositionedBy is optional String(1, 200) with {
    briefly "Dispositioned by"
    described by "Person who made disposition."
  }
  dispositionedAt is optional TimeStamp with {
    briefly "Dispositioned"
    described by "Disposition timestamp."
  }
  capaReference is optional String(1, 100) with {
    briefly "CAPA"
    described by "Related CAPA reference."
  }
} with {
  briefly "Non-conformance"
  described by "Quality non-conformance details."
}

type LotInfo is {
  lotId is LotId with {
    briefly "Lot"
    described by "Lot identifier."
  }
  lotNumber is String(1, 50) with {
    briefly "Lot number"
    described by "Lot tracking number."
  }
  batchId is optional BatchId with {
    briefly "Batch"
    described by "Related batch identifier."
  }
  productCode is String(1, 50) with {
    briefly "Product"
    described by "Product code."
  }
  productName is String(1, 200) with {
    briefly "Name"
    described by "Product name."
  }
  quantity is Decimal(15, 4) with {
    briefly "Quantity"
    described by "Lot quantity."
  }
  unitOfMeasure is String(1, 30) with {
    briefly "UOM"
    described by "Unit of measure."
  }
  manufacturingDate is Date with {
    briefly "Manufactured"
    described by "Manufacturing date."
  }
  expirationDate is optional Date with {
    briefly "Expiration"
    described by "Expiration date if applicable."
  }
} with {
  briefly "Lot information"
  described by "Production lot details."
}

type InspectionSummary is {
  totalTests is Natural with {
    briefly "Total tests"
    described by "Number of tests performed."
  }
  passedTests is Natural with {
    briefly "Passed"
    described by "Tests that passed."
  }
  failedTests is Natural with {
    briefly "Failed"
    described by "Tests that failed."
  }
  criticalFailures is Natural with {
    briefly "Critical"
    described by "Critical test failures."
  }
  overallResult is InspectionResult with {
    briefly "Result"
    described by "Overall inspection result."
  }
} with {
  briefly "Inspection summary"
  described by "Summary of inspection results."
}
