// Batch Processing - Shared Types

type BatchId is Id(BatchContext.Batch) with {
  briefly "Batch identifier"
  described by "Unique identifier for a production batch."
}

type RecipeId is UUID with {
  briefly "Recipe identifier"
  described by "Reference to a batch recipe."
}

type IngredientId is UUID with {
  briefly "Ingredient identifier"
  described by "Reference to a raw material ingredient."
}

type VesselId is UUID with {
  briefly "Vessel identifier"
  described by "Reference to a processing vessel or reactor."
}

type LotId is UUID with {
  briefly "Lot identifier"
  described by "Reference to a raw material lot."
}

type PhaseId is UUID with {
  briefly "Phase identifier"
  described by "Reference to a recipe phase."
}

type BatchStatus is any of {
  Scheduled,
  Charging,
  Processing,
  Holding,
  Discharging,
  Completed,
  FailedState
} with {
  briefly "Batch status"
  described by "Current status of the production batch."
}

type HoldReason is any of {
  QualityHold,
  EquipmentIssue,
  MaterialShortage,
  OperatorDecision,
  SafetyHold,
  RegulatoryHold
} with {
  briefly "Hold reason"
  described by "Reason for placing batch on hold."
}

type ParameterType is any of {
  Temperature,
  Pressure,
  FlowRate,
  Level,
  PHLevel,
  Viscosity,
  Density,
  Agitation,
  Duration,
  Weight,
  Volume,
  Concentration
} with {
  briefly "Parameter type"
  described by "Type of process parameter being measured."
}

type Recipe is {
  recipeId is RecipeId with {
    briefly "Recipe ID"
    described by "Recipe identifier."
  }
  recipeName is String(1, 200) with {
    briefly "Name"
    described by "Recipe name."
  }
  recipeVersion is String(1, 20) with {
    briefly "Version"
    described by "Recipe version number."
  }
  productCode is String(1, 50) with {
    briefly "Product code"
    described by "Product being manufactured."
  }
  productName is String(1, 200) with {
    briefly "Product name"
    described by "Name of product."
  }
  targetYield is Decimal(15, 4) with {
    briefly "Target yield"
    described by "Expected output quantity."
  }
  unitOfMeasure is String(1, 20) with {
    briefly "UOM"
    described by "Unit of measure for yield."
  }
  effectiveDate is Date with {
    briefly "Effective date"
    described by "Date recipe became effective."
  }
  expirationDate is optional Date with {
    briefly "Expiration date"
    described by "Date recipe expires."
  }
} with {
  briefly "Recipe definition"
  described by "Master recipe for batch production."
}

type BatchIngredient is {
  ingredientId is IngredientId with {
    briefly "Ingredient ID"
    described by "Ingredient identifier."
  }
  ingredientCode is String(1, 50) with {
    briefly "Code"
    described by "Ingredient material code."
  }
  ingredientName is String(1, 200) with {
    briefly "Name"
    described by "Ingredient name."
  }
  targetQuantity is Decimal(15, 4) with {
    briefly "Target quantity"
    described by "Required quantity per recipe."
  }
  actualQuantity is Decimal(15, 4) with {
    briefly "Actual quantity"
    described by "Quantity actually charged."
  }
  unitOfMeasure is String(1, 20) with {
    briefly "UOM"
    described by "Unit of measure."
  }
  lotId is optional LotId with {
    briefly "Lot ID"
    described by "Raw material lot used."
  }
  lotNumber is optional String(1, 50) with {
    briefly "Lot number"
    described by "Raw material lot number."
  }
  chargeSequence is Natural with {
    briefly "Sequence"
    described by "Order of ingredient addition."
  }
  chargedAt is optional TimeStamp with {
    briefly "Charged at"
    described by "Time ingredient was charged."
  }
  chargedBy is optional String(1, 200) with {
    briefly "Charged by"
    described by "Operator who charged ingredient."
  }
} with {
  briefly "Batch ingredient"
  described by "Ingredient charged to the batch."
}

type ProcessParameter is {
  parameterId is UUID with {
    briefly "Parameter ID"
    described by "Parameter record identifier."
  }
  parameterType is ParameterType with {
    briefly "Type"
    described by "Type of parameter."
  }
  parameterName is String(1, 100) with {
    briefly "Name"
    described by "Parameter name."
  }
  targetValue is Decimal(15, 4) with {
    briefly "Target"
    described by "Target setpoint value."
  }
  actualValue is Decimal(15, 4) with {
    briefly "Actual"
    described by "Actual measured value."
  }
  lowLimit is Decimal(15, 4) with {
    briefly "Low limit"
    described by "Lower specification limit."
  }
  highLimit is Decimal(15, 4) with {
    briefly "High limit"
    described by "Upper specification limit."
  }
  unitOfMeasure is String(1, 20) with {
    briefly "UOM"
    described by "Unit of measure."
  }
  recordedAt is TimeStamp with {
    briefly "Recorded at"
    described by "Time parameter was recorded."
  }
  recordedBy is String(1, 200) with {
    briefly "Recorded by"
    described by "Person or system recording."
  }
  phaseId is optional PhaseId with {
    briefly "Phase"
    described by "Recipe phase for this parameter."
  }
  inSpec is Boolean with {
    briefly "In spec"
    described by "Whether value is within limits."
  }
} with {
  briefly "Process parameter"
  described by "Recorded process parameter value."
}

type BatchGenealogy is {
  batchId is BatchId with {
    briefly "Batch ID"
    described by "This batch identifier."
  }
  parentBatches is many optional BatchId with {
    briefly "Parent batches"
    described by "Source batches if this is a blend."
  }
  childBatches is many optional BatchId with {
    briefly "Child batches"
    described by "Batches derived from this batch."
  }
  rawMaterialLots is many LotId with {
    briefly "Raw material lots"
    described by "All raw material lots used."
  }
  reworkBatchId is optional BatchId with {
    briefly "Rework batch"
    described by "Original batch if this is rework."
  }
} with {
  briefly "Batch genealogy"
  described by "Batch traceability and lineage information."
}

type VesselInfo is {
  vesselId is VesselId with {
    briefly "Vessel ID"
    described by "Vessel identifier."
  }
  vesselName is String(1, 100) with {
    briefly "Name"
    described by "Vessel name or tag."
  }
  vesselType is String(1, 50) with {
    briefly "Type"
    described by "Type of vessel (reactor, tank, etc.)."
  }
  capacity is Decimal(15, 4) with {
    briefly "Capacity"
    described by "Vessel working capacity."
  }
  capacityUOM is String(1, 20) with {
    briefly "Capacity UOM"
    described by "Unit of measure for capacity."
  }
} with {
  briefly "Vessel information"
  described by "Processing vessel details."
}

type RecipePhase is {
  phaseId is PhaseId with {
    briefly "Phase ID"
    described by "Phase identifier."
  }
  phaseName is String(1, 100) with {
    briefly "Name"
    described by "Phase name."
  }
  phaseSequence is Natural with {
    briefly "Sequence"
    described by "Phase execution order."
  }
  targetDuration is Natural with {
    briefly "Duration"
    described by "Target duration in minutes."
  }
  actualDuration is optional Natural with {
    briefly "Actual duration"
    described by "Actual duration in minutes."
  }
  startedAt is optional TimeStamp with {
    briefly "Started"
    described by "Phase start time."
  }
  completedAt is optional TimeStamp with {
    briefly "Completed"
    described by "Phase completion time."
  }
  status is String(1, 20) with {
    briefly "Status"
    described by "Phase status."
  }
} with {
  briefly "Recipe phase"
  described by "Phase within batch recipe execution."
}

type BatchScheduleInfo is {
  plannedStart is TimeStamp with {
    briefly "Planned start"
    described by "Scheduled start time."
  }
  plannedEnd is TimeStamp with {
    briefly "Planned end"
    described by "Scheduled end time."
  }
  actualStart is optional TimeStamp with {
    briefly "Actual start"
    described by "Actual start time."
  }
  actualEnd is optional TimeStamp with {
    briefly "Actual end"
    described by "Actual end time."
  }
} with {
  briefly "Batch schedule"
  described by "Batch timing information."
}

type BatchYieldInfo is {
  targetYield is Decimal(15, 4) with {
    briefly "Target yield"
    described by "Expected output quantity."
  }
  actualYield is Decimal(15, 4) with {
    briefly "Actual yield"
    described by "Actual output quantity."
  }
  yieldPercent is Decimal(5, 2) with {
    briefly "Yield percent"
    described by "Yield as percentage of target."
  }
  wasteQuantity is Decimal(15, 4) with {
    briefly "Waste"
    described by "Waste or loss quantity."
  }
  unitOfMeasure is String(1, 20) with {
    briefly "UOM"
    described by "Unit of measure."
  }
} with {
  briefly "Batch yield"
  described by "Batch output quantity information."
}

type BatchHoldInfo is {
  holdReason is HoldReason with {
    briefly "Reason"
    described by "Reason for hold."
  }
  holdDescription is String(1, 500) with {
    briefly "Description"
    described by "Detailed hold description."
  }
  heldBy is String(1, 200) with {
    briefly "Held by"
    described by "Person placing hold."
  }
  heldAt is TimeStamp with {
    briefly "Held at"
    described by "Time hold was placed."
  }
  releasedBy is optional String(1, 200) with {
    briefly "Released by"
    described by "Person releasing hold."
  }
  releasedAt is optional TimeStamp with {
    briefly "Released at"
    described by "Time hold was released."
  }
  releaseNotes is optional String(1, 1000) with {
    briefly "Release notes"
    described by "Notes on hold release."
  }
} with {
  briefly "Batch hold"
  described by "Batch hold information."
}

type DischargeInfo is {
  destinationType is String(1, 50) with {
    briefly "Destination type"
    described by "Type of destination (tank, container, etc.)."
  }
  destinationId is String(1, 100) with {
    briefly "Destination ID"
    described by "Identifier of destination."
  }
  quantity is Decimal(15, 4) with {
    briefly "Quantity"
    described by "Quantity discharged."
  }
  unitOfMeasure is String(1, 20) with {
    briefly "UOM"
    described by "Unit of measure."
  }
  dischargedAt is TimeStamp with {
    briefly "Discharged at"
    described by "Time of discharge."
  }
  dischargedBy is String(1, 200) with {
    briefly "Discharged by"
    described by "Person performing discharge."
  }
} with {
  briefly "Discharge information"
  described by "Batch discharge details."
}

type CompletionInfo is {
  completedBy is String(1, 200) with {
    briefly "Completed by"
    described by "Person completing batch."
  }
  completedAt is TimeStamp with {
    briefly "Completed at"
    described by "Completion time."
  }
  yieldInfo is BatchYieldInfo with {
    briefly "Yield"
    described by "Final yield information."
  }
  qualityStatus is String(1, 50) with {
    briefly "Quality status"
    described by "Quality disposition status."
  }
  notes is optional String(1, 1000) with {
    briefly "Notes"
    described by "Completion notes."
  }
} with {
  briefly "Completion information"
  described by "Batch completion details."
}

type RejectionInfo is {
  rejectedBy is String(1, 200) with {
    briefly "Rejected by"
    described by "Person rejecting batch."
  }
  rejectedAt is TimeStamp with {
    briefly "Rejected at"
    described by "Rejection time."
  }
  rejectionReason is String(1, 500) with {
    briefly "Reason"
    described by "Reason for rejection."
  }
  dispositionCode is String(1, 50) with {
    briefly "Disposition"
    described by "Disposition code."
  }
  reworkable is Boolean with {
    briefly "Reworkable"
    described by "Whether batch can be reworked."
  }
} with {
  briefly "Rejection information"
  described by "Batch rejection details."
}
