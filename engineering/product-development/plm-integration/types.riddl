// PLM Integration - Shared Types
type IntegrationId is Id(IntegrationContext.Integration)  with {
  briefly "Integration identifier"
  described as {
    |Unique identifier for an integration.
  }
}
type ProductId is UUID with {
  briefly "Product identifier"
  described as {
    |Reference to a product in PLM.
  }
}
type PartId is UUID with {
  briefly "Part identifier"
  described as {
    |Reference to a part/component.
  }
}
type DocumentId is UUID with {
  briefly "Document identifier"
  described as {
    |Reference to a PLM document.
  }
}
type SyncJobId is UUID with {
  briefly "Sync job identifier"
  described as {
    |Reference to a sync job.
  }
}
type SystemId is UUID with {
  briefly "System identifier"
  described as {
    |Reference to an integrated system.
  }
}
type IntegrationType is any of {
  Unidirectional,
  Bidirectional,
  EventDriven,
  Batch,
  RealTime
} with {
  briefly "Integration type"
  described as {
    |Type of integration pattern.
  }
}
type SyncStatus is any of {
  Pending,
  InProgress,
  Completed,
  Failed,
  PartialSuccess,
  Cancelled
} with {
  briefly "Sync status"
  described as {
    |Synchronization job status.
  }
}
type DataEntityType is any of {
  Product,
  Part,
  BOM,
  Document,
  CADFile,
  Specification,
  ChangeOrder,
  Release
} with {
  briefly "Data entity type"
  described as {
    |Type of PLM data entity.
  }
}
type ChangeType is any of {
  Created,
  Updated,
  Deleted,
  Released,
  Revised,
  Obsoleted
} with {
  briefly "Change type"
  described as {
    |Type of data change.
  }
}
type IntegrationConfig is {
  integrationId: IntegrationId with {
    briefly "Integration ID"
    described as {
      |Integration identifier.
    }
  }
  name: String(1,200) with {
    briefly "Name"
    described as {
      |Integration name.
    }
  }
  sourceSystemId: SystemId with {
    briefly "Source"
    described as {
      |Source system.
    }
  }
  targetSystemId: SystemId with {
    briefly "Target"
    described as {
      |Target system.
    }
  }
  integrationType: IntegrationType with {
    briefly "Type"
    described as {
      |Integration type.
    }
  }
  entityTypes: DataEntityType+ with {
    briefly "Entities"
    described as {
      |Supported entity types.
    }
  }
  mappings: FieldMapping+ with {
    briefly "Mappings"
    described as {
      |Field mappings.
    }
  }
  schedule: SyncSchedule? with {
    briefly "Schedule"
    described as {
      |Sync schedule.
    }
  }
  enabled: Boolean with {
    briefly "Enabled"
    described as {
      |Is integration active.
    }
  }
} with {
  briefly "Integration configuration"
  described as {
    |Integration setup and mappings.
  }
}
type ConnectedSystem is {
  systemId: SystemId with {
    briefly "System ID"
    described as {
      |System identifier.
    }
  }
  name: String(1,200) with {
    briefly "Name"
    described as {
      |System name.
    }
  }
  systemType: SystemType with {
    briefly "Type"
    described as {
      |System type.
    }
  }
  connectionConfig: ConnectionConfig with {
    briefly "Connection"
    described as {
      |Connection configuration.
    }
  }
  connectionStatus: ConnectionStatus with {
    briefly "Status"
    described as {
      |Connection status.
    }
  }
} with {
  briefly "Connected system"
  described as {
    |External system connection.
  }
}
type SystemType is any of {
  PLM,
  ERP,
  CAD,
  PDM,
  MES,
  SCM,
  CRM
} with {
  briefly "System type"
  described as {
    |Type of enterprise system.
  }
}
type ConnectionConfig is {
  endpoint: URL with {
    briefly "Endpoint"
    described as {
      |System endpoint.
    }
  }
  authType: AuthType with {
    briefly "Auth type"
    described as {
      |Authentication type.
    }
  }
  timeout: Duration with {
    briefly "Timeout"
    described as {
      |Connection timeout.
    }
  }
  retryPolicy: RetryPolicy with {
    briefly "Retry"
    described as {
      |Retry policy.
    }
  }
} with {
  briefly "Connection configuration"
  described as {
    |System connection settings.
  }
}
type AuthType is any of {
  APIKey,
  OAuth2,
  BasicAuth,
  Certificate,
  SAML
} with {
  briefly "Auth type"
  described as {
    |Authentication method.
  }
}
type RetryPolicy is {
  maxRetries: Natural with {
    briefly "Max retries"
    described as {
      |Maximum retry attempts.
    }
  }
  retryDelay: Duration with {
    briefly "Delay"
    described as {
      |Delay between retries.
    }
  }
  backoffMultiplier: Decimal(3,2) with {
    briefly "Backoff"
    described as {
      |Exponential backoff factor.
    }
  }
} with {
  briefly "Retry policy"
  described as {
    |Retry behavior configuration.
  }
}
type ConnectionStatus is any of {
  Connected,
  Disconnected,
  Degraded,
  Maintenance,
  Error
} with {
  briefly "Connection status"
  described as {
    |System connection status.
  }
}
type FieldMapping is {
  sourceField: String(1,200) with {
    briefly "Source"
    described as {
      |Source field path.
    }
  }
  targetField: String(1,200) with {
    briefly "Target"
    described as {
      |Target field path.
    }
  }
  transformation: TransformRule? with {
    briefly "Transform"
    described as {
      |Transformation rule.
    }
  }
  required: Boolean with {
    briefly "Required"
    described as {
      |Is field required.
    }
  }
} with {
  briefly "Field mapping"
  described as {
    |Source to target field mapping.
  }
}
type TransformRule is {
  ruleType: TransformType with {
    briefly "Type"
    described as {
      |Transform type.
    }
  }
  expression: String(1,1000) with {
    briefly "Expression"
    described as {
      |Transform expression.
    }
  }
} with {
  briefly "Transform rule"
  described as {
    |Data transformation rule.
  }
}
type TransformType is any of {
  DirectMapping,
  ValueMapping,
  Concatenation,
  Calculation,
  Lookup,
  Custom
} with {
  briefly "Transform type"
  described as {
    |Type of transformation.
  }
}
type SyncSchedule is {
  frequency: SyncFrequency with {
    briefly "Frequency"
    described as {
      |Sync frequency.
    }
  }
  timeOfDay: Time? with {
    briefly "Time"
    described as {
      |Scheduled time.
    }
  }
  daysOfWeek: Natural* with {
    briefly "Days"
    described as {
      |Days of week (1-7).
    }
  }
} with {
  briefly "Sync schedule"
  described as {
    |Synchronization schedule.
  }
}
type SyncFrequency is any of {
  RealTime,
  Hourly,
  Daily,
  Weekly,
  Monthly,
  OnDemand
} with {
  briefly "Sync frequency"
  described as {
    |How often to sync.
  }
}
type SyncJob is {
  jobId: SyncJobId with {
    briefly "Job ID"
    described as {
      |Job identifier.
    }
  }
  integrationId: IntegrationId with {
    briefly "Integration"
    described as {
      |Parent integration.
    }
  }
  status: SyncStatus with {
    briefly "Status"
    described as {
      |Job status.
    }
  }
  startedAt: TimeStamp with {
    briefly "Started"
    described as {
      |Start time.
    }
  }
  completedAt: TimeStamp? with {
    briefly "Completed"
    described as {
      |Completion time.
    }
  }
  recordsProcessed: Natural with {
    briefly "Processed"
    described as {
      |Records processed.
    }
  }
  recordsFailed: Natural with {
    briefly "Failed"
    described as {
      |Records failed.
    }
  }
  errors: SyncError* with {
    briefly "Errors"
    described as {
      |Sync errors.
    }
  }
} with {
  briefly "Sync job"
  described as {
    |Data synchronization job.
  }
}
type SyncError is {
  errorCode: String(1,50) with {
    briefly "Code"
    described as {
      |Error code.
    }
  }
  message: String(1,500) with {
    briefly "Message"
    described as {
      |Error message.
    }
  }
  affectedEntityId: String(1,100)? with {
    briefly "Entity"
    described as {
      |Affected entity ID.
    }
  }
  timestamp: TimeStamp with {
    briefly "Time"
    described as {
      |Error time.
    }
  }
} with {
  briefly "Sync error"
  described as {
    |Synchronization error.
  }
}
type DataChangeEvent is {
  eventId: UUID with {
    briefly "Event ID"
    described as {
      |Event identifier.
    }
  }
  sourceSystem: SystemId with {
    briefly "Source"
    described as {
      |Source system.
    }
  }
  entityType: DataEntityType with {
    briefly "Entity type"
    described as {
      |Type of entity.
    }
  }
  entityId: String(1,100) with {
    briefly "Entity ID"
    described as {
      |Entity identifier.
    }
  }
  changeType: ChangeType with {
    briefly "Change"
    described as {
      |Type of change.
    }
  }
  changedAt: TimeStamp with {
    briefly "Changed"
    described as {
      |Change timestamp.
    }
  }
  changedBy: String(1,100)? with {
    briefly "Changed by"
    described as {
      |User who made change.
    }
  }
} with {
  briefly "Data change event"
  described as {
    |PLM data change notification.
  }
}
