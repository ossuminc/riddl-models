// PLM Integration - Shared Types

type IntegrationId is Id(IntegrationContext.Integration) with {
  briefly "Integration identifier"
  described by "Unique identifier for an integration."
}

type ProductId is UUID with {
  briefly "Product identifier"
  described by "Reference to a product in PLM."
}

type PartId is UUID with {
  briefly "Part identifier"
  described by "Reference to a part/component."
}

type DocumentId is UUID with {
  briefly "Document identifier"
  described by "Reference to a PLM document."
}

type SyncJobId is UUID with {
  briefly "Sync job identifier"
  described by "Reference to a sync job."
}

type SystemId is UUID with {
  briefly "System identifier"
  described by "Reference to an integrated system."
}

type IntegrationType is any of {
  Unidirectional,
  Bidirectional,
  EventDriven,
  Batch,
  RealTime
} with {
  briefly "Integration type"
  described by "Type of integration pattern."
}

type SyncStatus is any of {
  Pending,
  InProgress,
  Completed,
  Failed,
  PartialSuccess,
  Cancelled
} with {
  briefly "Sync status"
  described by "Synchronization job status."
}

type DataEntityType is any of {
  Product,
  Part,
  BOM,
  Document,
  CADFile,
  Specification,
  ChangeOrder,
  Release
} with {
  briefly "Data entity type"
  described by "Type of PLM data entity."
}

type ChangeType is any of {
  Created,
  Updated,
  Deleted,
  Released,
  Revised,
  Obsoleted
} with {
  briefly "Change type"
  described by "Type of data change."
}

type IntegrationConfig is {
  integrationId is IntegrationId with {
    briefly "Integration ID"
    described by "Integration identifier."
  }
  name is String(1, 200) with {
    briefly "Name"
    described by "Integration name."
  }
  sourceSystemId is SystemId with {
    briefly "Source"
    described by "Source system."
  }
  targetSystemId is SystemId with {
    briefly "Target"
    described by "Target system."
  }
  integrationType is IntegrationType with {
    briefly "Type"
    described by "Integration type."
  }
  entityTypes is many DataEntityType with {
    briefly "Entities"
    described by "Supported entity types."
  }
  mappings is many FieldMapping with {
    briefly "Mappings"
    described by "Field mappings."
  }
  schedule is optional SyncSchedule with {
    briefly "Schedule"
    described by "Sync schedule."
  }
  enabled is Boolean with {
    briefly "Enabled"
    described by "Is integration active."
  }
} with {
  briefly "Integration configuration"
  described by "Integration setup and mappings."
}

type ConnectedSystem is {
  systemId is SystemId with {
    briefly "System ID"
    described by "System identifier."
  }
  name is String(1, 200) with {
    briefly "Name"
    described by "System name."
  }
  systemType is SystemType with {
    briefly "Type"
    described by "System type."
  }
  connectionConfig is ConnectionConfig with {
    briefly "Connection"
    described by "Connection configuration."
  }
  status is ConnectionStatus with {
    briefly "Status"
    described by "Connection status."
  }
} with {
  briefly "Connected system"
  described by "External system connection."
}

type SystemType is any of {
  PLM,
  ERP,
  CAD,
  PDM,
  MES,
  SCM,
  CRM
} with {
  briefly "System type"
  described by "Type of enterprise system."
}

type ConnectionConfig is {
  endpoint is URL with {
    briefly "Endpoint"
    described by "System endpoint."
  }
  authType is AuthType with {
    briefly "Auth type"
    described by "Authentication type."
  }
  timeout is Duration with {
    briefly "Timeout"
    described by "Connection timeout."
  }
  retryPolicy is RetryPolicy with {
    briefly "Retry"
    described by "Retry policy."
  }
} with {
  briefly "Connection configuration"
  described by "System connection settings."
}

type AuthType is any of {
  APIKey,
  OAuth2,
  BasicAuth,
  Certificate,
  SAML
} with {
  briefly "Auth type"
  described by "Authentication method."
}

type RetryPolicy is {
  maxRetries is Natural with {
    briefly "Max retries"
    described by "Maximum retry attempts."
  }
  retryDelay is Duration with {
    briefly "Delay"
    described by "Delay between retries."
  }
  backoffMultiplier is Decimal(3, 2) with {
    briefly "Backoff"
    described by "Exponential backoff factor."
  }
} with {
  briefly "Retry policy"
  described by "Retry behavior configuration."
}

type ConnectionStatus is any of {
  Connected,
  Disconnected,
  Degraded,
  Maintenance,
  Error
} with {
  briefly "Connection status"
  described by "System connection status."
}

type FieldMapping is {
  sourceField is String(1, 200) with {
    briefly "Source"
    described by "Source field path."
  }
  targetField is String(1, 200) with {
    briefly "Target"
    described by "Target field path."
  }
  transformation is optional TransformRule with {
    briefly "Transform"
    described by "Transformation rule."
  }
  required is Boolean with {
    briefly "Required"
    described by "Is field required."
  }
} with {
  briefly "Field mapping"
  described by "Source to target field mapping."
}

type TransformRule is {
  ruleType is TransformType with {
    briefly "Type"
    described by "Transform type."
  }
  expression is String(1, 1000) with {
    briefly "Expression"
    described by "Transform expression."
  }
} with {
  briefly "Transform rule"
  described by "Data transformation rule."
}

type TransformType is any of {
  DirectMapping,
  ValueMapping,
  Concatenation,
  Calculation,
  Lookup,
  Custom
} with {
  briefly "Transform type"
  described by "Type of transformation."
}

type SyncSchedule is {
  frequency is SyncFrequency with {
    briefly "Frequency"
    described by "Sync frequency."
  }
  timeOfDay is optional Time with {
    briefly "Time"
    described by "Scheduled time."
  }
  daysOfWeek is many optional Natural with {
    briefly "Days"
    described by "Days of week (1-7)."
  }
} with {
  briefly "Sync schedule"
  described by "Synchronization schedule."
}

type SyncFrequency is any of {
  RealTime,
  Hourly,
  Daily,
  Weekly,
  Monthly,
  OnDemand
} with {
  briefly "Sync frequency"
  described by "How often to sync."
}

type SyncJob is {
  jobId is SyncJobId with {
    briefly "Job ID"
    described by "Job identifier."
  }
  integrationId is IntegrationId with {
    briefly "Integration"
    described by "Parent integration."
  }
  status is SyncStatus with {
    briefly "Status"
    described by "Job status."
  }
  startedAt is TimeStamp with {
    briefly "Started"
    described by "Start time."
  }
  completedAt is optional TimeStamp with {
    briefly "Completed"
    described by "Completion time."
  }
  recordsProcessed is Natural with {
    briefly "Processed"
    described by "Records processed."
  }
  recordsFailed is Natural with {
    briefly "Failed"
    described by "Records failed."
  }
  errors is many optional SyncError with {
    briefly "Errors"
    described by "Sync errors."
  }
} with {
  briefly "Sync job"
  described by "Data synchronization job."
}

type SyncError is {
  errorCode is String(1, 50) with {
    briefly "Code"
    described by "Error code."
  }
  message is String(1, 500) with {
    briefly "Message"
    described by "Error message."
  }
  entityId is optional String(1, 100) with {
    briefly "Entity"
    described by "Affected entity ID."
  }
  timestamp is TimeStamp with {
    briefly "Time"
    described by "Error time."
  }
} with {
  briefly "Sync error"
  described by "Synchronization error."
}

type DataChangeEvent is {
  eventId is UUID with {
    briefly "Event ID"
    described by "Event identifier."
  }
  sourceSystem is SystemId with {
    briefly "Source"
    described by "Source system."
  }
  entityType is DataEntityType with {
    briefly "Entity type"
    described by "Type of entity."
  }
  entityId is String(1, 100) with {
    briefly "Entity ID"
    described by "Entity identifier."
  }
  changeType is ChangeType with {
    briefly "Change"
    described by "Type of change."
  }
  changedAt is TimeStamp with {
    briefly "Changed"
    described by "Change timestamp."
  }
  changedBy is optional String(1, 100) with {
    briefly "Changed by"
    described by "User who made change."
  }
} with {
  briefly "Data change event"
  described by "PLM data change notification."
}
