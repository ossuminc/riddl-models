// Process Manager Pattern
// Replace {ProcessName} with your process name (e.g., OrderFulfillment)

entity {ProcessName}Manager is {
  briefly "Process manager that coordinates {ProcessName} workflow"

  // Track process state
  type {ProcessName}State is one of { NotStarted, InProgress, Completed, Failed }
  type {ProcessName}Id is Id({ProcessName}Manager)

  state Tracking is {
    processId: {ProcessName}Id,
    currentState: {ProcessName}State
    // TODO: Add tracking data
  }

  handler {ProcessName}Handler is {
    // React to triggering event
    on event {ProcessName}Triggered {
      set field state.currentState to {ProcessName}State.InProgress
      // TODO: send command StartStep1 to entity Step1Handler
    }

    // React to step completion
    on event Step1Completed {
      // TODO: send command StartStep2 to entity Step2Handler
      ???
    }

    // Handle completion
    on event Step2Completed {
      set field state.currentState to {ProcessName}State.Completed
      send event {ProcessName}Completed to outlet Events
    }

    // Handle failures
    on event StepFailed {
      set field state.currentState to {ProcessName}State.Failed
      // TODO: send command Compensate to entity CompensationHandler
    }
  }
}