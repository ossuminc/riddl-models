// Projector Example: Order Dashboard View

domain Commerce is {
  context Orders is {
    type OrderId is Id(Order)
    type CustomerId is Id(Customer)

    entity Order is { ??? }
    entity Customer is { ??? }

    // Events that the projector consumes
    event OrderCreated is {
      orderId: OrderId,
      customerId: CustomerId,
      customerName: String,
      createdAt: TimeStamp
    }
    event OrderItemAdded is {
      orderId: OrderId,
      itemCount: Integer,
      total: Decimal
    }
    event OrderItemRemoved is {
      orderId: OrderId,
      itemCount: Integer,
      total: Decimal
    }
    event OrderConfirmed is {
      orderId: OrderId,
      confirmedAt: TimeStamp
    }
    event OrderShipped is {
      orderId: OrderId,
      shippedAt: TimeStamp
    }
    event OrderDelivered is {
      orderId: OrderId,
      deliveredAt: TimeStamp
    }
    event OrderCancelled is {
      orderId: OrderId,
      cancelledAt: TimeStamp
    }

    projector OrderDashboard is {
      briefly "Read model for order dashboard showing order summaries"

      record OrderSummary is {
        orderId: OrderId,
        customerId: CustomerId,
        customerName: String,
        status: String,
        itemCount: Integer,
        totalAmount: Decimal,
        createdAt: TimeStamp,
        lastUpdatedAt: TimeStamp
      }

      handler DashboardHandler is {
        on event OrderCreated {
          "Insert new order summary record"
          ???
        }
        on event OrderItemAdded {
          "Update item count and total amount"
          ???
        }
        on event OrderItemRemoved {
          "Update item count and total amount"
          ???
        }
        on event OrderConfirmed {
          "Update status to confirmed"
          ???
        }
        on event OrderShipped {
          "Update status to shipped"
          ???
        }
        on event OrderDelivered {
          "Update status to delivered"
          ???
        }
        on event OrderCancelled {
          "Update status to cancelled or remove record"
          ???
        }
      }
    }
  }
}