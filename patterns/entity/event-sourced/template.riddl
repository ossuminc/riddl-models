// Event-Sourced Entity Pattern
// Replace {EntityName} with your actual entity name (e.g., Order, Account)

entity {EntityName} is {
  option event-sourced
  briefly "An event-sourced {EntityName} entity"

  // Identity type
  type {EntityName}Id is Id({EntityName})

  // Commands (requests to change state)
  command Create{EntityName} is {
    id: {EntityName}Id
    // TODO: Add creation fields
  }
  command Update{EntityName} is {
    id: {EntityName}Id
    // TODO: Add fields to update
  }
  command Delete{EntityName} is {
    id: {EntityName}Id
  }

  // Events (facts about what happened)
  event {EntityName}Created is {
    id: {EntityName}Id,
    createdAt: TimeStamp
    // TODO: Add creation fields
  }
  event {EntityName}Updated is {
    id: {EntityName}Id,
    updatedAt: TimeStamp
    // TODO: Add updated fields
  }
  event {EntityName}Deleted is {
    id: {EntityName}Id,
    deletedAt: TimeStamp
  }

  // State (current view derived from events)
  state Active is {
    id: {EntityName}Id,
    createdAt: TimeStamp,
    updatedAt: TimeStamp
    // TODO: Add state fields
  }

  state Deleted is {
    id: {EntityName}Id,
    deletedAt: TimeStamp
  }

  // Handler processes commands and emits events
  handler {EntityName}Handler is {
    on command Create{EntityName} {
      // TODO: Validate and create
      send event {EntityName}Created to outlet Events
    }
    on command Update{EntityName} {
      // TODO: Validate and update
      send event {EntityName}Updated to outlet Events
    }
    on command Delete{EntityName} {
      morph entity {EntityName} to state Deleted
      send event {EntityName}Deleted to outlet Events
    }
  }
}