// Billing Settlement - Shared Types

type BillingAccountId is Id(BillingSettlementContext.BillingAccount) with {
  briefly "Billing account identifier"
  described by "Unique identifier for a billing account."
}

type MeterId is UUID with {
  briefly "Meter identifier"
  described by "Reference to a utility meter."
}

type CustomerId is UUID with {
  briefly "Customer identifier"
  described by "Reference to a utility customer."
}

type SupplierId is UUID with {
  briefly "Supplier identifier"
  described by "Reference to an energy supplier."
}

type InvoiceId is UUID with {
  briefly "Invoice identifier"
  described by "Reference to an invoice."
}

type AccountStatus is any of {
  Active,
  Suspended,
  Closed,
  PendingBill,
  InDispute,
  InSettlement
} with {
  briefly "Account status"
  described by "Billing account status."
}

type MeterReadingType is any of {
  Actual,
  Estimated,
  CustomerReported,
  Adjusted
} with {
  briefly "Meter reading type"
  described by "Type of meter reading source."
}

type RateCategory is any of {
  Residential,
  Commercial,
  Industrial,
  Agricultural,
  TimeOfUse,
  Tiered
} with {
  briefly "Rate category"
  described by "Category of rate schedule applied."
}

type PaymentMethod is any of {
  BankTransfer,
  CreditCard,
  DirectDebit,
  Check,
  Online
} with {
  briefly "Payment method"
  described by "Method of payment used."
}

type SettlementStatus is any of {
  Pending,
  Calculated,
  Submitted,
  Confirmed,
  Disputed,
  Reconciled
} with {
  briefly "Settlement status"
  described by "Status of supplier settlement."
}

type MeterReading is {
  meterId is MeterId with {
    briefly "Meter"
    described by "Meter identifier."
  }
  readingValue is Decimal(12, 3) with {
    briefly "Reading"
    described by "Meter reading value in kWh."
  }
  readingType is MeterReadingType with {
    briefly "Type"
    described by "Reading type."
  }
  readingDate is Date with {
    briefly "Date"
    described by "Date of reading."
  }
  validated is Boolean with {
    briefly "Validated"
    described by "Whether reading passed validation."
  }
} with {
  briefly "Meter reading"
  described by "A single meter reading record."
}

type UsageCalculation is {
  periodStart is Date with {
    briefly "Start"
    described by "Billing period start date."
  }
  periodEnd is Date with {
    briefly "End"
    described by "Billing period end date."
  }
  totalUsageKwh is Decimal(12, 3) with {
    briefly "Usage"
    described by "Total usage in kWh."
  }
  peakUsageKwh is optional Decimal(12, 3) with {
    briefly "Peak"
    described by "Peak period usage in kWh."
  }
  offPeakUsageKwh is optional Decimal(12, 3) with {
    briefly "Off-peak"
    described by "Off-peak period usage in kWh."
  }
} with {
  briefly "Usage calculation"
  described by "Calculated usage for a billing period."
}

type RateSchedule is {
  rateCategory is RateCategory with {
    briefly "Category"
    described by "Rate category."
  }
  baseRate is Decimal(8, 4) with {
    briefly "Base rate"
    described by "Base rate per kWh."
  }
  peakRate is optional Decimal(8, 4) with {
    briefly "Peak rate"
    described by "Peak period rate per kWh."
  }
  offPeakRate is optional Decimal(8, 4) with {
    briefly "Off-peak rate"
    described by "Off-peak period rate per kWh."
  }
  fixedCharge is Decimal(8, 2) with {
    briefly "Fixed charge"
    described by "Monthly fixed service charge."
  }
  effectiveDate is Date with {
    briefly "Effective"
    described by "Rate effective date."
  }
} with {
  briefly "Rate schedule"
  described by "Rate schedule for billing calculations."
}

type LineItem is {
  description is String(3, 200) with {
    briefly "Description"
    described by "Charge description."
  }
  quantity is Decimal(12, 3) with {
    briefly "Quantity"
    described by "Usage quantity."
  }
  unitRate is Decimal(8, 4) with {
    briefly "Rate"
    described by "Rate applied."
  }
  amount is Decimal(10, 2) with {
    briefly "Amount"
    described by "Line item amount."
  }
} with {
  briefly "Line item"
  described by "A single charge line item on an invoice."
}

type InvoiceSummary is {
  invoiceId is InvoiceId with {
    briefly "Invoice"
    described by "Invoice identifier."
  }
  billingPeriodStart is Date with {
    briefly "Period start"
    described by "Billing period start."
  }
  billingPeriodEnd is Date with {
    briefly "Period end"
    described by "Billing period end."
  }
  lineItems is many LineItem with {
    briefly "Items"
    described by "Charge line items."
  }
  subtotal is Decimal(10, 2) with {
    briefly "Subtotal"
    described by "Subtotal before taxes."
  }
  taxAmount is Decimal(10, 2) with {
    briefly "Tax"
    described by "Tax amount."
  }
  totalAmount is Decimal(10, 2) with {
    briefly "Total"
    described by "Total amount due."
  }
  dueDate is Date with {
    briefly "Due"
    described by "Payment due date."
  }
} with {
  briefly "Invoice summary"
  described by "Summary of a generated invoice."
}

type PaymentRecord is {
  paymentId is UUID with {
    briefly "Payment ID"
    described by "Payment identifier."
  }
  invoiceId is InvoiceId with {
    briefly "Invoice"
    described by "Invoice being paid."
  }
  amount is Decimal(10, 2) with {
    briefly "Amount"
    described by "Payment amount."
  }
  method is PaymentMethod with {
    briefly "Method"
    described by "Payment method."
  }
  paidAt is TimeStamp with {
    briefly "Paid"
    described by "Payment timestamp."
  }
  confirmed is Boolean with {
    briefly "Confirmed"
    described by "Payment confirmed."
  }
} with {
  briefly "Payment record"
  described by "Record of a payment received."
}

type SupplierSettlement is {
  settlementId is UUID with {
    briefly "Settlement ID"
    described by "Settlement identifier."
  }
  supplierId is SupplierId with {
    briefly "Supplier"
    described by "Energy supplier identifier."
  }
  periodStart is Date with {
    briefly "Start"
    described by "Settlement period start."
  }
  periodEnd is Date with {
    briefly "End"
    described by "Settlement period end."
  }
  totalEnergyKwh is Decimal(14, 3) with {
    briefly "Energy"
    described by "Total energy in kWh."
  }
  settlementAmount is Decimal(12, 2) with {
    briefly "Amount"
    described by "Total settlement amount."
  }
  settlementStatus is SettlementStatus with {
    briefly "Status"
    described by "Settlement status."
  }
} with {
  briefly "Supplier settlement"
  described by "Settlement record with an energy supplier."
}
