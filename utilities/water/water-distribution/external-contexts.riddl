// Water Distribution - External Contexts
context LaboratoryService is {
  command SubmitSampleForTesting is  {
    sampleId: UUID with {
      briefly "Sample"
      described as {
        |Sample ID.
      }
    }
    sampleType: String(1,50) with {
      briefly "Type"
      described as {
        |Sample type.
      }
    }
    testsRequested: String(1,100)+ with {
      briefly "Tests"
      described as {
        |Requested tests.
      }
    }
  } with {
    briefly "Submit sample"
    described as {
      |Submits sample for lab testing.
    }
  }
  event SampleReceived is  {
    sampleId: UUID with {
      briefly "Sample"
      described as {
        |Sample ID.
      }
    }
    receivedAt: TimeStamp with {
      briefly "Received"
      described as {
        |Receipt time.
      }
    }
  } with {
    briefly "Sample received"
    described as {
      |Emitted when lab receives sample.
    }
  }
  event ResultsAvailable is  {
    sampleId: UUID with {
      briefly "Sample"
      described as {
        |Sample ID.
      }
    }
    results: String(1,500)+ with {
      briefly "Results"
      described as {
        |Test results.
      }
    }
    completedAt: TimeStamp with {
      briefly "Completed"
      described as {
        |Completion time.
      }
    }
  } with {
    briefly "Results available"
    described as {
      |Emitted when results are ready.
    }
  }
} with {
  option external()
  briefly "External laboratory"
  described as {
    |Water quality testing laboratory.
  }
}
context CustomerNotificationService is {
  command SendBoilWaterNotice is  {
    zoneId: DistributionZoneId with {
      briefly "Zone"
      described as {
        |Zone ID.
      }
    }
    message: String(1,1000) with {
      briefly "Message"
      described as {
        |Notice message.
      }
    }
    affectedAddresses: String(1,200)+ with {
      briefly "Addresses"
      described as {
        |Affected addresses.
      }
    }
  } with {
    briefly "Send boil water notice"
    described as {
      |Sends boil water notices.
    }
  }
  event NoticesSent is  {
    zoneId: DistributionZoneId with {
      briefly "Zone"
      described as {
        |Zone ID.
      }
    }
    recipientCount: Natural with {
      briefly "Recipients"
      described as {
        |Notice count.
      }
    }
    sentAt: TimeStamp with {
      briefly "Sent"
      described as {
        |Send time.
      }
    }
  } with {
    briefly "Notices sent"
    described as {
      |Emitted when notices are sent.
    }
  }
  command SendMaintenanceAlert is  {
    zoneId: DistributionZoneId with {
      briefly "Zone"
      described as {
        |Zone ID.
      }
    }
    scheduledDate: Date with {
      briefly "Date"
      described as {
        |Scheduled date.
      }
    }
    expectedDuration: Natural with {
      briefly "Duration"
      described as {
        |Expected duration hours.
      }
    }
    affectedAddresses: String(1,200)+ with {
      briefly "Addresses"
      described as {
        |Affected addresses.
      }
    }
  } with {
    briefly "Send maintenance alert"
    described as {
      |Sends planned maintenance alerts.
    }
  }
} with {
  option external()
  briefly "External customer notification"
  described as {
    |Customer notification service.
  }
}
context RegulatoryReportingService is {
  command SubmitComplianceReport is  {
    reportingPeriod: String(1,20) with {
      briefly "Period"
      described as {
        |Reporting period.
      }
    }
    samples: WaterQualitySample+ with {
      briefly "Samples"
      described as {
        |Quality samples.
      }
    }
    violations: String(1,500)+ with {
      briefly "Violations"
      described as {
        |Violations reported.
      }
    }
  } with {
    briefly "Submit compliance report"
    described as {
      |Submits regulatory compliance report.
    }
  }
  event ReportSubmitted is  {
    reportId: UUID with {
      briefly "Report"
      described as {
        |Report ID.
      }
    }
    submittedAt: TimeStamp with {
      briefly "Submitted"
      described as {
        |Submission time.
      }
    }
  } with {
    briefly "Report submitted"
    described as {
      |Emitted when report is submitted.
    }
  }
  command SubmitAnnualReport is  {
    reportYear: Year with {
      briefly "Year"
      described as {
        |Report year.
      }
    }
    systemSummary: String(1,5000) with {
      briefly "Summary"
      described as {
        |System summary.
      }
    }
  } with {
    briefly "Submit annual report"
    described as {
      |Submits annual water quality report.
    }
  }
} with {
  option external()
  briefly "External regulatory reporting"
  described as {
    |EPA/state regulatory reporting.
  }
}
