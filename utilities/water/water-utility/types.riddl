// Water Utility - Shared Types

type WaterSystemId is Id(WaterUtilityContext.WaterSystem) with {
  briefly "Water system identifier"
  described by "Unique identifier for a water system."
}

type TreatmentPlantId is UUID with {
  briefly "Treatment plant identifier"
  described by "Reference to a water treatment plant."
}

type DistributionZoneId is UUID with {
  briefly "Distribution zone identifier"
  described by "Reference to a distribution zone."
}

type SensorId is UUID with {
  briefly "Sensor identifier"
  described by "Reference to a monitoring sensor."
}

type SystemStatus is any of {
  Normal,
  Advisory,
  Warning,
  Critical,
  Shutdown,
  Maintenance
} with {
  briefly "System status"
  described by "Overall water system operational status."
}

type TreatmentStage is any of {
  Intake,
  Coagulation,
  Sedimentation,
  Filtration,
  Disinfection,
  Storage,
  Distribution
} with {
  briefly "Treatment stage"
  described by "Stage in the water treatment process."
}

type QualityParameter is any of {
  Turbidity,
  Chlorine,
  Fluoride,
  LeadLevel,
  CopperLevel,
  Coliform,
  Nitrate,
  Arsenic
} with {
  briefly "Quality parameter"
  described by "Water quality test parameter."
}

type AlertSeverity is any of {
  Informational,
  Low,
  Medium,
  High,
  Emergency
} with {
  briefly "Alert severity"
  described by "Severity level for system alerts."
}

type ComplianceStatus is any of {
  Compliant,
  NonCompliant,
  UnderReview,
  Corrective,
  Exempted
} with {
  briefly "Compliance status"
  described by "Regulatory compliance status."
}

type TreatmentPlantInfo is {
  plantId is TreatmentPlantId with {
    briefly "Plant ID"
    described by "Treatment plant identifier."
  }
  plantName is String(3, 200) with {
    briefly "Name"
    described by "Treatment plant name."
  }
  capacity is Decimal(12, 2) with {
    briefly "Capacity"
    described by "Treatment capacity in gallons per day."
  }
  currentOutput is Decimal(12, 2) with {
    briefly "Output"
    described by "Current output in gallons per day."
  }
  activeStages is many TreatmentStage with {
    briefly "Stages"
    described by "Active treatment stages."
  }
} with {
  briefly "Treatment plant info"
  described by "Water treatment plant details."
}

type DistributionZoneInfo is {
  zoneId is DistributionZoneId with {
    briefly "Zone ID"
    described by "Distribution zone identifier."
  }
  zoneName is String(3, 200) with {
    briefly "Name"
    described by "Distribution zone name."
  }
  pressurePsi is Decimal(6, 2) with {
    briefly "Pressure"
    described by "Current pressure in PSI."
  }
  minPressurePsi is Decimal(6, 2) with {
    briefly "Min pressure"
    described by "Minimum acceptable pressure in PSI."
  }
  maxPressurePsi is Decimal(6, 2) with {
    briefly "Max pressure"
    described by "Maximum acceptable pressure in PSI."
  }
  customerCount is Natural with {
    briefly "Customers"
    described by "Number of customers in zone."
  }
} with {
  briefly "Distribution zone info"
  described by "Distribution zone details."
}

type QualityTestResult is {
  sensorId is SensorId with {
    briefly "Sensor"
    described by "Sensor identifier."
  }
  parameter is QualityParameter with {
    briefly "Parameter"
    described by "Quality parameter tested."
  }
  measuredValue is Decimal(10, 4) with {
    briefly "Value"
    described by "Measured value."
  }
  regulatoryLimit is Decimal(10, 4) with {
    briefly "Limit"
    described by "Regulatory limit for parameter."
  }
  passed is Boolean with {
    briefly "Passed"
    described by "Whether measurement is within limits."
  }
  testedAt is TimeStamp with {
    briefly "Tested"
    described by "Time of test."
  }
} with {
  briefly "Quality test result"
  described by "Water quality test measurement."
}

type LeakReport is {
  reportId is UUID with {
    briefly "Report ID"
    described by "Leak report identifier."
  }
  zoneId is DistributionZoneId with {
    briefly "Zone"
    described by "Distribution zone."
  }
  location is String(3, 500) with {
    briefly "Location"
    described by "Leak location description."
  }
  estimatedLossGph is Decimal(10, 2) with {
    briefly "Loss rate"
    described by "Estimated loss in gallons per hour."
  }
  severity is AlertSeverity with {
    briefly "Severity"
    described by "Leak severity."
  }
  detectedAt is TimeStamp with {
    briefly "Detected"
    described by "Detection time."
  }
  leakRepairedAt is optional TimeStamp with {
    briefly "Repaired"
    described by "Repair time if resolved."
  }
} with {
  briefly "Leak report"
  described by "Water leak detection report."
}

type PressureReading is {
  sensorId is SensorId with {
    briefly "Sensor"
    described by "Sensor identifier."
  }
  zoneId is DistributionZoneId with {
    briefly "Zone"
    described by "Distribution zone."
  }
  pressurePsi is Decimal(6, 2) with {
    briefly "Pressure"
    described by "Pressure reading in PSI."
  }
  recordedAt is TimeStamp with {
    briefly "Recorded"
    described by "Reading time."
  }
} with {
  briefly "Pressure reading"
  described by "Distribution pressure measurement."
}

type ComplianceReport is {
  reportId is UUID with {
    briefly "Report ID"
    described by "Compliance report identifier."
  }
  reportingPeriod is String(3, 50) with {
    briefly "Period"
    described by "Reporting period."
  }
  complianceStatus is ComplianceStatus with {
    briefly "Status"
    described by "Compliance status."
  }
  violations is many optional String(3, 500) with {
    briefly "Violations"
    described by "List of violations if any."
  }
  reportSubmittedAt is optional TimeStamp with {
    briefly "Submitted"
    described by "Submission time."
  }
} with {
  briefly "Compliance report"
  described by "Regulatory compliance report."
}
