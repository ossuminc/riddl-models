// Water Utility - External Contexts

context SCADASystem is {

  query GetSensorReadings is {
    plantId is TreatmentPlantId with { briefly "Plant" described by "Plant ID." }
    sensorIds is many SensorId with { briefly "Sensors" described by "Sensor identifiers." }
  } with {
    briefly "Get sensor readings"
    described by "Retrieves current sensor readings from SCADA."
  }

  result SensorReadings is {
    plantId is TreatmentPlantId with { briefly "Plant" described by "Plant ID." }
    readings is many PressureReading with { briefly "Readings" described by "Sensor readings." }
    collectedAt is TimeStamp with { briefly "Collected" described by "Collection time." }
  } with {
    briefly "Sensor readings"
    described by "SCADA sensor reading results."
  }

  command SendControlSignal is {
    plantId is TreatmentPlantId with { briefly "Plant" described by "Plant ID." }
    targetDevice is String(3, 200) with { briefly "Device" described by "Target device." }
    signalType is String(3, 100) with { briefly "Signal" described by "Control signal type." }
    parameters is String(3, 1000) with { briefly "Parameters" described by "Signal parameters." }
  } with {
    briefly "Send control signal"
    described by "Sends a control signal to plant equipment."
  }

  event ControlSignalSent is {
    plantId is TreatmentPlantId with { briefly "Plant" described by "Plant ID." }
    targetDevice is String(3, 200) with { briefly "Device" described by "Target device." }
    sentAt is TimeStamp with { briefly "Sent" described by "Signal sent time." }
    acknowledged is Boolean with { briefly "Acknowledged" described by "Signal acknowledged." }
  } with {
    briefly "Control signal sent"
    described by "Emitted when a control signal is sent."
  }

} with {
  option is external
  briefly "External SCADA system"
  described by "Supervisory control and data acquisition system."
}

context RegulatoryReporting is {

  command SubmitReport is {
    reportId is UUID with { briefly "Report" described by "Report ID." }
    reportType is String(3, 100) with { briefly "Type" described by "Report type." }
    reportData is String(3, 10000) with { briefly "Data" described by "Report data." }
    regulatoryBody is String(3, 200) with { briefly "Regulator" described by "Regulatory body." }
  } with {
    briefly "Submit report"
    described by "Submits a regulatory report."
  }

  event ReportSubmitted is {
    reportId is UUID with { briefly "Report" described by "Report ID." }
    regulatoryBody is String(3, 200) with { briefly "Regulator" described by "Regulatory body." }
    submittedAt is TimeStamp with { briefly "Submitted" described by "Submission time." }
    accepted is Boolean with { briefly "Accepted" described by "Report accepted." }
  } with {
    briefly "Report submitted"
    described by "Emitted when a regulatory report is submitted."
  }

  query GetComplianceRequirements is {
    regulatoryBody is String(3, 200) with { briefly "Regulator" described by "Regulatory body." }
    reportingPeriod is String(3, 50) with { briefly "Period" described by "Reporting period." }
  } with {
    briefly "Get compliance requirements"
    described by "Retrieves compliance requirements."
  }

  result ComplianceRequirements is {
    regulatoryBody is String(3, 200) with { briefly "Regulator" described by "Regulatory body." }
    requirements is many String(3, 500) with { briefly "Requirements" described by "Compliance requirements." }
    dueDate is Date with { briefly "Due" described by "Due date for report." }
  } with {
    briefly "Compliance requirements"
    described by "Regulatory compliance requirements."
  }

} with {
  option is external
  briefly "External regulatory reporting system"
  described by "Regulatory reporting and compliance system."
}
