// Outage Management - Shared Types

type OutageEventId is Id(OutageContext.OutageEvent) with {
  briefly "Outage event identifier"
  described by "Unique identifier for an outage event."
}

type CustomerId is UUID with {
  briefly "Customer identifier"
  described by "Reference to an affected customer."
}

type CrewId is UUID with {
  briefly "Crew identifier"
  described by "Reference to a field restoration crew."
}

type FeederId is UUID with {
  briefly "Feeder identifier"
  described by "Reference to an electrical feeder circuit."
}

type DeviceId is UUID with {
  briefly "Device identifier"
  described by "Reference to a grid device such as a transformer or switch."
}

type OutageStatus is any of {
  DetectedStatus,
  ConfirmedStatus,
  CrewEnRouteStatus,
  CrewOnSiteStatus,
  RestoringStatus,
  RestoredStatus,
  ClosedStatus,
  CancelledStatus
} with {
  briefly "Outage status"
  described by "Current status of an outage event."
}

type OutageCause is any of {
  Weather,
  Equipment,
  Vegetation,
  Animal,
  Vehicle,
  Planned,
  Unknown
} with {
  briefly "Outage cause"
  described by "Root cause category of the outage."
}

type OutagePriority is any of {
  Critical,
  High,
  Medium,
  Low
} with {
  briefly "Outage priority"
  described by "Priority level for outage response."
}

type OutageInfo is {
  outageId is OutageEventId with {
    briefly "Outage ID"
    described by "Outage event identifier."
  }
  feederId is FeederId with {
    briefly "Feeder"
    described by "Affected feeder circuit."
  }
  location is String(1, 300) with {
    briefly "Location"
    described by "Geographic location of the outage."
  }
  detectedAt is TimeStamp with {
    briefly "Detected"
    described by "Time the outage was detected."
  }
  priority is OutagePriority with {
    briefly "Priority"
    described by "Outage response priority."
  }
  estimatedCustomersAffected is Natural with {
    briefly "Customers affected"
    described by "Estimated number of customers without power."
  }
} with {
  briefly "Outage information"
  described by "Core details of an outage event."
}

type AffectedDevice is {
  deviceId is DeviceId with {
    briefly "Device"
    described by "Grid device identifier."
  }
  deviceType is String(1, 100) with {
    briefly "Type"
    described by "Type of grid device."
  }
  status is String(1, 50) with {
    briefly "Status"
    described by "Device status."
  }
  location is String(1, 300) with {
    briefly "Location"
    described by "Device location."
  }
} with {
  briefly "Affected device"
  described by "A grid device affected by the outage."
}

type CrewAssignment is {
  crewId is CrewId with {
    briefly "Crew"
    described by "Assigned crew identifier."
  }
  crewName is String(1, 100) with {
    briefly "Name"
    described by "Crew name."
  }
  dispatchedAt is TimeStamp with {
    briefly "Dispatched"
    described by "Time crew was dispatched."
  }
  arrivedAt is optional TimeStamp with {
    briefly "Arrived"
    described by "Time crew arrived on site."
  }
  completedAt is optional TimeStamp with {
    briefly "Completed"
    described by "Time crew completed work."
  }
} with {
  briefly "Crew assignment"
  described by "A crew assigned to the outage."
}

type RestorationStep is {
  stepId is UUID with {
    briefly "Step ID"
    described by "Restoration step identifier."
  }
  description is String(1, 500) with {
    briefly "Description"
    described by "Step description."
  }
  completedAt is optional TimeStamp with {
    briefly "Completed"
    described by "Step completion time."
  }
  success is optional Boolean with {
    briefly "Success"
    described by "Whether step succeeded."
  }
} with {
  briefly "Restoration step"
  described by "A step in the restoration process."
}

type CustomerNotification is {
  customerId is CustomerId with {
    briefly "Customer"
    described by "Notified customer identifier."
  }
  channel is String(1, 50) with {
    briefly "Channel"
    described by "Notification channel (sms, email, app)."
  }
  message is String(1, 1000) with {
    briefly "Message"
    described by "Notification message."
  }
  sentAt is TimeStamp with {
    briefly "Sent"
    described by "Time notification was sent."
  }
} with {
  briefly "Customer notification"
  described by "A notification sent to an affected customer."
}

type PostOutageAnalysis is {
  cause is OutageCause with {
    briefly "Cause"
    described by "Determined root cause."
  }
  duration is Decimal(10, 2) with {
    briefly "Duration"
    described by "Total outage duration in minutes."
  }
  customersAffected is Natural with {
    briefly "Customers"
    described by "Actual number of customers affected."
  }
  findings is String(1, 2000) with {
    briefly "Findings"
    described by "Post-outage analysis findings."
  }
  preventionRecommendations is many String(1, 500) with {
    briefly "Recommendations"
    described by "Recommendations to prevent recurrence."
  }
} with {
  briefly "Post-outage analysis"
  described by "Analysis performed after outage resolution."
}
