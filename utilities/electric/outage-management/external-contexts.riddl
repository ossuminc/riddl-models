// Outage Management - External Contexts

context SCADASystem is {

  event OutageDetected is {
    feederId is FeederId with { briefly "Feeder" described by "Feeder ID." }
    location is String(1, 300) with { briefly "Location" described by "Outage location." }
    detectedAt is TimeStamp with { briefly "Detected" described by "Detection time." }
    severity is String(1, 50) with { briefly "Severity" described by "Outage severity." }
  } with {
    briefly "Outage detected"
    described by "Emitted when SCADA detects a power outage."
  }

  query GetFeederStatus is {
    feederId is FeederId with { briefly "Feeder" described by "Feeder ID." }
  } with {
    briefly "Get feeder status"
    described by "Gets current feeder circuit status."
  }

  result FeederStatus is {
    feederId is FeederId with { briefly "Feeder" described by "Feeder ID." }
    status is String(1, 50) with { briefly "Status" described by "Feeder status." }
    voltage is Decimal(8, 2) with { briefly "Voltage" described by "Current voltage reading." }
    lastReading is TimeStamp with { briefly "Reading" described by "Last reading time." }
  } with {
    briefly "Feeder status"
    described by "Current feeder circuit status."
  }

  command IsolateFeeder is {
    feederId is FeederId with { briefly "Feeder" described by "Feeder ID." }
    reason is String(1, 500) with { briefly "Reason" described by "Isolation reason." }
  } with {
    briefly "Isolate feeder"
    described by "Isolates a feeder circuit for safety."
  }

  event FeederIsolated is {
    feederId is FeederId with { briefly "Feeder" described by "Feeder ID." }
    isolatedAt is TimeStamp with { briefly "Isolated" described by "Isolation time." }
  } with {
    briefly "Feeder isolated"
    described by "Emitted when a feeder is isolated."
  }

} with {
  option is external
  briefly "External SCADA system"
  described by "Supervisory control and data acquisition system for grid monitoring."
}

context CrewDispatchSystem is {

  query GetAvailableCrews is {
    location is String(1, 300) with { briefly "Location" described by "Outage location." }
    priority is OutagePriority with { briefly "Priority" described by "Outage priority." }
  } with {
    briefly "Get available crews"
    described by "Finds available crews near a location."
  }

  result AvailableCrews is {
    crews is many CrewAssignment with { briefly "Crews" described by "Available crews." }
    estimatedArrival is Decimal(8, 2) with { briefly "ETA" described by "Estimated arrival in minutes." }
  } with {
    briefly "Available crews"
    described by "Crews available for dispatch."
  }

  command AssignCrew is {
    outageId is OutageEventId with { briefly "Outage" described by "Outage ID." }
    crewId is CrewId with { briefly "Crew" described by "Crew ID." }
    location is String(1, 300) with { briefly "Location" described by "Dispatch location." }
  } with {
    briefly "Assign crew"
    described by "Assigns a crew to an outage event."
  }

  event CrewAssigned is {
    outageId is OutageEventId with { briefly "Outage" described by "Outage ID." }
    crewId is CrewId with { briefly "Crew" described by "Crew ID." }
    assignedAt is TimeStamp with { briefly "Assigned" described by "Assignment time." }
  } with {
    briefly "Crew assigned"
    described by "Emitted when a crew is assigned to an outage."
  }

  command ReleaseCrew is {
    crewId is CrewId with { briefly "Crew" described by "Crew ID." }
    outageId is OutageEventId with { briefly "Outage" described by "Outage ID." }
  } with {
    briefly "Release crew"
    described by "Releases a crew from an outage assignment."
  }

  event CrewReleased is {
    crewId is CrewId with { briefly "Crew" described by "Crew ID." }
    releasedAt is TimeStamp with { briefly "Released" described by "Release time." }
  } with {
    briefly "Crew released"
    described by "Emitted when a crew is released from assignment."
  }

} with {
  option is external
  briefly "External crew dispatch system"
  described by "Field crew management and dispatch system."
}
